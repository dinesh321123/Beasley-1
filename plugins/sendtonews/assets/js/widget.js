
(function($){$(document).on('click','.sendtonews-player-selector-button',function(event){event.preventDefault();event.stopPropagation();let $widget=$(this).closest('.widget');let widget_id=$widget.attr('id');let widget_handle;if(typeof widget_id=="undefined"){$widget=$(this).closest('.widget-inside');let url=new URL(window.location.href);let search_params=url.searchParams;let addnew=search_params.get('addnew');if(addnew){widget_handle='sendtonews-__i__';}else{widget_handle=search_params.get('editwidget');}}else{widget_handle=widget_id.split('_')[1];}
let initialState='sendtonews-overview';if(localStorage.getItem('sendtonews-used-once')=="true"){initialState='sendtonews-smartmatch';}
localStorage.setItem('sendtonews-selected-player-widget',document.getElementById('widget-'+widget_handle+'-name').value);frame=new S2N_Modal.frame({id:'sendtonews-modal-'+widget_id,title:sendtonews_widget_i18n.title,button:{text:sendtonews_widget_i18n.close,},state:initialState});frame.open();$('#sendtonews-modal-'+widget_id).one('click','.insert-player',function(e){e.preventDefault();e.stopPropagation();let embedName=$(this).data('embedname');let embedType=$(this).data('embedtype');let embedKey=$(this).data('embedkey');let $widgetEmbedNameInput=$widget.find('#widget-'+widget_handle+'-name');let $widgetEmbedTypeInput=$widget.find('#widget-'+widget_handle+'-type');let $widgetEmbedKeyInput=$widget.find('#widget-'+widget_handle+'-key');$widgetEmbedNameInput.val(embedName).trigger('change');$widgetEmbedTypeInput.val(embedType).trigger('change');$widgetEmbedKeyInput.val(embedKey).trigger('change');$widget.find('.attachment-media-view').html('<div class="notice notice-info inline"><h3>'+embedName+'</h3></div>');$widget.find('.attachment-media-view').append('<div class="s2n-player-sample"><img class="s2n-player-sample-image" src="'+sendtonews_widget_i18n.plugin_url+'/assets/images/player.jpg" /></div>');$widget.find('.attachment-media-view').append('<div class="notice notice-warning inline"><p>Smart Match players work by reading the contents of your page to select videos for your playlist. This feature requires public content so will only function on the front-end of your website. After publishing the Smart Match player on a page, refresh that page to activate the Smart Match functionality. The menu icon in the top right hand corner of the player will turn from white to green after Smart Match has successfully read your page.</p></div>');$widget.find('.media-widget-buttons').show();if($widget.find('.widget-top').length&&!$widget.parents('#available-widgets').length){if(!$widget.find('.customize-control-notifications-container').length){$widget.addClass('widget-dirty');}else{$widget.parent().addClass('widget-form-loading previewer-loading');}
$widget.find('#widget-'+widget_handle+'-savewidget').prop('disabled',false).val(sendtonews_widget_i18n.save).click();$widget.data('dirty-state-initialized',true);$(document).trigger('widget-updated',[$widget]);}
jQuery(this).tooltip('hide');frame.close();});$('#sendtonews-modal-'+widget_id).one('click','.insert-player-key-type',function(e){e.preventDefault();e.stopPropagation();let type=document.getElementById("specifiedType");let embedName=type.options[type.selectedIndex].text+" Video Player";let embedType=document.getElementById("specifiedType").value
let embedKey=document.getElementById("specifiedKey").value
let $widgetEmbedNameInput=$widget.find('#widget-'+widget_handle+'-name');let $widgetEmbedTypeInput=$widget.find('#widget-'+widget_handle+'-type');let $widgetEmbedKeyInput=$widget.find('#widget-'+widget_handle+'-key');$widgetEmbedNameInput.val(embedName).trigger('change');$widgetEmbedTypeInput.val(embedType).trigger('change');$widgetEmbedKeyInput.val(embedKey).trigger('change');$widget.find('.attachment-media-view').html('<div class="notice notice-info inline"><h3>'+embedName+'</h3></div>');$widget.find('.attachment-media-view').append('<div class="s2n-player-sample"><img class="s2n-player-sample-image" src="'+sendtonews_widget_i18n.plugin_url+'/assets/images/player.jpg" /></div>');$widget.find('.attachment-media-view').append('<div class="notice notice-warning inline"><p>Smart Match Players work by reading the contents of your page to select videos for your playlist. This feature requires public content so will only function on the front-end of your website. The menu icon in the top right hand corner of the player will turn from white to green after Smart Match has successfully read your page.</p></div>');$widget.find('.media-widget-buttons').show();if($widget.find('.widget-top').length&&!$widget.parents('#available-widgets').length){if(!$widget.find('.customize-control-notifications-container').length){$widget.addClass('widget-dirty');}else{$widget.parent().addClass('widget-form-loading previewer-loading');}
$widget.find('#widget-'+widget_handle+'-savewidget').prop('disabled',false).val(sendtonews_widget_i18n.save).click();$widget.data('dirty-state-initialized',true);$(document).trigger('widget-updated',[$widget]);}
jQuery(this).tooltip('hide');frame.close();});});})(jQuery);