var escapeValue=function(a){return"string"==typeof a&&(a=a.replace(/"/g,"C_DOUBLE_QUOTE"),a=a.replace(/'/g,"C_SINGLE_QUOTE"),a=a.replace(/\\/g,"C_BACKSLASH")),a},unescapeValue=function(a){return"string"==typeof a&&(a=a.replace(/C_DOUBLE_QUOTE/g,'"'),a=a.replace(/C_SINGLE_QUOTE/g,"'"),a=a.replace(/C_BACKSLASH/g,"\\")),a},getTemplate=function(a){return window.JST["src/templates/"+a+".jst"]},renderTemplate=function(a,b,c){c||(c={});var d=getTemplate(a),e=d(b);return $(e)};"function"!=typeof Object.create&&(Object.create=function(){var a=function(){};return function(b){if(arguments.length>1)throw Error("Second argument not supported");if("object"!=typeof b)throw TypeError("Argument must be an object");a.prototype=b;var c=new a;return a.prototype=null,c}}());var WpAjaxApi=function(a){this.config=a};WpAjaxApi.prototype={nonceFor:function(a){return this.config[a+"_nonce"]},urlFor:function(a){var b={};b[a+"_nonce"]=this.nonceFor(a);var c=this.config.ajax_url;return c+=-1===c.indexOf("?")?"?":"&",c+=$.param(b)},request:function(a,b){b||(b={});var c=this.urlFor(a),d={action:a,action_data:JSON.stringify(b)};return $.post(c,d)}},this.JST=this.JST||{},this.JST["src/templates/constraint.jst"]=function(obj){obj||(obj={});{var __t,__p="",__e=_.escape;Array.prototype.join}with(obj)__p+='<ul class="constraint-toolbar">\n	<li>\n		<a\n			alt="f105"\n			class="dashicons dashicons-admin-page copy-constraint"\n			href="#"\n			title="Duplicate"\n		/>\n\n		<a\n			alt="f105"\n			class="dashicons dashicons-trash remove-constraint"\n			href="#"\n			title="Remove"\n		/>\n	</li>\n</ul>\n\n<p class="constraint-title">\n	'+__e(title)+'\n</p>\n\n<select class="constraint-operator" style="width: 35%">\n	',_.each(view.operatorsFor(valueType),function(a){__p+='\n	<option value="'+__e(a)+'" '+(null==(__t=a===operator?'selected="selected"':"")?"":__t)+'">\n	'+__e(a)+"\n	</option>\n	"}),__p+="\n</select>\n\n",view.hasChoices()?(__p+='\n	<select class="constraint-value" style="width: 45%">\n		',_.each(choices,function(a){__p+='\n		<option value="'+__e(a.value)+'" '+(null==(__t=a.value===value?'selected="selected"':"")?"":__t)+'">\n		'+__e(a.label)+"\n		</option>\n		"}),__p+="\n	</select>\n"):__p+="integer"===valueType||"float"===valueType?'\n	<input type="number" class="constraint-value constraint-value-text" value="'+__e(value)+'" />\n':'\n	<input type="text" class="constraint-value constraint-value-text" value="'+__e(value)+'" />\n',__p+='\n\n<select class="constraint-conjunction" style="width: 15%">\n	',_.each(view.conjunctions,function(a){__p+='\n	<option value="'+__e(a)+'" '+(null==(__t=a===conjunction?'selected="selected"':"")?"":__t)+'">\n	'+__e(a)+"\n	</option>\n	"}),__p+="\n</select>\n";return __p},this.JST["src/templates/constraint_item.jst"]=function(obj){obj||(obj={});{var __t,__p="",__e=_.escape;Array.prototype.join}with(obj)__p+='<li>\n	<ul class="constraint-toolbar">\n		<li>\n			<a\n				data-id="'+__e(constraint.id)+'"\n				alt="f105"\n				class="dashicons dashicons-admin-page copy-constraint"\n				href="#"\n				title="Duplicate"\n			/>\n\n			<a\n				data-id="'+__e(constraint.id)+'"\n				alt="f105"\n				class="dashicons dashicons-trash remove-constraint"\n				href="#"\n				title="Remove"\n			/>\n		</li>\n	</ul>\n\n	<p class="constraint-title">\n		'+__e(constraint.title)+'\n	</p>\n\n	<select data-id="'+__e(constraint.id)+'" class="constraint-operator">\n		',_.each(view.operatorsFor(constraint.valueType),function(a){__p+='\n		<option value="'+__e(a)+'" '+(null==(__t=constraint.operator===a?'selected="selected"':"")?"":__t)+'">\n		'+__e(view.operatorLabelFor(a))+"\n		</option>\n		"}),__p+='\n	</select>\n\n	<input\n		type="text"\n		class="constraint-value"\n		data-id="'+__e(constraint.id)+'"\n		value="'+__e(constraint.value)+'" />\n\n	<select data-id="'+__e(constraint.id)+'" class="constraint-conjunction">\n		',_.each(view.conjunctions,function(a){__p+='\n		<option value="'+__e(a)+'" '+(null==(__t=constraint.conjunction===a?'selected="selected"':"")?"":__t)+'">\n		'+__e(a)+"\n		</option>\n		"}),__p+="\n	</select>\n</li>\n";return __p},this.JST["src/templates/empty_constraints.jst"]=function(obj){obj||(obj={});{var __p="";_.escape}with(obj)__p+='<p class="constraint-empty">Click to add filters</p>\n';return __p},this.JST["src/templates/entry_answer.jst"]=function(obj){obj||(obj={});{var __t,__p="",__e=_.escape;Array.prototype.join}with(obj)__p+='<label><strong>Select Answer: </strong></label>\n<select class="constraint-operator" style="width: 35%">\n	',_.each(view.operatorsFor(valueType),function(a){__p+='\n	<option value="'+__e(a)+'" '+(null==(__t=a===operator?'selected="selected"':"")?"":__t)+'">\n	'+__e(a)+"\n	</option>\n	"}),__p+="\n</select>\n\n",view.hasChoices()?(__p+='\n	<select class="constraint-value" style="width: 45%">\n		',_.each(choices,function(a){__p+='\n		<option value="'+__e(a.value)+'" '+(null==(__t=a.value==currentChoice?'selected="selected"':"")?"":__t)+'">\n		'+__e(a.label)+"\n		</option>\n		"}),__p+="\n	</select>\n"):__p+="integer"===valueType||"float"===valueType?'\n	<input type="number" class="constraint-value constraint-value-text" value="'+__e(value)+'" />\n':'\n	<input type="text" class="constraint-value constraint-value-text" value="'+__e(value)+'" />\n',__p+='\n\n<select class="constraint-conjunction" style="width: 15%">\n	',_.each(view.conjunctions,function(a){__p+='\n	<option value="'+__e(a)+'" '+(null==(__t=a===conjunction?'selected="selected"':"")?"":__t)+'">\n	'+__e(a)+"\n	</option>\n	"}),__p+="\n</select>\n";return __p},this.JST["src/templates/entry_constraint.jst"]=function(obj){obj||(obj={});var __p="",__e=_.escape;with(obj)__p+='<ul class="constraint-toolbar">\n	<li>\n		<a\n			alt="f105"\n			class="dashicons dashicons-admin-page copy-constraint"\n			href="#"\n			title="Duplicate"\n		/>\n\n		<a\n			alt="f105"\n			class="dashicons dashicons-trash remove-constraint"\n			href="#"\n			title="Remove"\n		/>\n	</li>\n</ul>\n\n<p class="constraint-title">\n	'+__e(title)+'\n</p>\n\n<div class="entry-select-group">\n	<label><strong>Select Contest: </strong></label>\n	<select class="entry-select-choice entry-select-type">\n	</select>\n</div>\n\n<div class="entry-select-group">\n	<label><strong>Select Question: </strong></label>\n	<select class="entry-select-choice entry-select-field">\n	</select>\n</div>\n\n<div class="entry-answer-group">\n	<label><strong>Loading ... </strong></label>\n</div>\n';return __p},this.JST["src/templates/entry_select.jst"]=function(obj){obj||(obj={});{var __t,__p="",__e=_.escape;Array.prototype.join}with(obj)_.each(choices,function(a){__p+='\n	<option value="'+__e(a.value)+'" '+(null==(__t=a.value===currentChoice?'selected="selected"':"")?"":__t)+'">\n	'+__e(a.label)+"\n	</option>\n"}),__p+="\n";return __p},this.JST["src/templates/query_result_item.jst"]=function(obj){obj||(obj={});var __p="",__e=_.escape;with(obj)__p+='<tr>\n	<td>\n		<a href="#" class="open-member-page-text">'+__e(email)+'</a>\n		<a href="#" alt="f105" class="dashicons dashicons-external open-member-page"></a>\n	</td>\n</tr>\n';return __p},this.JST["src/templates/toolbar_item.jst"]=function(obj){obj||(obj={});var __p="",__e=_.escape;with(obj)__p+='<a title="Click to add" href="#" class="toolbar_item">\n	'+__e(title)+"\n</a>\n";return __p};var EntryType=Backbone.Model.extend({defaults:{label:"Entry Type",value:-1}}),EntryField=Backbone.Model.extend({defaults:{label:"",value:"",type:"",choices:[]}}),Constraint=Backbone.Model.extend({defaults:{type:"constraint:type_name",operator:"equals",conjunction:"and",valueType:"string",value:""},getMeta:function(a){return this.hasMeta(a)?AVAILABLE_CONSTRAINTS_META_MAP[this.get("type")][a]:null},hasMeta:function(a){var b=this.get("type");return!!AVAILABLE_CONSTRAINTS_META_MAP[b]&&!!AVAILABLE_CONSTRAINTS_META_MAP[b][a]},toViewJSON:function(){var a=this.toJSON(),b=this.get("type"),c=AVAILABLE_CONSTRAINTS_META_MAP[b];return c&&_.extend(a,c),a}}),ProfileConstraint=Constraint.extend({defaults:{type:"profile:field_name",operator:"equals",conjunction:"and",valueType:"string",value:""}}),EntryConstraint=Constraint.extend({defaults:{type:"record:contest",operator:"equals",conjunction:"and",valueType:"string",value:"",entryTypeID:-1,entryFieldID:-1},initialize:function(a,b){Constraint.prototype.initialize.call(this,a,b),this.listenTo(this,"change:entryTypeID",this.didChangeEntryTypeID)},getEntryType:function(){var a=this.get("type").split(":"),b=a[1];return b},getEntryTypes:function(){return this.entryTypes||(this.entryTypes=new EntryTypeCollection,this.loadEntryTypes()),this.entryTypes},loadEntryTypes:function(){var a={entryType:this.getEntryType()};ajaxApi.request("list_entry_types",a).then($.proxy(this.didLoadEntryTypes,this)).fail($.proxy(this.didLoadEntryTypesError,this))},didLoadEntryTypes:function(a){var b=this.entryTypes;b.reset(a.data),-1===this.get("entryTypeID")?this.set("entryTypeID",b.at(0).get("value")):this.didChangeEntryTypeID()},didLoadEntryTypesError:function(a){console.log(a)},didChangeEntryTypeID:function(){this.loadEntryFields()},loadEntryFields:function(){var a={entryTypeID:this.get("entryTypeID")};ajaxApi.request("list_entry_fields",a).then($.proxy(this.didLoadEntryFields,this)).fail($.proxy(this.didLoadEntryFieldsError,this))},didLoadEntryFields:function(a){var b=this.getEntryFields();b.reset(a.data),-1===this.get("entryFieldID")&&this.set("entryFieldID",b.at(0).get("value"))},didLoadEntryFieldsError:function(a){console.log(a)},getEntryFields:function(){return this.entryFields||(this.entryFields=new EntryFieldCollection),this.entryFields},getEntryFieldChoices:function(){var a=this.getEntryFields(),b=a.findWhere({value:this.get("entryFieldID")});if(b){var c=b.get("choices");return c&&c.length>0?c:[]}return[]},hasChoices:function(){var a=this.getEntryFieldChoices();return a.length>0}}),AVAILABLE_CONSTRAINTS=[{type:"system:createdTimestamp",valueType:"date",value:"01/01/2012"},{type:"system:isActive",valueType:"boolean"},{type:"system:isRegistered",valueType:"boolean"},{type:"system:lastLoginTimestamp",valueType:"date",value:"01/01/2014"},{type:"system:verified",valueType:"boolean"},{type:"profile:birthYear",valueType:"integer",value:1990},{type:"profile:country",valueType:"string",value:"United States"},{type:"profile:zip",valueType:"string",value:"01001"},{type:"profile:gender",valueType:"string"},{type:"profile:age",valueType:"integer",value:25},{type:"profile:birthDay",valueType:"integer",value:1},{type:"profile:birthMonth",valueType:"integer",value:1},{type:"profile:state",valueType:"string",value:"New York"},{type:"profile:city",valueType:"string"},{type:"profile:timezone",valueType:"string"},{type:"record:contest",valueType:"string",entryTypeID:-1,entryFieldID:-1}],AVAILABLE_CONSTRAINTS_META=[{type:"system:createdTimestamp",title:"Creation Date"},{type:"system:isActive",title:"Active Status",choices:[{label:"Active",value:!0},{label:"Inactive",value:!1}]},{type:"system:isRegistered",title:"Registration Status",choices:[{label:"Registered",value:!0},{label:"Not Registered",value:!1}]},{type:"system:lastLoginTimestamp",title:"Last Logged In"},{type:"system:verified",title:"Verified Status",choices:[{label:"Verified",value:!0},{label:"Not Verified",value:!1}]},{type:"profile:birthYear",title:"Birth Year"},{type:"profile:country",title:"Country",choices:[{label:"Afghanistan",value:"Afghanistan"},{label:"Albania",value:"Albania"},{label:"Algeria",value:"Algeria"},{label:"American Samoa",value:"Samoa"},{label:"Andorra",value:"Andorra"},{label:"Angola",value:"Angola"},{label:"Antigua and Barbuda",value:"Barbuda"},{label:"Argentina",value:"Argentina"},{label:"Armenia",value:"Armenia"},{label:"Australia",value:"Australia"},{label:"Austria",value:"Austria"},{label:"Azerbaijan",value:"Azerbaijan"},{label:"Bahamas",value:"Bahamas"},{label:"Bahrain",value:"Bahrain"},{label:"Bangladesh",value:"Bangladesh"},{label:"Barbados",value:"Barbados"},{label:"Belarus",value:"Belarus"},{label:"Belgium",value:"Belgium"},{label:"Belize",value:"Belize"},{label:"Benin",value:"Benin"},{label:"Bermuda",value:"Bermuda"},{label:"Bhutan",value:"Bhutan"},{label:"Bolivia",value:"Bolivia"},{label:"Bosnia and Herzegovina",value:"Herzegovina"},{label:"Botswana",value:"Botswana"},{label:"Brazil",value:"Brazil"},{label:"Brunei",value:"Brunei"},{label:"Bulgaria",value:"Bulgaria"},{label:"Burkina Faso",value:"Faso"},{label:"Burundi",value:"Burundi"},{label:"Cambodia",value:"Cambodia"},{label:"Cameroon",value:"Cameroon"},{label:"Canada",value:"Canada"},{label:"Cape Verde",value:"Verde"},{label:"Cayman Islands",value:"Islands"},{label:"Central African Republic",value:"Republic"},{label:"Chad",value:"Chad"},{label:"Chile",value:"Chile"},{label:"China",value:"China"},{label:"Colombia",value:"Colombia"},{label:"Comoros",value:"Comoros"},{label:"Congo, Democratic Republic of the",value:"the"},{label:"Congo, Republic of the",value:"the"},{label:"Costa Rica",value:"Rica"},{label:"Croatia",value:"Croatia"},{label:"Cuba",value:"Cuba"},{label:"Cyprus",value:"Cyprus"},{label:"Czech Republic",value:"Republic"},{label:"Denmark",value:"Denmark"},{label:"Djibouti",value:"Djibouti"},{label:"Dominica",value:"Dominica"},{label:"Dominican Republic",value:"Republic"},{label:"East Timor",value:"Timor"},{label:"Ecuador",value:"Ecuador"},{label:"Egypt",value:"Egypt"},{label:"El Salvador",value:"Salvador"},{label:"Equatorial Guinea",value:"Guinea"},{label:"Eritrea",value:"Eritrea"},{label:"Estonia",value:"Estonia"},{label:"Ethiopia",value:"Ethiopia"},{label:"Fiji",value:"Fiji"},{label:"Finland",value:"Finland"},{label:"France",value:"France"},{label:"French Polynesia",value:"Polynesia"},{label:"Gabon",value:"Gabon"},{label:"Gambia",value:"Gambia"},{label:"Georgia",value:"Georgia"},{label:"Germany",value:"Germany"},{label:"Ghana",value:"Ghana"},{label:"Greece",value:"Greece"},{label:"Greenland",value:"Greenland"},{label:"Grenada",value:"Grenada"},{label:"Guam",value:"Guam"},{label:"Guatemala",value:"Guatemala"},{label:"Guinea",value:"Guinea"},{label:"Guinea-Bissau",value:"Bissau"},{label:"Guyana",value:"Guyana"},{label:"Haiti",value:"Haiti"},{label:"Honduras",value:"Honduras"},{label:"Hong Kong",value:"Kong"},{label:"Hungary",value:"Hungary"},{label:"Iceland",value:"Iceland"},{label:"India",value:"India"},{label:"Indonesia",value:"Indonesia"},{label:"Iran",value:"Iran"},{label:"Iraq",value:"Iraq"},{label:"Ireland",value:"Ireland"},{label:"Israel",value:"Israel"},{label:"Italy",value:"Italy"},{label:"Jamaica",value:"Jamaica"},{label:"Japan",value:"Japan"},{label:"Jordan",value:"Jordan"},{label:"Kazakhstan",value:"Kazakhstan"},{label:"Kenya",value:"Kenya"},{label:"Kiribati",value:"Kiribati"},{label:"North Korea",value:"Korea"},{label:"South Korea",value:"Korea"},{label:"Kosovo",value:"Kosovo"},{label:"Kuwait",value:"Kuwait"},{label:"Kyrgyzstan",value:"Kyrgyzstan"},{label:"Laos",value:"Laos"},{label:"Latvia",value:"Latvia"},{label:"Lebanon",value:"Lebanon"},{label:"Lesotho",value:"Lesotho"},{label:"Liberia",value:"Liberia"},{label:"Libya",value:"Libya"},{label:"Liechtenstein",value:"Liechtenstein"},{label:"Lithuania",value:"Lithuania"},{label:"Luxembourg",value:"Luxembourg"},{label:"Macedonia",value:"Macedonia"},{label:"Madagascar",value:"Madagascar"},{label:"Malawi",value:"Malawi"},{label:"Malaysia",value:"Malaysia"},{label:"Maldives",value:"Maldives"},{label:"Mali",value:"Mali"},{label:"Malta",value:"Malta"},{label:"Marshall Islands",value:"Islands"},{label:"Mauritania",value:"Mauritania"},{label:"Mauritius",value:"Mauritius"},{label:"Mexico",value:"Mexico"},{label:"Micronesia",value:"Micronesia"},{label:"Moldova",value:"Moldova"},{label:"Monaco",value:"Monaco"},{label:"Mongolia",value:"Mongolia"},{label:"Montenegro",value:"Montenegro"},{label:"Morocco",value:"Morocco"},{label:"Mozambique",value:"Mozambique"},{label:"Myanmar",value:"Myanmar"},{label:"Namibia",value:"Namibia"},{label:"Nauru",value:"Nauru"},{label:"Nepal",value:"Nepal"},{label:"Netherlands",value:"Netherlands"},{label:"New Zealand",value:"Zealand"},{label:"Nicaragua",value:"Nicaragua"},{label:"Niger",value:"Niger"},{label:"Nigeria",value:"Nigeria"},{label:"Norway",value:"Norway"},{label:"Northern Mariana Islands",value:"Islands"},{label:"Oman",value:"Oman"},{label:"Pakistan",value:"Pakistan"},{label:"Palau",value:"Palau"},{label:"Palestine",value:"Palestine"},{label:"Panama",value:"Panama"},{label:"Papua New Guinea",value:"Guinea"},{label:"Paraguay",value:"Paraguay"},{label:"Peru",value:"Peru"},{label:"Philippines",value:"Philippines"},{label:"Poland",value:"Poland"},{label:"Portugal",value:"Portugal"},{label:"Puerto Rico",value:"Rico"},{label:"Qatar",value:"Qatar"},{label:"Romania",value:"Romania"},{label:"Russia",value:"Russia"},{label:"Rwanda",value:"Rwanda"},{label:"Saint Kitts and Nevis",value:"Nevis"},{label:"Saint Lucia",value:"Lucia"},{label:"Saint Vincent and the Grenadines",value:"Grenadines"},{label:"Samoa",value:"Samoa"},{label:"San Marino",value:"Marino"},{label:"Sao Tome and Principe",value:"Principe"},{label:"Saudi Arabia",value:"Arabia"},{label:"Senegal",value:"Senegal"},{label:"Serbia and Montenegro",value:"Montenegro"},{label:"Seychelles",value:"Seychelles"},{label:"Sierra Leone",value:"Leone"},{label:"Singapore",value:"Singapore"},{label:"Slovakia",value:"Slovakia"},{label:"Slovenia",value:"Slovenia"},{label:"Solomon Islands",value:"Islands"},{label:"Somalia",value:"Somalia"},{label:"South Africa",value:"South Africa"},{label:"Spain",value:"Spain"},{label:"Sri Lanka",value:"Lanka"},{label:"Sudan",value:"Sudan"},{label:"Sudan, South",value:"South"},{label:"Suriname",value:"Suriname"},{label:"Swaziland",value:"Swaziland"},{label:"Sweden",value:"Sweden"},{label:"Switzerland",value:"Switzerland"},{label:"Syria",value:"Syria"},{label:"Taiwan",value:"Taiwan"},{label:"Tajikistan",value:"Tajikistan"},{label:"Tanzania",value:"Tanzania"},{label:"Thailand",value:"Thailand"},{label:"Togo",value:"Togo"},{label:"Tonga",value:"Tonga"},{label:"Trinidad and Tobago",value:"Tobago"},{label:"Tunisia",value:"Tunisia"},{label:"Turkey",value:"Turkey"},{label:"Turkmenistan",value:"Turkmenistan"},{label:"Tuvalu",value:"Tuvalu"},{label:"Uganda",value:"Uganda"},{label:"Ukraine",value:"Ukraine"},{label:"United Arab Emirates",value:"Emirates"},{label:"United Kingdom",value:"Kingdom"},{label:"United States",value:"United States"},{label:"Uruguay",value:"Uruguay"},{label:"Uzbekistan",value:"Uzbekistan"},{label:"Vanuatu",value:"Vanuatu"},{label:"Vatican City",value:"City"},{label:"Venezuela",value:"Venezuela"},{label:"Vietnam",value:"Vietnam"},{label:"Virgin Islands, British",value:"British"},{label:"Virgin Islands, U.S.",value:"Virgin Islands, US"},{label:"Yemen",value:"Yemen"},{label:"Zambia",value:"Zambia"},{label:"Zimbabwe",value:"Zimbabwe"}]},{type:"profile:zip",title:"Zip Code"},{type:"profile:gender",title:"Gender",choices:[{label:"Male",value:"male"},{label:"Female",value:"female"}]},{type:"profile:age",title:"Age"},{type:"profile:birthDay",title:"Birth Day"},{type:"profile:birthMonth",title:"Birth Month",choices:[{label:"January",value:1},{label:"February",value:2},{label:"March",value:3},{label:"April",value:4},{label:"May",value:5},{label:"June",value:6},{label:"July",value:7},{label:"August",value:8},{label:"September",value:9},{label:"October",value:10},{label:"November",value:11},{label:"December",value:12}]},{type:"profile:state",title:"State",choices:[{label:"Alabama",value:"Alabama"},{label:"Alaska",value:"Alaska"},{label:"Arizona",value:"Arizona"},{label:"Arkansas",value:"Arkansas"},{label:"California",value:"California"},{label:"Colorado",value:"Colorado"},{label:"Connecticut",value:"Connecticut"},{label:"Delaware",value:"Delaware"},{label:"District of Columbia",value:"District of Columbia"},{label:"Florida",value:"Florida"},{label:"Georgia",value:"Georgia"},{label:"Hawaii",value:"Hawaii"},{label:"Idaho",value:"Idaho"},{label:"Illinois",value:"Illinois"},{label:"Indiana",value:"Indiana"},{label:"Iowa",value:"Iowa"},{label:"Kansas",value:"Kansas"},{label:"Kentucky",value:"Kentucky"},{label:"Louisiana",value:"Louisiana"},{label:"Maine",value:"Maine"},{label:"Maryland",value:"Maryland"},{label:"Massachusetts",value:"Massachusetts"},{label:"Michigan",value:"Michigan"},{label:"Minnesota",value:"Minnesota"},{label:"Mississippi",value:"Mississippi"},{label:"Missouri",value:"Missouri"},{label:"Montana",value:"Montana"},{label:"Nebraska",value:"Nebraska"},{label:"Nevada",value:"Nevada"},{label:"New Hampshire",value:"New Hampshire"},{label:"New Jersey",value:"New Jersey"},{label:"New Mexico",value:"New Mexico"},{label:"New York",value:"New York"},{label:"North Carolina",value:"North Carolina"},{label:"North Dakota",value:"North Dakota"},{label:"Ohio",value:"Ohio"},{label:"Oklahoma",value:"Oklahoma"},{label:"Oregon",value:"Oregon"},{label:"Pennsylvania",value:"Pennsylvania"},{label:"Rhode Island",value:"Rhode Island"},{label:"South Carolina",value:"South Carolina"},{label:"South Dakota",value:"South Dakota"},{label:"Tennessee",value:"Tennessee"},{label:"Texas",value:"Texas"},{label:"Utah",value:"Utah"},{label:"Vermont",value:"Vermont"},{label:"Virginia",value:"Virginia"},{label:"Washington",value:"Washington"},{label:"West Virginia",value:"Virginia"},{label:"Wisconsin",value:"Wisconsin"},{label:"Wyoming",value:"Wyoming"},{label:"Armed Forces Americas",value:"Armed Forces Americas"},{label:"Armed Forces Europe",value:"Armed Forces Europe"},{label:"Armed Forces Pacific",value:"Armed Forces Pacific"}]},{type:"profile:city",title:"City"},{type:"profile:timezone",title:"Timezone"},{type:"record:contest",title:"Contest Entry"}],AVAILABLE_CONSTRAINTS_META_MAP={};!function(){var a,b=AVAILABLE_CONSTRAINTS_META,c=AVAILABLE_CONSTRAINTS_META_MAP,d=b.length;for(a=0;d>a;a++)constraint=b[a],c[constraint.type]=constraint}();var QueryResult=Backbone.Model.extend({defaults:{email:""}}),EntryTypeCollection=Backbone.Collection.extend({model:EntryType}),EntryFieldCollection=Backbone.Collection.extend({model:EntryField}),ConstraintCollection=Backbone.Collection.extend({model:function(a,b){var c=ConstraintCollection.kindForType(a.type),d=ConstraintCollection.typesMap[c]||Constraint;return new d(a,b)},initialize:function(a,b){this.on("change add remove reset",this.save,this),Backbone.Collection.prototype.initialize.call(this,a,b)},save:function(){var a=JSON.stringify(this.toJSON()),b=jQuery("#constraints");b.attr("value",a)}},{kindForType:function(a){var b=a.split(":");return b.length>0?b[0]:a},typesMap:{system:Constraint,profile:ProfileConstraint,record:EntryConstraint}}),QueryResultCollection=Backbone.Collection.extend({model:QueryResult,initialize:function(a,b){this.activeConstraints=b.activeConstraints,Backbone.Collection.prototype.initialize(this,a,b)},search:function(){var a=this.activeConstraints.toJSON(),b="select * from accounts",c={query:b,constraints:a};ajaxApi.request("preview_member_query",c).then($.proxy(this.didPreviewSuccess,this)).fail($.proxy(this.didPreviewError,this))},didPreviewSuccess:function(a){a.success?(this.totalResults=a.data.total,this.reset(a.data.accounts),this.trigger("searchSuccess")):(this.totalResults=0,this.didPreviewError(a))},didPreviewError:function(a){this.trigger("searchError",a.data)},getTotalResults:function(){return this.totalResults}}),ToolbarItemView=Backbone.CollectionView.extend({template:getTemplate("toolbar_item"),events:{"click .toolbar_item":"didToolbarItemClick"},initialize:function(){this.render()},render:function(){var a=this.model.toViewJSON(),b=this.template(a);this.$el.html(b)},didToolbarItemClick:function(){var a=this.model.clone();return this.$el.trigger("addConstraint",a),!1}}),ToolbarView=Backbone.CollectionView.extend({modelView:ToolbarItemView,events:{addConstraint:"addConstraint"},initialize:function(a){this.activeConstraints=a.activeConstraints,a.tabIndex=-1,Backbone.CollectionView.prototype.initialize.call(this,a)},addConstraint:function(a,b){this.activeConstraints.add(b)}}),ConstraintView=Backbone.View.extend({template:getTemplate("constraint"),events:{"click .copy-constraint":"didCopyClick","click .remove-constraint":"didRemoveClick",change:"didChange"},initialize:function(){this.render()},render:function(){var a=this.model.toViewJSON();a.view=this;var b=this.template(a);this.$el.html(b);var c=$(".constraint-value",this.el);"date"===a.valueType?c.datepicker({dateFormat:"mm/dd/yy"}):this.hasChoices()},didCopyClick:function(){return this.$el.trigger("copyConstraint",this.model),!1},didRemoveClick:function(){return this.$el.trigger("removeConstraint",this.model),!1},didChange:function(){this.updateConstraint(this.model)},updateConstraint:function(a){var b=$(".constraint-operator",this.el).val(),c=$(".constraint-conjunction",this.el).val(),d=$(".constraint-value",this.el).val();d=this.parseValue(d,a.get("valueType"));var e={operator:b,value:d,conjunction:c};a.set(e)},parseValue:function(a,b){return"boolean"===b?"true"===a:"integer"===b?parseInt(a,10):"float"===b?parseFloat(a,10):a},allOperators:["equals","not equals","greater than","greater than or equal to","less than","less than or equal to","contains","not contains"],numericOperators:["equals","not equals","greater than","greater than or equal to","less than","less than or equal to"],stringOperators:["equals","not equals","contains","not contains"],booleanOperators:["equals","not equals"],operatorsFor:function(a){return"integer"===a||"float"===a?this.numericOperators:"string"===a?this.stringOperators:"boolean"===a?this.booleanOperators:this.allOperators},conjunctions:["and","or"],hasChoices:function(){return this.model.hasMeta("choices")}}),EntryConstraintView=ConstraintView.extend({template:getTemplate("entry_constraint"),entrySelectTemplate:getTemplate("entry_select"),entryAnswerTemplate:getTemplate("entry_answer"),initialize:function(a,b){ConstraintView.prototype.initialize.call(this,a,b),this.listenTo(this.model.getEntryTypes(),"reset",this.renderEntryTypes),this.listenTo(this.model.getEntryFields(),"reset",this.renderEntryField)},renderEntryTypes:function(){var a=$(".entry-select-type",this.el),b=this.model.getEntryTypes().toJSON(),c={choices:b,currentChoice:this.model.get("entryTypeID")},d=this.entrySelectTemplate(c);a.html(d)},renderEntryField:function(){var a=$(".entry-select-field",this.el),b=this.model.getEntryFields().toJSON(),c={choices:b,currentChoice:this.model.get("entryFieldID")},d=this.entrySelectTemplate(c);a.html(d),this.renderEntryAnswer()},renderEntryValueSelect:function(){var a=$(".constraint-value",this.el),b=this.model.getEntryFieldChoices(),c={choices:b,currentChoice:this.model.get("value")},d=this.entrySelectTemplate(c);a.html(d)},renderEntryAnswer:function(){var a=$(".entry-answer-group",this.el),b=this.model.toViewJSON();b.view=this,b.choices=this.model.getEntryFieldChoices(),b.currentChoice=this.model.get("value");var c=this.entryAnswerTemplate(b);a.html(c)},updateConstraint:function(a){var b=$(".constraint-operator",this.el).val(),c=$(".constraint-conjunction",this.el).val(),d=$(".constraint-value",this.el).val(),e=$(".entry-select-type",this.el).val(),f=$(".entry-select-field",this.el).val();d=this.parseValue(d,a.get("valueType"));var g={operator:b,value:d,conjunction:c,entryTypeID:this.parseValue(e,"integer"),entryFieldID:this.parseValue(f,"integer")};a.set(g),this.renderEntryAnswer()},hasChoices:function(){return this.model.hasChoices()}}),ActiveConstraintsView=Backbone.CollectionView.extend({el:jQuery("#active_constraints"),emptyListCaption:getTemplate("empty_constraints"),events:{copyConstraint:"copyConstraint",removeConstraint:"removeConstraint"},_getModelViewConstructor:function(a){var b=a.get("type"),c=ConstraintCollection.kindForType(b);return"record"===c?EntryConstraintView:ConstraintView},copyConstraint:function(a,b){var c=b.clone(),d=this.collection.indexOf(b);this.collection.add(c,{at:d+1})},removeConstraint:function(a,b){this.collection.remove(b)}}),PreviewView=Backbone.View.extend({events:{"click .preview-member-query-button":"didPreviewClick"},initialize:function(a){this.collection=a.collection,this.listenTo(this.collection,"searchError",this.didSearchError),this.listenTo(this.collection,"searchSuccess",this.didSearchSuccess),Backbone.View.prototype.initialize.call(this,a),this.search()},didPreviewClick:function(){return this.search(),!1},search:function(){this.setStatus("Searching, Please wait ..."),this.collection.search()},didSearchSuccess:function(){var a=this.collection.getTotalResults(),b=a+" records found";b+=a>0?", showing the first 5":".",this.setStatus(b)},didSearchError:function(a){this.setStatus("Error: "+a)},setStatus:function(a){var b=$(".count-status");b.text(a)}}),QueryResultItemView=Backbone.CollectionView.extend({template:getTemplate("query_result_item"),render:function(){var a=this.model.toJSON(),b=this.template(a);this.$el.html(b)}}),QueryResultsView=Backbone.CollectionView.extend({modelView:QueryResultItemView}),$=jQuery,QueryBuilderApp=function(){$(document).ready($.proxy(this.initialize,this))};QueryBuilderApp.prototype={initialize:function(){window.ajaxApi=new WpAjaxApi(member_query_meta);var a=member_query_data.constraints||[],b=new ConstraintCollection(AVAILABLE_CONSTRAINTS),c=new ConstraintCollection(a),d=new QueryResultCollection([],{activeConstraints:c}),e=new ToolbarView({el:$("#query_builder_toolbar"),collection:b,activeConstraints:c}),f=new ActiveConstraintsView({el:$("#active_constraints"),collection:c}),g=new PreviewView({el:$(".preview-member-query"),collection:d}),h=new QueryResultsView({el:$(".member-query-results"),collection:d});e.render(),f.render(),g.render(),h.render(),c.save()}};var app=new QueryBuilderApp;