/*! Greater Media Contests - v1.0.4
 * http://10up.com/
 * Copyright (c) 2015;
 * Licensed GPLv2+
 */
!function(a){var b,c,d=a.event;b=d.special.debouncedresize={setup:function(){a(this).on("resize",b.handler)},teardown:function(){a(this).off("resize",b.handler)},handler:function(a,e){var f=this,g=arguments,h=function(){a.type="debouncedresize",d.dispatch.apply(f,g)};c&&clearTimeout(c),e?h():c=setTimeout(h,b.threshold)},threshold:250}}(jQuery);var BLANK="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";!function(a){a.fn.imagesLoaded=function(b){function c(){var c=a(j),d=a(k);f&&(k.length?f.reject(h,c,d):f.resolve(h)),a.isFunction(b)&&b.call(e,h,c,d)}function d(b,d){b.src!==BLANK&&-1===a.inArray(b,i)&&(i.push(b),d?k.push(b):j.push(b),a.data(b,"imagesLoaded",{isBroken:d,src:b.src}),g&&f.notifyWith(a(b),[d,h,a(j),a(k)]),h.length===i.length&&(setTimeout(c),h.unbind(".imagesLoaded")))}var e=this,f=a.isFunction(a.Deferred)?a.Deferred():0,g=a.isFunction(f.notify),h=e.find("img").add(e.filter("img")),i=[],j=[],k=[];return a.isPlainObject(b)&&a.each(b,function(a,c){"callback"===a?b=c:f&&f[a](c)}),h.length?h.bind("load.imagesLoaded error.imagesLoaded",function(a){d(a.target,"error"===a.type)}).each(function(b,c){var e=c.src,f=a.data(c,"imagesLoaded");return f&&f.src===e?void d(c,f.isBroken):c.complete&&void 0!==c.naturalWidth?void d(c,0===c.naturalWidth||0===c.naturalHeight):void((c.readyState||c.complete)&&(c.src=BLANK,c.src=e))}):c(),f?f.promise(e):e}}(jQuery),function(a,b){var c,d=a(window),e=a("html, body"),f={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},g=f[b.prefixed("transition")],h=b.csstransitions;a.fn.grid=function(b){var f=a(this),i=a("#wpadminbar").height()||0,j={minHeight:816,speed:200,easing:"ease",loadMore:null,loadMoreWaypointOffset:"150%",loadMoreUrl:null,loadedMore:null,previewLoaded:null};return j=a.extend(!0,{},j,b),f.each(function(){function b(){s.imagesLoaded(function(){l(!0),o(),m()})}function f(b){t=t.add(b),b.each(function(){var b=a(this);b.data({offsetTop:b.offset().top,height:b.height()})}),n(b)}function k(){var b;if(a.isFunction(j.loadMoreUrl)){if(B)return;if(b=j.loadMoreUrl(A),!b)return;B=!0,A++,u.addClass("loading"),a.get(b,function(b){var c=a(a.trim(b));c.length>0?(s.append(c),f(c),c.length>=z?(B=!1,u.removeClass("loading"),a.waypoints("refresh"),a.isFunction(j.loadedMore)&&j.loadedMore(c)):u.hide()):u.hide()})}}function l(b){t.each(function(){var c=a(this);c.data("offsetTop",c.offset().top),b&&c.data("height",c.outerHeight())})}function m(){n(t),d.on("debouncedresize",function(){x=0,w=-1,l(),o();var b=a.data(this,"preview");"undefined"!=typeof b&&q()}),u.length>0&&(u.on("click",function(){return k(),!1}),u.waypoint({offset:j.loadMoreWaypointOffset,triggerOnce:!1,handler:function(a){"down"===a&&k()}}),a.waypoints("refresh"))}function n(b){b.on("click","span.preview-close",function(){return q(),!1}),b.on("click","> a",function(){var b=a(this).parent();return v===b.index()?q():p(b),!1})}function o(){c={width:d.width(),height:d.height()}}function p(b){var c=a.data(this,"preview"),d=b.data("offsetTop");if(x=0,"undefined"!=typeof c){if(w===d)return c.update(b),!1;d>w&&(x=c.height),q()}w=d,c=a.data(this,"preview",new r(b)),c.open()}function q(){var b=a.data(this,"preview");v=-1,b&&b.close(),a.removeData(this,"preview")}function r(a){this.$item=a,this.expandedIdx=this.$item.index(),this.create(),this.update()}var s=a(this),t=s.children("li"),u=a(j.loadMore),v=-1,w=-1,x=0,y=70,z=t.length,A=1,B=!1;r.prototype={create:function(){this.$closePreview=a('<span class="preview-close"></span>'),this.$previewInner=a('<div class="preview-inner"></div>').append(this.$closePreview),this.$previewEl=a('<div class="preview"></div>').append(this.$previewInner),this.$item.append(this.getEl()),h&&this.setTransition()},update:function(b){var c,d,e,f;if(f=this,b&&(f.$item=b,f.getEl().appendTo(b)),-1!==v){var g=t.eq(v);g.removeClass("expanded"),f.$item.addClass("expanded"),f.positionPreview()}v=f.$item.index(),c=f.$previewInner,c.html(f.$closePreview),d=f.$item.children("a"),e=d.data("content"),e?(c.append(e),a.isFunction(j.previewLoaded)&&j.previewLoaded(f)):a.get(d.attr("href"),{ajax:"true"},function(b){d.data("content",b),c.append(b),a.isFunction(j.previewLoaded)&&j.previewLoaded(f)})},open:function(){setTimeout(a.proxy(function(){this.setHeights(),this.positionPreview()},this),25)},close:function(){var b=this,c=function(){h&&a(this).off(g),b.$item.removeClass("expanded"),b.$previewEl.remove()};return setTimeout(a.proxy(function(){"undefined"!=typeof this.$largeImg&&this.$largeImg.fadeOut("fast"),this.$previewEl.css("height",0);var a=t.eq(this.expandedIdx);a.css("height",a.data("height")).on(g,c),h||c.call()},this),25),!1},calcHeight:function(){var a=c.height-this.$item.data("height")-y,b=c.height;a<j.minHeight&&(a=j.minHeight,b=j.minHeight+this.$item.data("height")+y),this.height=a,this.itemHeight=b},setHeights:function(){var a=this,b=function(){h&&a.$item.off(g),a.$item.addClass("expanded")};this.calcHeight(),this.$previewEl.css("height",this.height),this.$item.css("height",this.itemHeight).on(g,b),h||b.call()},positionPreview:function(){var a,b=this.$item.data("offsetTop"),d=this.$previewEl.offset().top-x;a=this.height+this.$item.data("height")+y<=c.height?b:this.height<c.height?d-(c.height-this.height):d,e.animate({scrollTop:a-i},j.speed)},setTransition:function(){this.$previewEl.css("transition","height "+j.speed+"ms "+j.easing),this.$item.css("transition","height "+j.speed+"ms "+j.easing)},getEl:function(){return this.$previewEl}},b()}),f}}(jQuery,gridModernizr),function(a){var b,c,d=a(document),e=function(a,b){var c=parseInt(a.text().replace(/\D+/g,""));isNaN(c)&&(c=0),c+=b,c=c.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,").replace(/\..*/g,""),a.text(c)},f=function(c){var f=c.$previewInner,g=c.$item,h=g.find(".contest__submission--rating b"),i=!1;a.fn.cycle&&f.find(".cycle-slideshow").cycle(),f.find(".contest__submission--vote").click(function(){var c=a(this),d=c.find("i.fa"),f=d.attr("class");return i||(i=!0,d.attr("class","fa fa-spinner fa-spin"),a.post(b.data("vote"),{ugc:c.data("id")},function(a){i=!1,d.attr("class",f),a.success&&(g.addClass("voted"),e(h,1))})),!1}),f.find(".contest__submission--unvote").click(function(){var c=a(this),d=c.find("i.fa"),f=d.attr("class");return i||(i=!0,d.attr("class","fa fa-spinner fa-spin"),a.post(b.data("unvote"),{ugc:c.data("id")},function(a){i=!1,d.attr("class",f),a.success&&(g.removeClass("voted"),e(h,-1))})),!1}),d.trigger("contest:preview-loaded")},g=function(a){return b.data("infinite")+(a+1)+"/"},h=function(){a.isFunction(is_gigya_user_logged_in)&&a.isFunction(get_gigya_user_field)&&is_gigya_user_logged_in()&&b.find("form").each(function(){var b=a(this),c=get_gigya_user_field("firstName"),d=get_gigya_user_field("lastName");b.find('input[type="text"]:first').val(c+" "+d)})},i=function(){b=a("#contest-form"),c=a(".contest__submissions--list"),d.on("submit","#contest-form form",function(){var c=a(this);if(!c.parsley||c.parsley().isValid()){var d=new FormData;c.find("input").each(function(){var b=this;"file"===b.type?a(this.files).each(function(a,c){d.append(b.name,c)}):"radio"===b.type||"checkbox"===b.type?b.checked&&d.append(b.name,b.value):d.append(b.name,b.value)}),c.find("textarea, select").each(function(){d.append(this.name,this.value)}),c.find("input, textarea, select, button").attr("disabled","disabled"),c.find("i.fa").show(),a.ajax({url:b.data("submit"),type:"post",data:d,processData:!1,contentType:!1,success:function(a){b.html(a)}})}return!1});var e=function(b){var c=a(".contest__restrictions");c.attr("class","contest__restrictions"),b&&c.addClass(b)},i=function(c){a.get(c,function(c){var d=null;c.success?(b.html(c.data.html),h(),a(".type-contest.collapsed").removeClass("collapsed")):d=c.data.restriction,e(d)})};a(".contest__restriction--min-age-yes").click(function(){return i(b.data("confirm-age")),!1}),a(".contest__restriction--min-age-no").click(function(){return e("age-fails"),!1}),b.length>0&&i(b.data("load")),c.length>0&&c.grid({loadMore:".contest__submissions--load-more",previewLoaded:f,loadMoreUrl:g})};d.bind("pjax:end",i).ready(i)}(jQuery),document.addEventListener("DOMContentLoaded",function(){function a(){var a=document.createElement("input"),b=document.documentElement,c={},d=":)";return function(e){for(var f,g,h,i=0,j=e.length;j>i;i++)a.setAttribute("type",g=e[i]),f="text"!==a.type,f&&(a.value=d,a.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(g)&&void 0!==a.style.WebkitAppearance?(b.appendChild(a),h=document.defaultView,f=h.getComputedStyle&&"textfield"!==h.getComputedStyle(a,null).WebkitAppearance&&0!==a.offsetHeight,b.removeChild(a)):/^(search|tel)$/.test(g)||(f=/^(url|email)$/.test(g)?a.checkValidity&&a.checkValidity()===!1:a.value!==d)),c[e[i]]=!!f;return c}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var b=a();b.hasOwnProperty("date")&&!1!==b.date||(jQuery("input[type=date]").datetimepicker({timepicker:!1,format:"m/d/Y"}),jQuery("input[type=time]").datetimepicker({datepicker:!1,format:"g:i A",formatTime:"g:i A",allowTimes:["12:00 AM","12:30 AM","1:00 AM","1:30 AM","2:00 AM","2:30 AM","3:00 AM","3:30 AM","4:00 AM","4:30 AM","5:00 AM","5:30 AM","6:00 AM","6:30 AM","7:00 AM","7:30 AM","8:00 AM","8:30 AM","9:00 AM","9:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","12:00 PM","12:30 PM","1:00 PM","1:30 PM","2:00 PM","2:30 PM","3:00 PM","3:30 PM","4:00 PM","4:30 PM","5:00 PM","5:30 PM","6:00 PM","6:30 PM","7:00 PM","7:30 PM","8:00 PM","8:30 PM","9:00 PM","9:30 PM","10:00 PM","10:30 PM","11:00 PM","11:30 PM"]}))},!1);