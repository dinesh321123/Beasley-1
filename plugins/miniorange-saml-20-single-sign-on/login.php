<?php
/*
Plugin Name: miniOrange SSO using SAML 2.0
Plugin URI: http://miniorange.com/
Description: (Premium Multi-Site)miniOrange SAML 2.0 SSO enables user to perform Single Sign On with any SAML 2.0 enabled Identity Provider.
Version: 20.0.6
Author: miniOrange
Author URI: http://miniorange.com/
*/


include_once dirname(__FILE__) . "\57\155\157\137\x6c\x6f\x67\151\156\137\163\141\x6d\x6c\137\163\163\157\137\x77\x69\144\x67\145\x74\x2e\160\150\160";
require "\155\x6f\x2d\163\x61\155\x6c\55\x63\154\141\x73\163\55\x63\x75\163\164\x6f\x6d\145\162\x2e\160\x68\x70";
require "\155\x6f\x5f\163\141\x6d\x6c\137\163\145\164\164\x69\156\147\163\137\160\x61\147\x65\56\160\x68\x70";
require "\115\x65\164\141\x64\141\164\141\x52\x65\141\x64\145\162\56\160\x68\x70";
require "\143\145\162\x74\x69\x66\151\x63\x61\x74\x65\137\165\x74\x69\154\151\164\x79\56\160\x68\160";
require "\x6d\157\x2d\163\x61\x6d\154\55\163\x75\142\x73\x69\164\145\x2d\x61\143\x63\145\163\163\55\x64\145\x6e\x69\145\144\55\160\x61\147\145\x2e\x70\x68\160";
require_once "\155\157\55\x73\x61\x6d\154\55\160\154\x75\147\x69\x6e\55\166\x65\x72\163\x69\x6f\x6e\x2d\165\160\x64\141\164\x65\56\160\x68\160";
include_once "\170\x6d\154\163\145\x63\x6c\x69\142\163\56\160\150\x70";
include_once "\x4d\117\x5f\x53\x69\x74\x65\x73\x5f\114\151\163\x74\x2e\x70\150\160";
use RobRichards\XMLSecLibs\XMLSecurityKey;
use RobRichards\XMLSecLibs\XMLSecurityDSig;
use RobRichards\XMLSecLibs\XMLSecEnc;
class saml_mo_login
{
    private $widgetObj;
    function __construct()
    {
        add_site_option("\x6d\x6f\137\141\160\160\x6c\x79\x5f\162\157\154\145\137\x6d\x61\x70\x70\151\156\x67\x5f\146\x6f\x72\x5f\x73\151\164\x65\163", 0);
        add_action("\156\145\164\x77\x6f\x72\x6b\137\141\x64\x6d\x69\156\x5f\155\145\156\x75", array($this, "\x6d\x69\x6e\x69\x6f\x72\141\156\147\x65\137\x73\163\157\x5f\155\145\x6e\x75"));
        add_action("\141\x64\x6d\x69\x6e\x5f\x69\156\151\164", array($this, "\x6d\x69\x6e\x69\x6f\162\x61\x6e\x67\x65\x5f\x6c\x6f\147\151\156\x5f\167\151\x64\147\145\x74\x5f\163\x61\155\154\x5f\x73\141\166\x65\137\x73\145\x74\x74\x69\156\147\x73"));
        add_action("\141\144\x6d\x69\x6e\x5f\x65\156\x71\165\x65\x75\x65\x5f\x73\143\x72\151\x70\x74\x73", array($this, "\x70\154\x75\x67\151\x6e\x5f\163\x65\164\x74\151\156\x67\163\137\x73\x74\171\154\x65"));
        register_deactivation_hook(__FILE__, array($this, "\155\x6f\x5f\x73\x73\x6f\x5f\163\x61\x6d\154\x5f\144\145\x61\x63\x74\151\166\x61\x74\x65"));
        register_activation_hook(__FILE__, array($this, "\155\157\x5f\x73\x73\157\137\x73\141\x6d\x6c\137\141\143\x74\151\166\x61\x74\145"));
        add_action("\141\x64\155\x69\x6e\137\145\156\161\x75\x65\x75\145\137\163\x63\162\x69\x70\x74\x73", array($this, "\160\154\165\x67\151\x6e\x5f\x73\145\164\164\x69\156\x67\163\x5f\163\143\x72\x69\x70\164"));
        add_action("\x6c\x6f\147\x69\156\x5f\x65\x6e\x71\x75\145\165\145\x5f\x73\143\x72\x69\x70\164\x73", array($this, "\x6d\x6f\x5f\x73\x61\155\x6c\137\x6c\x6f\147\151\x6e\137\145\156\161\165\145\x75\x65\137\x73\x63\x72\151\x70\164\163"));
        remove_action("\x6e\145\x74\x77\157\162\x6b\137\x61\144\x6d\151\156\137\156\x6f\164\x69\x63\x65\163", array($this, "\x6d\x6f\137\x73\141\x6d\x6c\x5f\163\x75\143\x63\x65\163\163\137\x6d\x65\x73\x73\141\147\x65"));
        remove_action("\x6e\x65\x74\167\x6f\x72\153\x5f\141\x64\155\x69\156\137\156\157\x74\151\143\x65\163", array($this, "\155\x6f\137\x73\x61\x6d\x6c\137\x65\162\162\157\162\137\155\x65\x73\x73\x61\x67\x65"));
        add_action("\167\160\137\141\x75\x74\150\x65\156\x74\151\x63\141\164\145", array($this, "\155\x6f\137\x73\141\155\x6c\x5f\141\x75\164\150\x65\x6e\164\x69\x63\x61\x74\145"));
        add_action("\x77\160", array($this, "\x6d\157\x5f\163\141\155\154\x5f\x61\165\x74\157\x5f\x72\x65\x64\151\x72\145\x63\x74"));
        $this->widgetObj = new mo_login_wid();
        add_action("\x6c\x6f\147\x69\156\137\146\x6f\162\155", array($this, "\x6d\x6f\137\x73\141\155\x6c\x5f\x6d\x6f\144\151\146\171\x5f\154\157\x67\151\156\137\146\157\x72\x6d"));
        add_shortcode("\115\117\137\x53\101\x4d\114\x5f\x46\x4f\122\115", array($this, "\x6d\157\137\x67\145\x74\x5f\163\x61\x6d\154\137\163\x68\x6f\x72\164\143\157\144\x65"));
        add_filter("\x63\162\157\156\137\x73\143\150\x65\144\165\x6c\145\163", array($this, "\x6d\171\x70\x72\145\146\x69\x78\x5f\x61\x64\x64\x5f\x63\162\157\x6e\x5f\x73\x63\x68\145\144\x75\x6c\145"));
        add_action("\x6d\145\164\141\x64\x61\164\141\137\x73\x79\x6e\143\x5f\143\x72\157\156\x5f\141\143\164\x69\x6f\x6e", array($this, "\155\145\x74\x61\x64\x61\164\x61\x5f\x73\x79\156\x63\x5f\x63\162\x6f\x6e\137\141\x63\x74\151\157\156"));
        add_action("\141\x64\x6d\151\x6e\x5f\151\156\151\x74", array($this, "\x64\145\146\141\x75\x6c\164\137\143\145\162\164\x69\x66\x69\143\141\164\145"));
        add_action("\156\145\x74\x77\x6f\162\x6b\137\x61\144\x6d\151\x6e\x5f\160\154\165\147\x69\156\137\x61\143\x74\151\x6f\x6e\x5f\154\151\156\153\163\137" . plugin_basename(__FILE__), array($this, "\x6d\x6f\137\x73\141\x6d\154\x5f\x70\x6c\165\147\x69\x6e\137\x61\143\164\x69\x6f\x6e\137\x6c\151\156\153\163"));
        add_filter("\167\x70\155\x75\137\x75\163\145\162\163\x5f\x63\157\154\165\x6d\x6e\x73", array($this, "\155\157\137\x73\141\x6d\154\x5f\x63\x75\x73\164\157\155\137\x61\164\164\162\x5f\143\157\x6c\165\155\x6e"));
        add_filter("\x6d\x61\156\x61\x67\x65\x5f\x75\163\x65\x72\163\137\x63\x75\x73\164\x6f\x6d\137\x63\x6f\154\165\x6d\x6e", array($this, "\155\x6f\137\163\141\x6d\154\137\141\x74\x74\x72\x5f\x63\157\154\x75\155\156\137\x63\x6f\x6e\164\x65\156\x74"), 10, 3);
        add_action("\x61\144\x6d\x69\x6e\x5f\x69\156\x69\x74", "\x6d\x6f\137\163\141\x6d\154\x5f\x64\157\x77\156\x6c\x6f\141\x64");
        add_action("\x6d\x6f\137\x73\x61\155\x6c\137\x66\154\x75\x73\150\x5f\x63\x61\143\x68\x65", array($this, "\155\157\137\163\141\x6d\x6c\137\x66\x6c\x75\x73\x68\x5f\x63\141\x63\150\x65"), 9999);
        add_action("\x64\145\x6c\145\x74\145\137\x75\x73\145\162\x5f\146\157\162\155", array($this, "\155\157\x5f\144\x65\x6c\x65\x74\x65\x5f\x75\x73\x65\162\163"), 10, 2);
        global $Z3;
        if ((float) $Z3 < 5.5 && (float) $Z3 > 5.2) {
            goto I3;
        }
        add_action("\x77\160\137\154\x6f\147\157\x75\x74", array($this->widgetObj, "\155\157\137\163\141\x6d\154\x5f\154\x6f\x67\157\165\164"), 1, 1);
        goto X8;
        I3:
        add_filter("\x6c\157\x67\157\165\164\137\162\145\x64\151\162\145\x63\x74", array($this, "\x6d\x6f\x5f\163\x61\155\x6c\137\154\x6f\x67\157\x75\x74\x5f\142\x72\157\153\x65\x72\137\x77\151\x74\x68\137\146\x69\x6c\164\x65\162"), 10, 3);
        X8:
    }
    function mo_saml_logout_broker_with_filter($dh, $yA, $user)
    {
        $this->widgetObj->mo_saml_logout($user->ID);
    }
    function mo_delete_users($current_user, $SB)
    {
        if (count($SB) > 1) {
            goto Ku;
        }
        $h_ = false;
        goto Bg;
        Ku:
        $h_ = true;
        Bg:
        foreach ($SB as $cq) {
            $user = get_user_by("\151\x64", $cq);
            $this->mo_delete_user($user, $SB, $h_);
            Fp:
        }
        d8:
    }
    function mo_delete_user($wf, $SB, $h_)
    {
        $Fj = get_users();
        $Fk = $wf->ID;
        $ue = "\74\x6c\x61\x62\x65\x6c\40\146\157\x72\x3d\x22\162\x65\141\x73\163\x69\147\x6e\137\165\x73\x65\x72\42\x20\143\x6c\x61\163\163\x3d\42\163\x63\162\145\x65\x6e\x2d\x72\145\x61\144\145\162\x2d\x74\145\170\164\x22\76" . __("\x53\145\x6c\145\x63\164\40\141\x20\165\x73\145\162") . "\74\57\x6c\141\142\145\154\x3e";
        $ue .= "\74\163\145\154\x65\x63\x74\40\156\x61\x6d\145\x3d\42\x61\154\x6c\137\x62\x6c\x6f\147\x73\42\40\151\144\x3d\x22\x72\x65\141\x73\x73\151\x67\x6e\137\x75\163\145\162\137\141\x6c\154\42\40\157\156\143\x68\x61\156\x67\x65\x3d\x22\x72\x65\101\x73\x73\151\x67\156\124\157\125\163\x65\x72\50\x74\x68\x69\x73\54\x20" . $Fk . "\51\x22\76";
        $G9 = '';
        foreach ($Fj as $user) {
            if (in_array($user->ID, $SB)) {
                goto Sc;
            }
            $G9 .= "\x3c\157\160\164\151\157\x6e\x20\166\141\154\x75\145\75\47{$user->ID}\47\76{$user->user_login}\x3c\57\157\160\164\x69\157\156\x3e";
            Sc:
            YX:
        }
        ej:
        $ue .= $G9;
        $ue .= "\x3c\57\163\145\x6c\x65\143\164\x3e\12";
        echo "\x20\x20\40\x20\x20\40\40\40\74\x74\x61\142\154\x65\40\143\x6c\141\163\x73\x3d\42\146\x6f\162\x6d\55\164\x61\142\x6c\145\42\40\x72\157\x6c\145\75\42\160\x72\145\x73\x65\x6e\x74\x61\x74\151\157\156\x22\x3e\xd\12\15\12\x20\x20\x20\x20\40\40\x20\x20\40\x20\40\40\x3c\x74\x72\76\74\164\x68\40\163\143\157\x70\145\75\x22\x72\157\x77\42\x3e";
        if (!$h_) {
            goto Fz;
        }
        echo $wf->user_login;
        Fz:
        echo "\40\74\57\x74\150\x3e\74\x74\x64\x3e\15\12\40\x20\40\x20\x20\40\40\40\40\x20\x20\40\x20\x20\40\x20\x20\x20\x20\x20\x3c\165\154\x20\163\164\171\x6c\145\x3d\x22\154\x69\163\164\55\163\164\x79\154\145\72\156\157\156\x65\73\42\x3e\15\xa\x20\40\x20\40\x20\40\40\x20\40\40\x20\40\40\40\x20\x20\x20\40\x20\40\40\40\40\x20\x3c\154\151\x3e\xd\12\40\40\40\40\x20\40\x20\x20\40\40\40\40\x20\x20\x20\x20\x20\40\40\x20\40\x20\x20\x20\40\x20\x20\40";
        printf(__("\x3c\x62\x3e\123\151\x74\145\72\40\45\x73\74\x2f\142\x3e"), "\101\154\x6c\x20\123\151\x74\x65\163");
        echo "\x20\x20\40\40\x20\40\40\x20\x20\x20\40\x20\40\40\40\x20\x20\x20\x20\40\x20\40\40\40\74\57\x6c\151\x3e\xd\xa\40\x20\x20\x20\x20\40\40\40\x20\x20\40\40\40\x20\40\40\x20\x20\40\x20\x20\x20\40\x20\x3c\x6c\x69\76\x3c\x6c\141\x62\145\x6c\x3e\74\151\x6e\x70\165\164\40\x74\x79\160\145\x3d\x22\162\x61\144\x69\157\42\x20\x69\x64\x3d\42\144\145\x6c\x65\x74\145\137\157\x70\164\x69\x6f\x6e\x30\x41\154\154\42\40\156\141\155\x65\x3d\x22\x64\145\154\145\x74\x65\x41\154\x6c";
        echo $Fk;
        echo "\x22\40\166\141\154\x75\145\75\42\144\145\x6c\145\x74\145\x22\40\143\x68\x65\143\x6b\145\x64\x3d\42\x63\x68\145\143\x6b\x65\x64\x22\x20\157\x6e\143\150\141\x6e\147\x65\x3d\42\x64\145\x6c\145\164\x65\101\154\154\144\141\x74\141\x28\47";
        echo $Fk;
        echo "\x27\x29\42\40\x2f\76\xd\xa\40\x20\x20\x20\x20\x20\x20\40\x20\40\x20\40\40\40\x20\40\x20\x20\x20\40\40\x20\x20\40\x20\x20\40\x20\x20\40\x20\x20";
        _e("\x44\145\154\x65\164\145\40\141\x6c\154\40\x63\x6f\x6e\164\x65\x6e\164\x2e");
        echo "\x3c\57\x6c\141\x62\x65\154\x3e\x3c\57\x6c\151\76\xd\xa\x20\40\x20\40\40\40\40\40\40\x20\40\x20\x20\x20\x20\x20\40\x20\40\x20\40\40\40\x20\x3c\154\x69\x3e\74\154\x61\x62\145\154\76\74\x69\x6e\160\x75\164\40\x74\x79\160\145\75\42\x72\141\x64\151\x6f\x22\x20\x69\x64\75\42\x64\145\154\x65\164\x65\x5f\157\160\x74\151\x6f\156\x31\101\x6c\154\42\x20\156\x61\155\145\x3d\42\144\x65\154\x65\x74\145\101\154\x6c";
        echo $Fk;
        echo "\42\40\166\x61\154\165\145\x3d\x22\162\145\141\163\163\x69\147\x6e\x22\40\x6f\156\x63\x68\141\x6e\x67\145\x3d\42\141\163\x73\x69\147\156\101\154\x6c\144\141\164\141\50\x27";
        echo $Fk;
        echo "\x27\x29\x22\x2f\76\15\12\x20\40\x20\40\40\40\40\x20\x20\40\40\x20\40\40\40\40\x20\x20\x20\x20\x20\40\x20\x20\40\x20\x20\40\40\x20\x20\40";
        _e("\x41\x74\x74\x72\x69\x62\165\x74\145\x20\x61\154\x6c\40\143\x6f\x6e\x74\x65\156\164\40\164\157\x3a");
        echo "\74\x2f\154\141\x62\x65\154\76\15\12\40\x20\40\x20\x20\x20\x20\40\40\40\x20\x20\40\x20\40\40\40\x20\40\40\x20\40\x20\40\x20\40\40\x20";
        echo $ue;
        echo "\74\x2f\154\151\76\xd\xa\x20\x20\x20\x20\x20\x20\40\x20\40\x20\40\x20\40\x20\40\40\40\40\x20\x20\x20\40\40\x20\x3c\x6c\151\76\x3c\x73\160\x61\x6e\40\151\144\x3d\x22\155\157\x5f\x64\x65\x6c\x65\164\145\x5f\165\163\x65\162\137\x6e\157\x74\x69\143\145";
        echo $Fk;
        echo "\42\x20\x73\x74\171\x6c\x65\75\x22\166\x69\x73\x69\142\151\x6c\151\x74\171\72\x20\150\x69\x64\x64\x65\156\x22\76\x3c\x62\x72\x2f\76\74\x62\76\x4e\117\124\105\x3a\x20\74\x2f\142\76\124\150\x65\40\163\x65\x6c\145\143\164\x65\x64\x20\x75\163\145\162\40\144\157\145\x73\x6e\47\164\40\x65\170\151\163\x74\40\x69\x6e\x20\164\x68\x65\40\x66\x6f\154\154\x6f\x77\x69\156\x67\40\163\x75\x62\163\x69\x74\145\163\x2e\40\x4b\151\x6e\x64\x6c\x79\x20\141\x74\x74\162\151\x62\165\164\145\x20\x74\150\x65\40\143\x6f\156\164\x65\156\x74\x20\x66\x6f\x72\x20\164\x68\145\40\146\x6f\x6c\x6c\x6f\x77\151\156\147\x20\163\x75\142\163\x69\164\x65\x73\x20\x6d\141\x6e\165\x61\154\154\x79\x20\x6f\x72\40\163\145\x6c\145\x63\x74\40\141\x20\x64\151\x66\x66\x65\x72\x65\156\x74\40\165\x73\x65\162\x2e\74\x2f\163\160\141\156\76\74\x2f\x6c\x69\76\15\xa\40\x20\x20\x20\40\x20\x20\x20\x20\x20\x20\40\40\x20\x20\x20\x20\x20\x20\40\40\x20\x20\40\74\x6f\154\40\151\144\x3d\42\155\157\137\x73\x75\142\x73\x69\164\x65\x5f\154\151\163\x74";
        echo $Fk;
        echo "\x22\40\x73\164\x79\154\145\x3d\42\x76\151\x73\151\142\151\154\x69\x74\171\x3a\x20\150\151\x64\144\145\156\x22\x3e\xd\12\x20\40\x20\40\x20\40\40\40\40\x20\40\x20\x20\40\x20\40\x20\40\x20\x20\40\x20\40\40\x3c\x2f\157\x6c\76\15\xa\40\40\x20\40\40\x20\40\x20\x20\40\x20\x20\x20\x20\40\40\x20\40\x20\40\x3c\x2f\165\x6c\76\xd\xa\40\x20\40\x20\40\x20\40\40\x20\40\x20\40\x20\x20\x20\40\74\x2f\164\144\x3e\74\x2f\x74\x72\x3e\15\12\x20\x20\x20\40\40\40\x20\x20\74\x2f\x74\x61\142\154\x65\x3e\15\12\15\xa\40\x20\40\40\40\x20\40\x20\x3c\163\143\162\151\x70\x74\76\15\12\xd\12\x20\x20\40\x20\x20\40\x20\40\x20\40\40\40\x66\x75\156\x63\x74\151\157\x6e\40\144\x65\x6c\145\164\145\101\x6c\x6c\144\x61\164\x61\50\x69\144\51\x7b\xd\12\x20\40\x20\x20\x20\x20\x20\x20\40\x20\x20\x20\x20\x20\x20\40\x76\141\x72\40\x65\x6c\145\155\x73\40\x3d\40\144\157\143\165\155\x65\156\164\56\161\x75\145\162\171\x53\145\x6c\x65\x63\x74\157\x72\x41\x6c\154\50\x22\x5b\156\141\x6d\x65\136\75\47\144\145\154\x65\x74\x65\47\x5d\133\156\x61\155\145\44\75\x27\x5b\42\40\x2b\x20\151\144\x20\53\x20\42\135\x27\135\x22\x29\x3b\xd\xa\40\x20\x20\40\40\x20\40\40\40\x20\40\x20\40\40\40\x20\146\x6f\162\50\145\154\x65\x6d\x20\157\146\40\x65\x6c\x65\x6d\x73\51\x20\x7b\xd\xa\40\x20\x20\40\40\x20\x20\x20\x20\x20\x20\40\40\x20\x20\x20\x20\x20\40\x20\x69\x66\x28\145\154\x65\155\x2e\x76\141\x6c\165\x65\x20\x3d\75\x20\42\x64\x65\154\145\164\145\x22\x29\15\12\x20\x20\40\x20\x20\x20\40\40\x20\x20\40\x20\40\40\x20\x20\x20\40\40\x20\x20\x20\x20\40\145\154\x65\x6d\56\143\x68\145\143\153\x65\144\40\x3d\x20\x74\162\165\145\73\15\xa\x20\x20\40\x20\x20\40\40\x20\40\x20\40\x20\40\x20\x20\40\x7d\xd\xa\x20\x20\40\40\x20\40\x20\40\40\x20\40\x20\x7d\xd\xa\15\12\x20\40\40\x20\40\40\40\x20\x20\x20\40\x20\x66\165\x6e\x63\x74\151\157\156\40\x61\163\x73\151\x67\156\101\154\x6c\144\141\x74\x61\50\x69\144\51\x7b\xd\12\x20\40\40\x20\x20\x20\x20\40\40\40\x20\x20\40\x20\40\40\x76\141\x72\40\x65\x6c\x65\x6d\163\40\75\40\x64\x6f\x63\165\155\145\156\164\56\x71\x75\145\162\171\x53\x65\154\x65\143\164\x6f\x72\x41\154\x6c\x28\42\133\156\141\x6d\x65\136\75\47\x64\145\154\x65\164\x65\x27\x5d\x5b\x6e\x61\155\x65\x24\x3d\x27\x5b\42\40\53\x20\151\x64\40\53\x20\x22\135\47\135\x22\51\73\15\12\40\x20\x20\x20\40\40\40\40\40\40\40\x20\x20\x20\x20\40\x66\157\x72\x28\145\154\145\155\40\157\146\40\145\x6c\x65\155\x73\51\40\173\15\xa\40\x20\40\40\x20\x20\40\40\40\x20\x20\40\40\40\40\40\40\40\40\40\151\146\50\x65\154\145\155\x2e\x76\x61\154\165\x65\x20\x3d\75\x20\42\x72\145\141\x73\163\x69\147\156\x22\x29\15\xa\x20\40\x20\x20\40\x20\x20\x20\x20\x20\40\40\40\40\x20\x20\x20\x20\x20\40\40\40\40\40\x65\154\x65\155\56\x63\150\145\143\153\x65\144\x20\x3d\x20\x74\162\x75\145\73\15\12\x20\40\x20\x20\x20\40\x20\40\x20\x20\40\40\x20\40\x20\40\x7d\xd\12\40\40\x20\40\40\x20\x20\40\40\x20\40\40\x7d\xd\xa\xd\12\40\x20\x20\x20\40\40\40\40\40\40\x20\40\146\165\156\x63\x74\x69\157\x6e\x20\x72\145\101\x73\x73\x69\x67\156\x54\157\125\x73\145\162\50\165\163\x65\162\123\x65\154\x65\143\x74\x2c\x20\x75\x73\145\162\151\x64\x29\x7b\15\xa\x20\40\x20\40\x20\40\40\40\x20\40\40\40\40\x20\x20\40\x66\x6c\165\x73\150\x45\x78\x69\163\x74\151\x6e\147\123\165\142\x73\151\164\x65\114\151\x73\164\x28\x75\163\145\x72\x69\144\51\x3b\xd\xa\x20\40\40\40\x20\40\40\x20\x20\40\40\40\40\40\40\x20\x76\141\162\40\145\x6c\x65\x6d\163\40\75\x20\144\x6f\x63\165\155\x65\x6e\x74\x2e\x71\x75\x65\x72\x79\123\x65\x6c\145\143\164\x6f\162\101\x6c\154\50\x22\x5b\156\141\x6d\145\x5e\75\47\142\x6c\157\x67\133\42\40\x2b\x20\165\163\x65\162\x69\144\40\53\40\x22\135\47\x5d\x22\x29\73\15\xa\x20\40\40\x20\40\x20\x20\40\x20\40\40\40\40\x20\40\40\x76\141\162\40\141\x6c\154\x53\151\x74\x65\x73\x20\x3d\x20\x74\x72\165\x65\x3b\15\xa\x20\x20\x20\40\x20\40\x20\40\x20\x20\x20\40\x20\40\x20\40\x66\157\162\50\x65\154\x65\x6d\40\157\146\x20\x65\x6c\x65\x6d\163\x29\40\173\15\12\x20\40\x20\x20\40\x20\x20\x20\x20\x20\40\40\40\x20\40\40\x20\x20\x20\40\x69\x66\x28\151\163\117\x70\x74\x69\157\156\x45\170\151\163\x74\x28\145\154\145\x6d\54\x20\165\x73\145\162\x53\x65\x6c\145\143\164\56\x76\141\154\x75\145\51\51\15\xa\x20\x20\x20\40\x20\40\40\40\x20\40\40\x20\x20\40\x20\x20\40\x20\40\x20\40\x20\x20\40\x65\154\x65\155\x2e\x76\x61\154\x75\145\40\75\x20\x75\x73\x65\x72\123\x65\x6c\145\x63\x74\x2e\166\141\x6c\x75\145\x3b\15\xa\40\x20\40\x20\x20\40\40\x20\40\40\x20\x20\x20\40\x20\40\x20\x20\x20\x20\145\154\x73\x65\x20\173\xd\12\x20\40\x20\x20\40\x20\40\x20\40\x20\x20\40\x20\40\40\40\40\40\x20\x20\40\x20\40\40\x73\x68\x6f\167\115\x6f\x44\x65\154\145\x74\x65\x4e\x6f\164\x69\143\x65\x28\145\x6c\x65\x6d\x2c\x20\165\163\145\162\x69\x64\51\x3b\xd\12\40\x20\x20\x20\x20\x20\x20\x20\x20\40\40\x20\x20\x20\x20\40\x20\x20\x20\40\40\x20\40\x20\x61\x6c\154\x53\x69\x74\145\x73\x20\75\x20\146\141\x6c\163\145\x3b\15\12\40\x20\40\40\40\x20\x20\x20\x20\40\40\40\40\x20\x20\40\40\40\x20\x20\175\xd\12\xd\12\x20\x20\40\40\40\x20\40\x20\x20\40\40\x20\x20\40\40\x20\175\xd\xa\xd\xa\40\40\40\40\x20\x20\40\40\x20\x20\40\x20\40\40\x20\x20\x69\146\x28\141\154\x6c\x53\x69\x74\x65\163\x29\x20\x7b\15\12\40\x20\x20\40\40\40\40\40\x20\x20\40\40\40\x20\x20\40\x20\40\40\40\x64\157\x63\165\155\x65\x6e\x74\56\x67\145\x74\x45\x6c\145\x6d\x65\156\164\102\171\x49\x64\x28\42\x6d\157\x5f\x64\x65\x6c\145\164\145\x5f\165\163\145\x72\137\156\157\164\151\143\145\x22\x20\53\x20\x75\x73\x65\x72\x69\144\51\x2e\x73\x74\x79\154\145\56\x76\151\163\151\x62\151\154\x69\164\171\x20\75\40\42\x68\x69\x64\x64\145\156\42\73\15\12\x20\40\x20\40\x20\x20\x20\x20\40\40\x20\40\x20\x20\x20\x20\x20\40\x20\40\144\x6f\x63\x75\x6d\145\x6e\x74\56\147\145\164\105\x6c\x65\155\x65\x6e\164\x42\171\x49\144\50\x22\x6d\x6f\x5f\x73\x75\142\x73\151\164\x65\137\x6c\x69\x73\164\42\40\x2b\x20\165\x73\145\162\151\x64\51\56\163\x74\171\154\x65\56\166\151\163\x69\x62\151\154\x69\164\171\40\x3d\x20\42\150\x69\144\144\145\x6e\42\73\xd\xa\x20\x20\40\x20\x20\40\40\40\x20\x20\x20\x20\x20\40\x20\40\x7d\xd\12\x20\x20\x20\x20\40\40\40\40\40\x20\x20\x20\175\xd\xa\15\xa\40\x20\x20\40\40\x20\40\40\x20\40\x20\x20\x66\x75\x6e\x63\164\151\x6f\x6e\40\151\x73\x4f\x70\x74\151\157\156\x45\170\x69\x73\x74\x28\163\x65\x6c\145\x63\x74\x2c\40\x76\141\154\165\x65\x29\173\15\12\xd\12\40\40\40\x20\40\40\40\40\x20\x20\x20\x20\x20\x20\x20\40\146\x6f\x72\x28\151\x20\x3d\x20\x30\73\x20\x69\40\x3c\40\x73\x65\154\x65\x63\x74\x2e\154\x65\x6e\x67\x74\x68\x3b\40\x69\x2b\53\x29\x7b\xd\xa\40\x20\x20\x20\40\x20\x20\40\x20\x20\40\40\x20\x20\40\x20\40\x20\x20\40\151\x66\50\x73\145\x6c\145\x63\164\56\157\x70\164\151\x6f\x6e\x73\x5b\x69\x5d\56\166\141\x6c\x75\x65\x20\x3d\x3d\40\166\141\x6c\x75\x65\51\15\xa\x20\x20\x20\x20\x20\40\x20\40\40\40\x20\40\x20\40\x20\x20\40\x20\40\x20\40\40\40\x20\162\x65\x74\x75\162\156\40\x74\162\x75\x65\x3b\xd\12\x20\40\x20\40\x20\40\x20\40\40\x20\40\40\x20\x20\40\40\175\xd\xa\40\40\40\40\x20\40\40\x20\x20\40\x20\40\x20\x20\x20\40\x72\145\x74\x75\162\x6e\40\x66\141\x6c\163\x65\73\15\12\40\x20\40\x20\40\x20\x20\40\40\x20\x20\x20\175\15\xa\15\xa\40\x20\x20\x20\x20\40\x20\40\40\x20\40\40\146\165\156\143\164\151\x6f\156\40\x73\x68\157\x77\115\157\104\145\x6c\x65\164\x65\116\x6f\164\151\x63\145\50\x65\x6c\x65\155\x2c\x20\165\163\145\x72\151\144\x29\x7b\xd\12\x20\x20\40\40\x20\x20\x20\x20\x20\x20\40\40\40\x20\x20\40\x64\157\x63\x75\155\x65\156\164\56\147\x65\164\x45\154\145\155\x65\x6e\164\x42\x79\111\x64\x28\x22\155\157\137\x64\x65\x6c\145\164\x65\137\165\x73\x65\162\x5f\x6e\x6f\x74\151\143\x65\42\x20\x2b\40\x75\x73\x65\x72\151\144\x29\x2e\x73\164\x79\x6c\x65\56\x76\151\163\151\x62\151\154\x69\x74\171\x20\75\x20\42\x76\x69\163\x69\x62\x6c\145\42\x3b\xd\12\x20\x20\40\40\x20\x20\40\x20\x20\x20\x20\x20\x20\x20\40\40\144\x6f\143\x75\x6d\x65\156\x74\x2e\147\145\164\105\154\x65\x6d\x65\x6e\x74\102\x79\111\x64\50\x22\155\157\x5f\x73\165\x62\163\x69\x74\145\x5f\x6c\151\163\x74\x22\x20\53\40\165\163\145\x72\x69\144\x29\x2e\163\164\171\x6c\145\x2e\166\151\163\151\x62\151\x6c\x69\164\x79\x20\x3d\x20\42\166\151\x73\151\142\x6c\145\42\73\15\xa\x20\x20\40\x20\40\x20\40\x20\40\40\40\x20\40\40\x20\x20\165\x72\x6c\x20\x3d\x20\147\145\164\x53\x75\x62\163\x69\164\145\x57\150\145\x72\145\x55\163\x65\x72\x44\157\145\163\116\x6f\164\x45\170\x69\x73\164\50\145\154\x65\155\x29\73\xd\xa\40\40\40\x20\40\40\x20\x20\x20\40\40\x20\x20\x20\40\x20\x6e\141\x6d\x65\x20\x3d\x20\147\x65\164\x53\165\142\163\151\164\145\x4e\x61\155\x65\127\x68\145\x72\x65\125\x73\x65\x72\104\157\x65\163\x4e\157\164\x45\170\151\163\x74\x28\145\x6c\145\x6d\x29\x3b\15\12\40\x20\x20\x20\x20\x20\x20\x20\x20\40\40\40\40\40\40\40\141\144\144\125\x72\x6c\124\x6f\x4c\151\163\164\50\x75\x72\x6c\x2c\x20\x6e\141\155\x65\54\40\165\x73\x65\162\x69\144\x29\73\xd\xa\x20\40\x20\40\40\x20\x20\40\x20\x20\x20\40\x7d\15\xa\xd\12\40\40\40\40\40\40\x20\40\x20\40\40\40\x66\165\x6e\143\x74\x69\157\156\40\147\145\164\123\165\x62\163\x69\x74\x65\x57\150\x65\162\145\x55\x73\145\162\104\x6f\145\163\x4e\157\x74\105\170\151\163\164\x28\x65\x6c\x65\x6d\x65\x6e\x74\51\173\xd\12\x20\x20\x20\40\x20\40\x20\40\40\40\x20\x20\40\40\x20\x20\163\165\142\x73\151\164\145\x55\x72\x6c\x20\x3d\x20\x65\154\x65\x6d\x65\x6e\x74\x2e\x70\141\162\145\156\164\105\x6c\145\155\x65\156\164\x2e\160\x61\x72\145\156\164\105\x6c\145\x6d\145\x6e\164\56\146\151\x72\x73\x74\105\x6c\145\x6d\x65\156\164\103\x68\x69\154\144\x2e\146\151\162\163\164\105\x6c\x65\x6d\145\156\164\103\150\x69\x6c\144\x2e\147\145\x74\101\x74\164\162\x69\142\165\164\145\x28\x22\x68\x72\x65\x66\x22\51\x3b\xd\xa\40\40\x20\x20\40\x20\40\x20\x20\40\x20\40\x20\x20\x20\40\162\x65\164\x75\x72\x6e\40\163\x75\142\x73\x69\164\x65\125\x72\x6c\x3b\15\xa\x20\40\40\x20\x20\x20\40\40\x20\x20\x20\40\x7d\15\12\xd\xa\x20\40\x20\40\40\40\40\40\40\x20\x20\40\x66\165\156\143\x74\151\x6f\x6e\40\x67\145\164\123\x75\142\x73\151\x74\x65\x4e\x61\155\x65\127\x68\x65\x72\145\125\163\x65\x72\x44\157\145\163\116\157\x74\x45\x78\x69\x73\164\50\x65\x6c\145\x6d\145\x6e\x74\51\x7b\xd\xa\40\x20\x20\x20\40\40\x20\40\x20\40\x20\40\40\40\x20\x20\163\165\x62\x73\151\164\x65\x4e\141\x6d\x65\x20\x3d\40\145\x6c\145\x6d\145\x6e\164\56\160\141\x72\x65\156\x74\105\154\145\155\x65\x6e\164\x2e\160\141\162\145\156\164\105\154\x65\155\145\x6e\x74\56\x66\x69\x72\163\x74\x45\154\145\155\145\156\164\x43\150\151\x6c\x64\x2e\x66\x69\x72\163\164\x45\154\x65\x6d\145\x6e\x74\103\150\x69\154\144\x2e\151\156\x6e\x65\162\124\x65\170\x74\73\15\xa\40\x20\x20\40\x20\40\40\x20\40\x20\x20\x20\40\x20\40\x20\x72\145\164\165\x72\x6e\40\x73\165\x62\x73\x69\x74\145\x4e\141\155\145\73\xd\12\x20\x20\40\x20\x20\x20\x20\x20\40\40\40\x20\x7d\xd\xa\15\xa\40\40\x20\40\x20\x20\x20\40\40\x20\40\x20\x66\165\156\143\x74\151\157\x6e\40\141\144\x64\x55\162\154\124\157\x4c\151\163\164\x28\165\162\154\54\x20\156\x61\x6d\x65\x2c\x20\x75\163\145\x72\151\144\51\x7b\xd\xa\40\40\x20\40\x20\40\x20\40\40\x20\40\40\40\40\40\40\166\141\x72\40\157\x6c\105\154\145\155\40\x3d\x20\x64\x6f\143\165\x6d\145\156\164\x2e\147\x65\164\x45\154\145\x6d\x65\156\164\x42\171\111\x64\x28\x22\x6d\x6f\137\163\x75\142\163\x69\x74\145\137\154\x69\x73\x74\x22\40\53\40\165\x73\145\162\151\x64\51\73\15\12\40\40\x20\40\40\40\x20\40\40\40\x20\x20\x20\40\40\40\x76\141\x72\x20\154\151\x20\75\x20\x64\157\x63\x75\155\x65\156\164\56\143\162\145\x61\x74\x65\105\154\x65\155\x65\x6e\164\50\x22\x6c\151\x22\51\73\15\xa\x20\x20\40\40\x20\40\40\40\40\x20\40\x20\40\x20\x20\40\154\x69\56\141\x70\x70\145\x6e\144\103\x68\x69\154\x64\50\x64\157\143\165\x6d\145\x6e\x74\x2e\x63\x72\145\x61\164\x65\124\145\170\x74\116\x6f\144\145\x28\x75\162\154\x20\53\x20\x20\x22\x20\40\x20\x2d\40\x20\40\42\40\x2b\40\x6e\x61\x6d\145\x29\51\73\15\12\x20\40\40\x20\40\40\40\40\x20\40\x20\40\40\x20\40\x20\x6c\x69\56\x73\145\164\x41\x74\164\x72\151\x62\165\164\145\x28\42\x69\x64\x22\54\x20\x75\162\154\x29\x3b\15\12\x20\x20\40\40\x20\x20\40\40\x20\40\40\40\40\40\40\40\157\x6c\x45\154\145\x6d\56\x61\x70\x70\x65\156\144\103\150\x69\x6c\144\50\154\151\51\73\15\12\40\x20\x20\40\x20\x20\40\40\x20\40\x20\x20\x7d\xd\xa\15\xa\40\40\x20\x20\40\x20\x20\x20\x20\40\40\x20\x66\x75\x6e\x63\x74\x69\157\156\x20\x66\154\165\163\150\105\x78\x69\x73\164\x69\156\147\x53\165\x62\163\x69\164\x65\x4c\x69\163\164\x28\165\x73\145\x72\x69\144\51\173\15\12\40\x20\x20\x20\40\x20\40\x20\x20\x20\x20\40\40\x20\40\40\166\x61\162\x20\x6f\154\105\154\145\155\x20\75\40\x64\x6f\x63\165\x6d\145\x6e\164\56\147\x65\164\105\x6c\145\x6d\x65\156\x74\x42\x79\111\144\x28\x22\x6d\157\x5f\x73\x75\x62\163\x69\x74\x65\x5f\x6c\x69\x73\164\x22\x20\53\40\165\163\x65\x72\x69\x64\x29\x3b\xd\12\x20\x20\x20\x20\40\40\40\40\40\x20\40\x20\x20\x20\x20\40\x6f\x6c\x45\154\x65\155\56\x69\x6e\156\145\162\x48\124\115\x4c\40\75\x20\x22\42\x3b\xd\xa\40\40\40\40\40\x20\x20\40\x20\40\x20\40\x7d\xd\12\xd\12\xd\xa\x20\x20\x20\x20\40\40\x20\x20\74\57\163\143\x72\x69\x70\x74\76\xd\xa\xd\xa\40\x20\x20\x20\x20\40\40\40";
    }
    function mo_saml_flush_cache()
    {
        if (!(mo_saml_is_customer_registered_saml() && get_site_option("\x73\x6d\154\137\154\x6b"))) {
            goto SL;
        }
        $ZX = new Customersaml();
        $ZX->mo_saml_update_status($this);
        SL:
    }
    function default_certificate()
    {
        $lK = file_get_contents(plugin_dir_path(__FILE__) . "\162\145\x73\157\165\162\x63\145\x73" . DIRECTORY_SEPARATOR . mo_options_enum_default_sp_certificate::SP_Public_Certificate);
        $E2 = file_get_contents(plugin_dir_path(__FILE__) . "\162\x65\163\157\165\x72\x63\x65\x73" . DIRECTORY_SEPARATOR . mo_options_enum_default_sp_certificate::SP_Private_Key);
        if (!(!get_site_option("\x6d\157\137\163\141\155\x6c\137\143\x75\x72\162\x65\x6e\x74\137\x63\x65\x72\164") && !get_site_option("\155\x6f\137\x73\x61\x6d\x6c\137\x63\x75\162\x72\x65\x6e\x74\137\143\145\162\x74\137\x70\162\151\166\x61\164\x65\x5f\153\x65\x79"))) {
            goto mh;
        }
        if (get_site_option("\155\x6f\137\163\x61\x6d\154\137\143\x65\162\164") && get_site_option("\x6d\157\137\163\x61\x6d\154\137\143\x65\x72\x74\137\x70\x72\151\166\x61\164\x65\137\x6b\145\171")) {
            goto Lr;
        }
        update_site_option("\155\x6f\x5f\x73\x61\155\x6c\137\x63\x75\x72\162\x65\156\164\x5f\143\x65\162\x74", $lK);
        update_site_option("\x6d\x6f\x5f\x73\x61\155\x6c\137\143\x75\162\x72\x65\x6e\164\137\143\x65\x72\x74\137\160\162\151\x76\141\164\x65\x5f\153\x65\171", $E2);
        goto ab;
        Lr:
        update_site_option("\x6d\x6f\x5f\x73\x61\155\154\x5f\x63\x75\x72\162\x65\x6e\x74\x5f\143\145\x72\x74", get_site_option("\155\157\137\x73\x61\155\x6c\137\143\x65\162\164"));
        update_site_option("\155\x6f\137\x73\x61\x6d\x6c\137\143\x75\162\162\145\156\164\x5f\x63\145\x72\x74\137\x70\x72\151\x76\141\164\x65\137\153\x65\x79", get_site_option("\x6d\x6f\x5f\163\x61\x6d\x6c\x5f\143\x65\x72\164\137\x70\x72\x69\x76\141\164\145\137\153\145\171"));
        ab:
        mh:
    }
    function myprefix_add_cron_schedule($WE)
    {
        $WE["\x77\145\145\153\x6c\x79"] = array("\x69\156\x74\145\x72\166\141\x6c" => 604800, "\x64\x69\163\160\154\x61\x79" => __("\x4f\156\x63\145\40\x57\145\x65\153\x6c\x79"));
        $WE["\x6d\157\x6e\164\150\x6c\x79"] = array("\151\x6e\164\145\162\x76\x61\x6c" => 2635200, "\x64\151\x73\160\154\x61\x79" => __("\x4f\156\143\145\x20\x4d\157\156\x74\x68\x6c\x79"));
        return $WE;
    }
    function metadata_sync_cron_action()
    {
        error_log("\155\151\156\151\157\162\x61\156\x67\145\x20\72\x20\x52\101\x4e\40\123\x59\x4e\103\40\x2d\x20" . time());
        $Og = get_site_option("\163\x61\155\x6c\x5f\151\x64\x65\156\164\x69\164\171\x5f\x6e\141\x6d\145");
        $this->upload_metadata(@file_get_contents(get_site_option("\x73\141\155\154\x5f\x6d\145\164\x61\x64\x61\x74\x61\137\165\162\x6c\x5f\x66\157\162\x5f\163\x79\156\143")));
        update_site_option("\163\x61\x6d\154\137\151\144\145\x6e\164\151\164\171\137\156\141\x6d\145", $Og);
    }
    function mo_login_widget_saml_options()
    {
        global $wpdb;
        update_site_option("\x6d\157\x5f\x73\x61\155\154\x5f\x68\x6f\x73\164\x5f\156\x61\x6d\x65", "\x68\164\x74\160\163\72\x2f\57\154\157\x67\x69\156\56\x78\145\143\165\x72\151\x66\x79\x2e\x63\157\155");
        mo_register_saml_sso();
    }
    function mo_saml_success_message()
    {
        $u4 = "\145\162\x72\x6f\x72";
        $Of = get_site_option("\x6d\x6f\137\163\x61\155\154\137\x6d\145\x73\163\141\147\145");
        echo "\x3c\144\x69\x76\x20\x63\154\x61\163\x73\75\x27" . $u4 . "\47\x3e\40\74\x70\x3e" . $Of . "\x3c\57\160\76\74\57\x64\x69\x76\x3e";
    }
    function mo_saml_error_message()
    {
        $u4 = "\x75\x70\144\x61\x74\145\x64";
        $Of = get_site_option("\155\157\137\163\141\x6d\x6c\137\155\145\163\163\x61\x67\x65");
        echo "\74\x64\x69\166\40\143\154\x61\163\163\x3d\x27" . $u4 . "\x27\76\x20\74\x70\x3e" . $Of . "\x3c\57\x70\x3e\x3c\57\x64\151\x76\x3e";
    }
    public function mo_sso_saml_deactivate()
    {
        do_action("\x6d\x6f\x5f\x73\141\155\154\x5f\x66\154\x75\163\x68\137\x63\141\143\150\145");
        delete_site_option("\155\x6f\137\163\141\155\x6c\137\x68\157\x73\164\137\x6e\141\155\x65");
        delete_site_option("\155\157\x5f\163\141\155\154\137\156\145\167\137\x72\145\x67\151\x73\164\162\x61\164\x69\x6f\156");
        delete_site_option("\x6d\157\x5f\x73\x61\155\154\x5f\141\144\x6d\151\x6e\137\x70\x68\x6f\156\145");
        delete_site_option("\x6d\x6f\x5f\163\141\155\x6c\x5f\141\x64\x6d\x69\156\x5f\160\x61\163\163\x77\157\x72\144");
        delete_site_option("\x6d\x6f\137\x73\141\155\x6c\137\166\x65\162\151\146\171\x5f\x63\165\x73\164\157\x6d\x65\x72");
        delete_site_option("\x6d\157\137\x73\x61\x6d\x6c\x5f\141\144\x6d\x69\156\x5f\x63\165\x73\x74\x6f\x6d\x65\162\137\x6b\x65\x79");
        delete_site_option("\155\x6f\137\163\141\x6d\x6c\137\141\144\x6d\151\x6e\x5f\141\160\x69\x5f\153\145\x79");
        delete_site_option("\155\x6f\137\x73\141\x6d\154\x5f\x63\165\163\x74\157\155\x65\x72\x5f\164\x6f\x6b\145\156");
        delete_site_option("\x6d\x6f\137\x73\141\155\154\x5f\155\145\x73\163\141\147\x65");
        delete_site_option("\155\157\137\163\141\155\x6c\x5f\162\x65\x67\151\163\x74\x72\141\x74\151\x6f\156\x5f\163\164\141\164\x75\163");
        delete_site_option("\x6d\x6f\x5f\163\141\x6d\154\137\x69\x64\160\x5f\143\157\x6e\x66\151\147\x5f\x63\157\155\160\x6c\145\x74\145");
        delete_site_option("\x6d\x6f\x5f\163\141\155\x6c\137\164\162\x61\x6e\163\141\x63\164\x69\157\x6e\x49\x64");
        delete_site_option("\155\x6f\137\163\x61\155\x6c\137\145\156\141\142\x6c\145\137\x63\154\157\165\x64\137\142\x72\x6f\x6b\x65\162");
    }
    public function mo_sso_saml_activate()
    {
        if (is_multisite()) {
            goto Xd;
        }
        echo "\125\156\x61\x62\x6c\x65\40\x74\x6f\x20\141\x63\x74\151\x76\x61\164\x65\x20\164\x68\x65\40\x70\154\165\x67\151\x6e\x2e\40\111\x74\40\163\145\x65\155\163\x20\154\x69\x6b\145\40\171\157\x75\40\141\x72\145\x20\x74\x72\x79\151\x6e\x67\x20\x74\x6f\40\151\156\163\x74\141\154\154\40\x74\150\x65\40\74\x62\x3e\x6d\165\x6c\x74\x69\163\x69\x74\x65\x20\160\x6c\x75\x67\151\x6e\74\x2f\142\76\x20\x69\156\x20\164\150\145\40\x73\151\x6e\147\154\145\x2d\x73\151\164\x65\40\145\156\x76\151\162\x6f\x6e\x6d\x65\x6e\164\x2e\x20\120\154\x65\x61\x73\145\40\x63\x6f\x6e\x74\x61\x63\164\40\74\x62\x3e\151\156\x66\157\100\155\151\x6e\x69\157\x72\x61\156\x67\145\56\143\x6f\x6d\x3c\x2f\142\76\x20\146\x6f\x72\40\155\x6f\x72\x65\40\x64\145\x74\x61\x69\x6c\x73";
        exit;
        Xd:
        if (mo_saml_is_extension_installed("\157\160\x65\x6e\163\163\x6c")) {
            goto LG;
        }
        wp_die("\120\x48\x50\40\x6f\160\145\156\x73\x73\x6c\40\145\170\164\x65\156\163\x69\157\x6e\x20\x69\x73\40\x6e\157\164\x20\x69\156\163\x74\x61\154\x6c\x65\x64\40\157\x72\40\144\x69\163\141\142\x6c\145\144\x2c\160\x6c\x65\x61\x73\145\x20\x65\156\x61\142\154\x65\x20\x69\x74\x20\x74\x6f\x20\141\143\x74\x69\166\141\164\145\x20\164\150\145\x20\160\x6c\165\147\x69\x6e\x2e");
        LG:
        add_option("\x41\143\164\x69\166\x61\164\x65\x64\x5f\120\x6c\165\x67\x69\x6e", "\x50\x6c\165\x67\151\156\x2d\123\x6c\x75\147");
        $this->mo_saml_migrate_configuration();
    }
    function mo_saml_migrate_configuration()
    {
        $sT = maybe_unserialize(get_site_option("\x73\141\x6d\154\137\x73\163\157\137\163\x65\164\164\151\x6e\x67\163"));
        if (empty($sT)) {
            goto lV;
        }
        return;
        lV:
        $sT["\104\x45\106\x41\125\114\x54"] = array();
        $sT["\x44\105\x46\x41\x55\114\124"]["\x6d\x6f\x5f\x73\141\x6d\x6c\x5f\162\145\x6c\141\171\137\163\164\x61\x74\145"] = !empty(get_site_option("\155\x6f\x5f\x73\141\x6d\x6c\137\x72\x65\x6c\141\x79\x5f\x73\164\141\164\x65")) ? get_site_option("\x6d\x6f\x5f\163\141\155\x6c\137\x72\x65\x6c\141\171\137\x73\x74\141\x74\145") : '';
        $sT["\104\105\106\101\125\114\124"]["\155\x6f\137\x73\141\155\x6c\x5f\162\x65\x67\151\163\164\145\x72\145\x64\137\x6f\x6e\154\x79\137\141\143\143\x65\163\163"] = !empty(get_site_option("\155\x6f\x5f\x73\141\155\x6c\x5f\x72\145\x67\151\x73\164\145\162\145\144\137\x6f\156\x6c\171\137\141\143\143\x65\x73\x73")) ? get_site_option("\155\157\137\x73\x61\155\154\x5f\162\x65\x67\151\163\x74\145\162\x65\144\137\157\x6e\154\171\137\x61\143\x63\x65\163\163") : '';
        $sT["\104\105\x46\101\x55\x4c\x54"]["\x6d\157\137\x73\141\155\x6c\137\146\157\x72\x63\145\x5f\141\x75\164\150\x65\x6e\x74\151\x63\141\164\x69\157\156"] = !empty(get_site_option("\155\x6f\x5f\163\141\x6d\x6c\137\146\x6f\x72\143\145\x5f\141\165\164\150\x65\x6e\164\x69\143\x61\x74\151\x6f\x6e")) ? get_site_option("\x6d\157\137\x73\x61\155\154\x5f\x66\x6f\162\x63\145\137\141\x75\x74\x68\145\x6e\x74\x69\x63\x61\x74\x69\x6f\156") : '';
        $sT["\104\105\x46\101\x55\x4c\124"]["\155\157\x5f\163\x61\x6d\x6c\x5f\x65\156\141\x62\154\145\137\x6c\157\x67\151\x6e\x5f\x72\x65\x64\151\x72\145\143\164"] = !empty(get_site_option("\155\x6f\x5f\163\141\x6d\154\137\x65\156\141\142\x6c\x65\x5f\154\x6f\147\151\x6e\x5f\162\x65\x64\151\x72\145\143\x74")) ? get_site_option("\x6d\157\137\163\141\155\154\137\x65\x6e\141\142\x6c\x65\x5f\x6c\157\x67\151\x6e\x5f\162\x65\x64\x69\x72\x65\143\164") : '';
        $sT["\104\105\106\101\125\x4c\x54"]["\155\x6f\x5f\x73\x61\155\154\137\x61\154\154\157\167\x5f\x77\x70\x5f\163\x69\147\x6e\151\156"] = !empty(get_site_option("\155\157\137\x73\x61\x6d\154\x5f\141\x6c\154\157\x77\137\x77\160\x5f\163\x69\x67\x6e\151\x6e")) ? get_site_option("\x6d\157\137\163\141\155\154\x5f\141\x6c\x6c\157\x77\137\x77\x70\x5f\163\x69\x67\156\x69\x6e") : '';
        delete_site_option("\x73\141\x6d\154\137\x72\x65\161\x75\x65\x73\x74\137\163\151\x67\x6e\145\x64");
        update_site_option("\163\x61\155\x6c\x5f\163\163\x6f\137\163\145\x74\x74\x69\156\147\x73", $sT);
    }
    function mo_saml_show_success_message()
    {
        remove_action("\x6e\145\x74\x77\x6f\x72\153\x5f\x61\x64\x6d\x69\x6e\x5f\x6e\x6f\x74\151\x63\x65\163", array($this, "\155\157\137\163\141\x6d\x6c\137\163\x75\x63\143\x65\x73\163\137\155\145\163\163\x61\x67\x65"));
        add_action("\156\x65\164\167\x6f\162\153\137\x61\144\155\151\x6e\137\x6e\157\164\x69\x63\x65\x73", array($this, "\155\x6f\137\163\x61\x6d\x6c\x5f\145\x72\x72\157\162\x5f\x6d\145\163\x73\x61\147\145"));
    }
    function mo_saml_show_error_message()
    {
        remove_action("\156\145\x74\x77\x6f\162\x6b\x5f\x61\x64\x6d\x69\156\x5f\x6e\x6f\164\151\x63\x65\x73", array($this, "\x6d\157\137\x73\141\155\x6c\x5f\x65\x72\x72\x6f\x72\137\155\x65\163\x73\x61\147\x65"));
        add_action("\x6e\145\164\167\157\162\x6b\x5f\x61\x64\x6d\151\x6e\137\156\x6f\164\x69\143\145\x73", array($this, "\155\157\x5f\x73\x61\155\x6c\137\x73\x75\143\x63\145\x73\163\x5f\x6d\x65\163\163\x61\147\x65"));
    }
    function plugin_settings_style($Ld)
    {
        if (!("\x74\157\x70\x6c\145\166\145\x6c\x5f\160\x61\147\x65\137\155\x6f\x5f\163\x61\155\x6c\137\163\145\164\164\x69\x6e\147\163" != $Ld)) {
            goto F8;
        }
        return;
        F8:
        if (isset($_REQUEST["\x74\x61\142"]) && $_REQUEST["\x74\141\x62"] == "\154\x69\x63\145\x6e\163\x69\x6e\147") {
            goto uD;
        }
        wp_enqueue_style("\155\x6f\x5f\163\141\x6d\154\137\141\x64\155\151\x6e\x5f\163\145\x74\x74\151\x6e\147\163\x5f\x73\x74\x79\x6c\x65", plugins_url("\x69\156\x63\154\165\144\145\x73\x2f\x63\163\163\57\x73\x74\171\154\145\137\163\145\164\164\151\156\x67\163\56\x6d\151\156\56\143\163\x73", __FILE__), array(), mo_options_plugin_constants::Version, "\141\154\154");
        wp_enqueue_style("\155\157\137\163\x61\155\154\137\x61\144\155\x69\x6e\x5f\163\x65\x74\x74\x69\x6e\x67\x73\x5f\163\x74\171\x6c\x65\x5f\x74\162\x61\143\153\145\162", plugins_url("\x69\x6e\x63\x6c\165\x64\145\163\x2f\143\x73\x73\57\x70\162\157\147\x72\145\163\x73\x2d\164\x72\141\x63\x6b\x65\x72\56\x63\x73\163", __FILE__), array(), mo_options_plugin_constants::Version, "\x61\x6c\154");
        wp_enqueue_style("\155\x6f\137\163\141\x6d\x6c\137\141\144\x6d\x69\156\x5f\x73\x65\164\x74\151\x6e\x67\x73\137\x70\x68\157\x6e\145\137\163\x74\x79\154\x65", plugins_url("\151\x6e\x63\x6c\x75\x64\145\x73\57\143\x73\x73\x2f\160\x68\x6f\156\145\56\x63\163\163", __FILE__), array(), mo_options_plugin_constants::Version, "\141\x6c\x6c");
        wp_enqueue_style("\x6d\x6f\137\x73\x61\x6d\154\x5f\167\160\142\55\x66\x61", plugins_url("\151\x6e\143\154\165\144\145\x73\57\143\x73\x73\x2f\146\x6f\156\x74\55\141\x77\x65\163\157\x6d\145\x2e\x6d\151\x6e\56\143\163\163", __FILE__), array(), mo_options_plugin_constants::Version, "\141\x6c\x6c");
        wp_enqueue_style("\155\157\137\163\141\x6d\154\x5f\x61\144\155\151\156\x5f\x73\x65\x74\x74\x69\156\147\163\x5f\x73\164\x79\154\x65", plugins_url("\x69\156\x63\x6c\165\x64\145\163\57\x63\163\x73\57\x6a\161\165\x65\162\x79\56\x75\151\x2e\x63\163\163", __FILE__), array(), mo_options_plugin_constants::Version, "\x61\154\154");
        goto mn;
        uD:
        wp_enqueue_style("\155\157\137\163\141\x6d\x6c\137\x62\157\x6f\164\x73\x74\162\x61\x70\137\x63\163\x73", plugins_url("\151\156\x63\154\165\x64\145\163\57\x63\163\163\57\x62\x6f\157\x74\163\164\x72\x61\x70\x2f\x62\157\x6f\164\x73\164\x72\x61\x70\56\x6d\151\156\56\x63\163\x73", __FILE__), array(), mo_options_plugin_constants::Version, "\x61\154\154");
        wp_enqueue_style("\x6d\157\137\x73\x61\x6d\x6c\x5f\141\x64\155\151\156\137\163\x65\x74\x74\x69\x6e\147\x73\137\x73\x74\171\x6c\x65", plugins_url("\x69\x6e\143\x6c\165\144\x65\x73\x2f\143\x73\x73\x2f\x73\x74\171\154\145\137\163\x65\164\164\x69\x6e\147\163\x2e\155\151\156\x2e\x63\163\163", __FILE__), array(), mo_options_plugin_constants::Version, "\x61\x6c\x6c");
        mn:
    }
    function plugin_settings_script($Ld)
    {
        if (!("\x74\x6f\x70\154\x65\x76\x65\154\x5f\160\x61\x67\145\137\x6d\157\137\x73\x61\155\154\x5f\163\145\x74\x74\x69\156\x67\x73" != $Ld)) {
            goto we;
        }
        return;
        we:
        if (isset($_REQUEST["\x74\141\x62"]) && $_REQUEST["\x74\x61\x62"] == "\154\x69\143\x65\156\163\151\x6e\x67") {
            goto Ti;
        }
        wp_enqueue_script("\x6a\x71\165\145\x72\x79");
        wp_enqueue_script("\x6d\157\x5f\163\x61\x6d\154\137\x61\x64\155\x69\156\137\163\x65\164\164\151\156\147\163\137\143\157\x6c\x6f\x72\x5f\163\143\162\151\160\x74", plugins_url("\151\x6e\143\x6c\165\x64\145\163\57\x6a\163\x2f\x6a\163\x63\x6f\x6c\157\162\57\152\163\143\x6f\154\x6f\x72\56\x6a\163", __FILE__), array(), mo_options_plugin_constants::Version, false);
        wp_enqueue_script("\x6d\157\137\163\141\x6d\154\x5f\141\144\155\151\x6e\137\163\x65\164\164\151\x6e\x67\x73\x5f\x70\x68\x6f\x6e\x65\137\x73\143\x72\151\160\164", plugins_url("\x69\x6e\x63\x6c\165\x64\145\163\57\x6a\163\x2f\160\x68\x6f\x6e\145\56\152\x73", __FILE__), array(), mo_options_plugin_constants::Version, false);
        goto Fj;
        Ti:
        wp_enqueue_script("\x6d\x6f\x5f\x73\141\155\x6c\137\x6d\x6f\x64\145\162\x6e\x69\172\x72\137\163\143\162\151\160\x74", plugins_url("\x69\x6e\x63\154\165\x64\145\163\x2f\x6a\x73\x2f\155\157\144\x65\162\156\x69\x7a\x72\x2e\x6a\x73", __FILE__), array(), mo_options_plugin_constants::Version, false);
        wp_enqueue_script("\x6d\x6f\x5f\163\x61\x6d\x6c\137\160\x6f\x70\x6f\x76\x65\162\137\163\143\162\x69\x70\x74", plugins_url("\x69\x6e\x63\x6c\165\x64\145\x73\57\x6a\x73\57\142\x6f\x6f\164\163\164\x72\x61\160\57\160\x6f\160\x70\145\162\x2e\x6d\151\x6e\56\152\x73", __FILE__), array(), mo_options_plugin_constants::Version, false);
        wp_enqueue_script("\x6d\157\x5f\163\141\155\154\137\142\x6f\157\x74\x73\x74\x72\x61\160\x5f\x73\143\x72\151\x70\x74", plugins_url("\x69\156\143\x6c\x75\x64\145\x73\x2f\152\x73\57\x62\x6f\x6f\x74\163\164\162\141\x70\57\x62\x6f\157\x74\x73\x74\162\x61\x70\56\x6d\x69\156\56\152\163", __FILE__), array(), mo_options_plugin_constants::Version, false);
        Fj:
        wp_enqueue_script("\155\157\137\163\x61\x6d\154\x5f\x61\144\155\151\x6e\x5f\163\x65\x74\x74\x69\x6e\147\163\137\163\143\162\x69\160\164", plugins_url("\151\156\143\x6c\x75\144\145\x73\57\x6a\x73\57\x73\145\x74\164\151\x6e\x67\163\x2e\155\151\156\56\152\163", __FILE__), array(), mo_options_plugin_constants::Version, false);
    }
    function mo_saml_login_enqueue_scripts()
    {
        wp_enqueue_script("\x6a\x71\165\x65\162\171");
    }
    function mo_saml_activation_message()
    {
        $u4 = "\165\160\x64\141\x74\145\x64";
        $Of = get_site_option("\x6d\157\137\x73\x61\x6d\x6c\x5f\155\x65\x73\163\x61\x67\x65");
        echo "\x3c\144\151\166\x20\143\154\141\163\x73\75\x27" . $u4 . "\x27\x3e\x20\x3c\160\x3e" . $Of . "\74\x2f\x70\x3e\74\57\x64\151\166\x3e";
    }
    function mo_saml_custom_attr_column($ba)
    {
        $Xn = maybe_unserialize(get_site_option("\155\x6f\x5f\x73\x61\x6d\x6c\137\x63\165\163\x74\x6f\155\137\141\164\164\x72\163\x5f\x6d\141\160\160\x69\x6e\x67"));
        $Eh = get_site_option("\163\x61\x6d\154\137\163\150\157\x77\x5f\x75\163\x65\162\x5f\x61\x74\x74\x72\151\x62\x75\164\x65");
        $vF = 0;
        if (!is_array($Xn)) {
            goto TN;
        }
        foreach ($Xn as $XC => $wE) {
            if (empty($XC)) {
                goto fe;
            }
            if (!in_array($vF, $Eh)) {
                goto I4;
            }
            $ba[$XC] = $XC;
            I4:
            fe:
            $vF++;
            Hr:
        }
        yA:
        TN:
        return $ba;
    }
    function mo_saml_attr_column_content($BK, $qe, $vE)
    {
        $Xn = maybe_unserialize(get_site_option("\155\157\x5f\x73\141\155\154\x5f\143\x75\x73\x74\x6f\x6d\137\141\x74\164\162\x73\137\x6d\141\160\160\x69\x6e\147"));
        if (!is_array($Xn)) {
            goto HD;
        }
        foreach ($Xn as $XC => $wE) {
            if (!($XC === $qe)) {
                goto Fx;
            }
            $Nd = get_user_meta($vE, $qe, false);
            if (empty($Nd)) {
                goto xa;
            }
            if (!is_array($Nd[0])) {
                goto dk;
            }
            $R_ = '';
            foreach ($Nd[0] as $eg) {
                $R_ = $R_ . $eg;
                if (!next($Nd[0])) {
                    goto B7;
                }
                $R_ = $R_ . "\40\x7c\x20";
                B7:
                D3:
            }
            GC:
            return $R_;
            goto ep;
            dk:
            return $Nd[0];
            ep:
            xa:
            Fx:
            an:
        }
        j2:
        HD:
        return $BK;
    }
    static function mo_check_option_admin_referer($ZC)
    {
        return isset($_POST["\x6f\160\x74\x69\x6f\156"]) and $_POST["\157\x70\164\151\157\156"] == $ZC and check_admin_referer($ZC);
    }
    function miniorange_login_widget_saml_save_settings()
    {
        if (!current_user_can("\x6d\141\x6e\x61\147\145\x5f\157\160\x74\151\157\x6e\163")) {
            goto hV;
        }
        if (!(is_admin() && get_option("\101\x63\164\x69\x76\x61\x74\x65\144\x5f\120\154\x75\x67\151\156") == "\x50\154\165\x67\x69\x6e\55\123\x6c\165\x67")) {
            goto xl;
        }
        delete_option("\101\143\164\x69\x76\141\x74\x65\144\137\x50\154\165\x67\151\x6e");
        update_site_option("\x6d\x6f\x5f\x73\141\x6d\x6c\137\155\145\163\163\141\x67\145", "\x47\157\x20\x74\x6f\x20\160\154\165\147\x69\156\x20\x3c\142\x3e\x3c\x61\40\150\162\x65\146\75\x22\141\144\x6d\x69\156\56\160\150\160\77\x70\141\x67\145\x3d\x6d\157\x5f\163\x61\x6d\x6c\137\x73\x65\164\x74\151\156\147\x73\x22\76\163\145\x74\164\x69\156\x67\163\x3c\x2f\141\76\x3c\x2f\x62\76\40\x74\x6f\x20\x63\x6f\x6e\x66\151\x67\x75\x72\x65\x20\123\x41\115\114\x20\123\x69\x6e\147\x6c\x65\x20\123\x69\147\x6e\40\x4f\156\40\142\171\40\155\151\156\x69\117\162\x61\156\x67\145\56");
        add_action("\x6e\x65\164\x77\x6f\162\153\137\x61\x64\x6d\x69\x6e\x5f\x6e\x6f\164\151\143\145\x73", array($this, "\x6d\157\137\163\141\x6d\154\x5f\x61\143\x74\x69\166\141\164\x69\157\156\x5f\155\x65\163\163\x61\x67\x65"));
        xl:
        if (!self::mo_check_option_admin_referer("\x6c\157\x67\151\x6e\137\x77\x69\144\x67\x65\164\137\163\x61\155\x6c\x5f\x73\x61\x76\145\137\x73\145\164\x74\151\x6e\147\163")) {
            goto Hq;
        }
        if (mo_saml_is_extension_installed("\x63\x75\162\154")) {
            goto Rz;
        }
        update_site_option("\x6d\x6f\x5f\x73\141\155\x6c\x5f\155\145\x73\x73\x61\147\x65", "\105\122\122\x4f\122\72\40\74\x61\x20\x68\162\145\146\75\x22\x68\x74\x74\x70\72\57\57\160\150\160\56\156\x65\164\x2f\x6d\141\x6e\165\141\x6c\x2f\x65\x6e\x2f\143\x75\x72\x6c\56\151\156\163\x74\141\154\154\x61\x74\151\x6f\x6e\56\x70\x68\x70\42\x20\164\141\x72\147\x65\x74\75\x22\137\142\x6c\x61\156\x6b\42\76\120\x48\120\x20\x63\x55\x52\114\40\145\170\164\x65\156\x73\151\x6f\156\74\x2f\141\x3e\x20\151\163\40\x6e\x6f\x74\40\151\156\x73\164\141\154\x6c\x65\144\40\157\162\x20\144\x69\163\141\142\x6c\x65\x64\x2e\x20\123\x61\166\x65\x20\111\144\x65\156\164\151\164\171\40\x50\162\x6f\x76\151\x64\145\162\x20\x43\x6f\156\x66\x69\147\165\x72\x61\164\151\x6f\x6e\40\146\x61\x69\x6c\x65\x64\x2e");
        $this->mo_saml_show_error_message();
        return;
        Rz:
        $Og = '';
        $d1 = '';
        $XR = '';
        $hj = '';
        $l3 = '';
        $ne = '';
        $D8 = '';
        $Wi = '';
        $L3 = '';
        if ($this->mo_saml_check_empty_or_null($_POST["\x73\x61\155\154\x5f\x69\x64\x65\x6e\164\x69\x74\171\137\x6e\141\155\x65"]) || $this->mo_saml_check_empty_or_null($_POST["\x73\141\x6d\154\x5f\x6c\157\x67\151\156\x5f\165\162\x6c"]) || $this->mo_saml_check_empty_or_null($_POST["\163\x61\x6d\x6c\137\x69\163\163\165\x65\x72"])) {
            goto Zu;
        }
        if (!preg_match("\x2f\x5e\134\x77\52\x24\57", $_POST["\x73\141\x6d\154\137\x69\144\x65\156\x74\x69\x74\171\137\x6e\x61\155\145"])) {
            goto x6;
        }
        $Og = htmlspecialchars(trim($_POST["\x73\x61\155\154\137\151\144\145\156\x74\x69\164\x79\137\156\141\x6d\x65"]));
        $XR = htmlspecialchars(trim($_POST["\163\x61\x6d\154\137\x6c\157\147\151\156\137\165\162\154"]));
        if (!array_key_exists("\163\141\155\154\137\x6c\x6f\x67\151\x6e\137\x62\151\x6e\144\151\156\147\137\x74\171\160\145", $_POST)) {
            goto n2;
        }
        $d1 = htmlspecialchars($_POST["\163\141\x6d\154\x5f\154\x6f\147\151\156\137\x62\151\156\x64\x69\x6e\x67\x5f\164\x79\160\145"]);
        n2:
        if (!array_key_exists("\163\141\x6d\x6c\137\x6c\x6f\x67\157\x75\x74\x5f\x62\x69\x6e\x64\151\x6e\x67\x5f\164\x79\160\145", $_POST)) {
            goto My;
        }
        $hj = htmlspecialchars($_POST["\163\x61\155\154\x5f\x6c\x6f\147\157\165\164\x5f\x62\x69\x6e\144\x69\156\x67\137\164\x79\160\x65"]);
        My:
        if (!array_key_exists("\x73\x61\x6d\x6c\x5f\154\x6f\x67\x6f\x75\x74\x5f\165\162\154", $_POST)) {
            goto B9;
        }
        $l3 = htmlspecialchars(trim($_POST["\x73\x61\x6d\154\137\154\157\x67\157\165\164\x5f\x75\162\x6c"]));
        B9:
        $ne = htmlspecialchars(trim($_POST["\x73\141\x6d\154\x5f\151\163\x73\165\145\x72"]));
        $ja = htmlspecialchars(trim($_POST["\155\157\x5f\x73\x61\155\x6c\x5f\x69\x64\x65\x6e\164\x69\x74\x79\137\160\162\x6f\x76\x69\144\145\162\137\x69\144\x65\156\x74\x69\x66\x69\145\162\x5f\156\x61\x6d\x65"]));
        $D8 = maybe_unserialize($_POST["\x73\x61\155\154\x5f\170\65\x30\x39\137\143\x65\162\x74\x69\146\151\x63\x61\x74\145"]);
        $L3 = htmlspecialchars($_POST["\163\x61\155\x6c\x5f\x6e\x61\x6d\x65\x69\x64\137\x66\157\x72\155\141\x74"]);
        goto C_;
        x6:
        update_site_option("\155\157\137\163\141\155\154\137\x6d\145\x73\x73\x61\x67\145", "\x50\154\x65\141\x73\x65\x20\155\141\164\143\150\x20\164\150\x65\x20\x72\145\161\x75\x65\x73\x74\x65\144\40\146\157\162\155\x61\164\x20\146\157\162\x20\111\144\x65\x6e\x74\151\x74\x79\40\x50\162\x6f\166\x69\x64\145\x72\40\116\141\x6d\145\x2e\x20\117\156\154\x79\40\141\x6c\x70\150\x61\142\x65\x74\163\54\40\x6e\165\x6d\142\x65\x72\x73\x20\141\156\144\x20\165\156\144\x65\162\x73\x63\157\x72\145\x20\151\163\40\x61\x6c\x6c\x6f\x77\145\x64\x2e");
        $this->mo_saml_show_error_message();
        return;
        C_:
        goto Cq;
        Zu:
        update_site_option("\x6d\157\137\x73\141\155\x6c\137\155\x65\x73\x73\141\147\x65", "\x41\x6c\154\40\x74\x68\x65\x20\x66\x69\x65\154\144\x73\40\x61\162\145\40\x72\x65\161\x75\x69\162\x65\144\56\x20\x50\x6c\x65\x61\x73\x65\40\145\x6e\x74\x65\x72\x20\166\x61\x6c\x69\144\40\145\156\164\162\151\x65\163\56");
        $this->mo_saml_show_error_message();
        return;
        Cq:
        update_site_option("\163\x61\155\x6c\137\151\x64\x65\156\164\151\164\171\x5f\x6e\141\155\145", $Og);
        update_site_option("\x73\x61\x6d\x6c\137\154\157\147\x69\x6e\137\142\151\156\x64\x69\x6e\147\137\x74\171\160\145", $d1);
        update_site_option("\x73\141\x6d\x6c\x5f\x6c\x6f\x67\x69\156\x5f\165\x72\154", $XR);
        update_site_option("\163\141\155\x6c\x5f\154\157\147\x6f\165\x74\137\142\151\156\x64\151\x6e\147\x5f\164\x79\x70\145", $hj);
        update_site_option("\163\141\x6d\154\x5f\154\x6f\x67\157\165\x74\x5f\x75\162\154", $l3);
        update_site_option("\163\141\155\x6c\137\x69\163\x73\165\145\162", $ne);
        update_site_option("\163\x61\155\154\137\156\x61\155\145\151\x64\137\x66\157\162\155\141\164", $L3);
        update_site_option("\155\x6f\137\163\141\155\x6c\x5f\x69\144\x65\156\x74\x69\x74\171\137\x70\162\x6f\x76\x69\144\145\162\137\151\x64\145\156\164\151\x66\151\x65\x72\137\156\x61\155\x65", $ja);
        if (isset($_POST["\163\141\x6d\154\137\162\145\161\165\x65\163\x74\137\163\151\x67\x6e\145\144"])) {
            goto Oj;
        }
        update_site_option("\163\x61\x6d\154\137\162\145\161\x75\x65\163\164\137\163\x69\x67\x6e\x65\x64", "\x75\156\x63\x68\145\x63\x6b\x65\144");
        goto jy;
        Oj:
        update_site_option("\163\141\155\x6c\x5f\x72\145\161\165\145\x73\x74\137\163\x69\147\x6e\x65\x64", "\x63\150\145\143\x6b\x65\144");
        jy:
        foreach ($D8 as $XC => $wE) {
            if (empty($wE)) {
                goto MC;
            }
            $D8[$XC] = Utilities::sanitize_certificate($wE);
            if (@openssl_x509_read($D8[$XC])) {
                goto fa;
            }
            update_site_option("\x6d\x6f\137\163\141\x6d\x6c\137\155\x65\x73\x73\141\x67\145", "\x49\156\x76\x61\x6c\x69\144\x20\x63\145\x72\164\x69\146\x69\143\x61\x74\145\40\146\157\x72\155\x61\x74\72\x50\154\x65\141\x73\x65\x20\160\162\157\166\x69\x64\x65\40\x61\x20\x76\x61\154\x69\144\40\143\145\162\x74\x69\x66\x69\x63\141\164\145");
            $this->mo_saml_show_error_message();
            delete_site_option("\163\x61\155\x6c\x5f\170\x35\60\x39\x5f\143\145\162\164\151\146\x69\x63\141\x74\145");
            return;
            fa:
            goto tO;
            MC:
            unset($D8[$XC]);
            tO:
            A6:
        }
        Kj:
        if (!empty($D8)) {
            goto WU;
        }
        update_site_option("\x6d\x6f\137\163\x61\x6d\x6c\137\x6d\145\163\163\141\x67\145", "\111\156\166\x61\154\151\x64\x20\143\145\162\164\151\x66\151\143\x61\164\145\x20\x66\157\162\x6d\x61\x74\x20\72\40\x50\x6c\145\x61\x73\145\x20\x70\162\x6f\166\151\x64\145\40\x61\40\x63\145\162\x74\151\x66\151\x63\x61\164\x65");
        $this->mo_saml_show_error_message();
        return;
        WU:
        if (isset($_POST["\163\141\155\154\137\x72\x65\163\160\x6f\x6e\163\145\137\163\x69\x67\156\x65\144"])) {
            goto Fq;
        }
        update_site_option("\163\141\155\x6c\x5f\162\x65\163\x70\157\x6e\163\145\137\x73\151\x67\x6e\145\144", "\131\x65\x73");
        goto bt;
        Fq:
        update_site_option("\163\x61\x6d\x6c\x5f\162\145\x73\x70\x6f\x6e\163\145\x5f\x73\x69\x67\156\x65\144", "\x63\x68\x65\143\x6b\145\144");
        bt:
        if (isset($_POST["\163\x61\x6d\x6c\137\141\x73\x73\x65\x72\164\x69\x6f\156\x5f\x73\x69\x67\156\x65\144"])) {
            goto PF;
        }
        update_site_option("\163\x61\155\x6c\x5f\x61\x73\163\145\162\164\x69\157\156\x5f\x73\x69\147\156\145\x64", "\x59\x65\163");
        goto Li;
        PF:
        update_site_option("\x73\x61\x6d\154\x5f\x61\163\163\145\162\x74\151\157\156\x5f\x73\x69\147\x6e\x65\144", "\x63\150\145\143\153\x65\144");
        Li:
        update_site_option("\x73\x61\155\154\x5f\x78\65\x30\x39\x5f\x63\145\x72\x74\x69\146\151\x63\141\x74\145", $D8);
        if (array_key_exists("\145\x6e\141\x62\x6c\145\x5f\151\143\157\x6e\x76", $_POST)) {
            goto u1;
        }
        update_site_option("\155\x6f\137\163\141\155\154\137\x65\156\143\x6f\144\151\x6e\x67\x5f\x65\156\x61\142\154\x65\144", '');
        goto Ae;
        u1:
        update_site_option("\155\x6f\x5f\x73\x61\155\x6c\137\145\x6e\143\x6f\x64\151\156\147\x5f\x65\156\x61\x62\154\x65\144", "\x63\x68\x65\143\x6b\145\144");
        Ae:
        update_site_option("\155\x6f\137\163\141\x6d\x6c\x5f\155\145\163\163\141\x67\x65", "\111\144\145\156\x74\151\164\x79\x20\x50\162\157\x76\151\x64\145\x72\x20\144\145\164\x61\x69\154\x73\x20\x73\141\166\145\144\x20\x73\x75\x63\143\145\163\x73\146\165\154\154\x79\56");
        $this->mo_saml_show_success_message();
        Hq:
        if (!self::mo_check_option_admin_referer("\x6c\157\x67\151\x6e\x5f\x77\151\144\147\145\x74\x5f\x73\x61\155\x6c\137\141\164\x74\162\151\x62\x75\x74\x65\x5f\155\141\160\160\151\x6e\x67")) {
            goto Dq;
        }
        if (mo_saml_is_extension_installed("\x63\x75\x72\154")) {
            goto b3;
        }
        update_site_option("\155\x6f\137\x73\x61\155\154\137\155\x65\163\163\x61\147\145", "\105\122\122\x4f\x52\72\x20\x3c\141\x20\150\162\145\146\75\42\x68\x74\x74\x70\72\x2f\x2f\x70\x68\x70\x2e\x6e\145\164\57\155\141\x6e\165\141\154\57\x65\x6e\x2f\143\165\x72\154\x2e\x69\156\163\164\x61\x6c\154\141\164\x69\157\156\56\x70\x68\160\42\x20\x74\141\162\147\145\164\x3d\x22\x5f\x62\154\x61\156\153\42\x3e\x50\x48\120\x20\x63\x55\122\114\40\x65\x78\x74\145\x6e\163\151\157\156\x3c\57\141\x3e\40\x69\x73\x20\x6e\x6f\164\x20\x69\x6e\163\x74\141\154\x6c\x65\144\40\x6f\162\x20\x64\x69\163\x61\142\x6c\x65\x64\x2e\40\123\141\166\145\40\101\x74\x74\x72\x69\142\x75\164\145\x20\115\141\160\x70\x69\x6e\147\x20\x66\x61\151\x6c\145\x64\56");
        $this->mo_saml_show_error_message();
        return;
        b3:
        update_site_option("\163\x61\155\x6c\137\141\155\x5f\x75\x73\x65\162\x6e\x61\155\145", htmlspecialchars(stripslashes($_POST["\163\141\155\154\137\x61\155\x5f\165\163\x65\162\x6e\141\x6d\145"])));
        update_site_option("\163\141\x6d\x6c\137\x61\155\137\145\155\141\151\x6c", htmlspecialchars(stripslashes($_POST["\163\x61\x6d\154\x5f\141\x6d\x5f\145\155\x61\151\154"])));
        update_site_option("\x73\x61\155\x6c\137\141\x6d\x5f\146\151\162\163\164\137\x6e\x61\x6d\x65", htmlspecialchars(stripslashes($_POST["\x73\x61\155\x6c\137\x61\155\137\x66\151\162\163\x74\x5f\156\x61\155\145"])));
        update_site_option("\x73\x61\x6d\154\x5f\x61\155\x5f\154\141\163\164\137\156\x61\155\145", htmlspecialchars(stripslashes($_POST["\x73\x61\x6d\x6c\137\x61\155\137\x6c\x61\163\x74\137\x6e\x61\x6d\145"])));
        update_site_option("\163\141\155\x6c\x5f\x61\155\x5f\147\x72\x6f\x75\x70\137\x6e\x61\x6d\x65", htmlspecialchars(stripslashes($_POST["\x73\x61\155\154\137\x61\x6d\137\x67\162\x6f\165\x70\x5f\156\x61\155\145"])));
        update_site_option("\x73\x61\x6d\154\137\141\155\x5f\144\151\163\160\154\x61\171\137\x6e\141\x6d\x65", htmlspecialchars(stripslashes($_POST["\x73\141\x6d\x6c\x5f\x61\x6d\x5f\144\x69\x73\x70\x6c\141\x79\137\x6e\141\x6d\x65"])));
        $Xn = array();
        $yp = array();
        $jQ = array();
        $wL = array();
        if (!(isset($_POST["\x6d\157\137\163\141\x6d\154\x5f\143\x75\163\164\157\x6d\137\x61\x74\164\162\x69\142\x75\x74\145\x5f\x6b\145\171\x73"]) && !empty($_POST["\x6d\x6f\x5f\x73\x61\x6d\x6c\137\x63\165\163\x74\157\155\x5f\x61\164\164\162\151\x62\x75\x74\x65\x5f\153\145\171\163"]))) {
            goto G0;
        }
        $yp = $_POST["\x6d\157\x5f\163\141\x6d\x6c\x5f\x63\x75\163\164\x6f\x6d\137\141\x74\x74\162\151\142\165\x74\145\137\x6b\145\171\163"];
        G0:
        if (!(isset($_POST["\155\157\x5f\x73\x61\x6d\x6c\137\x63\165\163\x74\x6f\x6d\137\x61\x74\164\x72\151\x62\x75\164\x65\137\x76\141\x6c\x75\145\x73"]) && !empty($_POST["\x6d\x6f\137\x73\141\155\154\x5f\143\x75\163\164\157\155\x5f\x61\x74\164\162\151\142\x75\x74\145\137\x76\x61\154\x75\145\x73"]))) {
            goto nn;
        }
        $jQ = $_POST["\x6d\157\x5f\x73\x61\x6d\x6c\x5f\143\x75\163\x74\x6f\x6d\x5f\141\164\164\x72\x69\x62\x75\164\x65\x5f\x76\141\x6c\x75\145\x73"];
        nn:
        $IH = count($yp);
        if (!($IH > 0)) {
            goto QI;
        }
        $yp = array_map("\150\164\x6d\x6c\x73\x70\145\143\151\x61\x6c\x63\150\x61\162\x73", $yp);
        $jQ = array_map("\150\164\x6d\154\x73\160\145\143\x69\x61\154\x63\x68\141\x72\x73", $jQ);
        $SX = 0;
        l1:
        if (!($SX < $IH)) {
            goto Td;
        }
        if (!(isset($_POST["\x6d\157\137\x73\141\x6d\154\137\144\x69\163\160\154\x61\x79\x5f\x61\x74\164\x72\x69\x62\x75\x74\145\137" . $SX]) && !empty($_POST["\x6d\157\137\163\141\155\154\x5f\144\x69\163\160\154\x61\171\137\x61\x74\x74\x72\151\x62\165\x74\145\137" . $SX]))) {
            goto sD;
        }
        array_push($wL, $SX);
        sD:
        $SX++;
        goto l1;
        Td:
        QI:
        update_site_option("\x73\x61\155\x6c\137\x73\x68\157\167\137\165\x73\x65\162\x5f\141\x74\x74\x72\151\x62\165\164\x65", $wL);
        $Xn = array_combine($yp, $jQ);
        $Xn = array_filter($Xn);
        if (!empty($Xn)) {
            goto j8;
        }
        $Xn = get_site_option("\x6d\157\x5f\x73\141\155\154\x5f\143\165\163\164\x6f\x6d\x5f\x61\164\164\162\163\x5f\x6d\x61\160\160\151\x6e\x67");
        if (empty($Xn)) {
            goto ew;
        }
        delete_site_option("\x6d\x6f\137\163\141\x6d\x6c\x5f\143\x75\x73\x74\157\155\x5f\141\x74\x74\x72\163\137\x6d\141\160\x70\x69\x6e\x67");
        ew:
        goto ze;
        j8:
        update_site_option("\x6d\157\137\163\141\155\154\x5f\143\x75\163\164\x6f\155\x5f\141\164\x74\x72\163\x5f\155\141\x70\160\151\156\x67", $Xn);
        ze:
        update_site_option("\155\157\x5f\163\x61\x6d\154\x5f\x6d\x65\163\163\x61\x67\145", "\x41\x74\164\x72\x69\142\x75\164\145\40\115\141\160\x70\151\x6e\147\x20\x64\x65\x74\141\151\154\x73\x20\x73\141\x76\145\x64\40\x73\x75\143\x63\145\163\x73\x66\165\x6c\154\171");
        $this->mo_saml_show_success_message();
        Dq:
        if (!self::mo_check_option_admin_referer("\143\x6c\x65\141\x72\137\141\164\x74\162\163\x5f\154\x69\x73\x74")) {
            goto RI;
        }
        delete_site_option("\x6d\x6f\x5f\x73\x61\x6d\x6c\x5f\164\145\x73\164\137\x63\157\156\x66\x69\147\x5f\141\164\164\x72\x73");
        update_site_option("\155\157\137\x73\x61\155\x6c\x5f\155\x65\163\163\x61\x67\145", "\x41\164\x74\162\151\x62\165\x74\x65\x73\x20\154\x69\x73\164\40\x72\x65\155\157\166\x65\x64\40\163\165\143\x63\145\x73\x73\x66\x75\154\x6c\x79");
        $this->mo_saml_show_success_message();
        RI:
        if (!self::mo_check_option_admin_referer("\155\157\137\x73\141\155\154\x5f\x61\x64\144\157\156\163\137\155\x65\x73\x73\x61\147\145")) {
            goto Tx;
        }
        update_option("\155\157\137\x73\141\x6d\x6c\x5f\163\x68\157\x77\x5f\141\x64\144\157\156\x73\137\156\x6f\x74\x69\143\x65", 1);
        Tx:
        if (!self::mo_check_option_admin_referer("\x73\x61\155\x6c\137\x66\157\162\155\137\144\x6f\155\x61\151\x6e\x5f\162\145\163\164\x72\151\143\164\151\x6f\156\x5f\x6f\x70\x74\x69\x6f\156")) {
            goto iJ;
        }
        $iD = isset($_POST["\155\x6f\137\x73\x61\x6d\154\137\145\x6e\141\142\154\145\137\144\x6f\x6d\141\x69\x6e\137\x72\x65\163\164\x72\151\x63\x74\151\157\x6e\x5f\x6c\x6f\147\151\156"]) && !empty($_POST["\155\x6f\x5f\163\x61\x6d\x6c\x5f\x65\x6e\x61\x62\x6c\x65\137\144\x6f\155\x61\x69\156\x5f\x72\145\163\x74\x72\x69\143\164\x69\x6f\x6e\137\154\157\x67\151\x6e"]) ? htmlspecialchars($_POST["\155\x6f\x5f\x73\x61\x6d\x6c\x5f\x65\x6e\141\142\x6c\145\x5f\x64\157\155\141\x69\x6e\137\162\x65\163\x74\x72\151\x63\x74\151\157\156\x5f\x6c\x6f\x67\151\156"]) : '';
        $mG = isset($_POST["\x6d\x6f\137\x73\141\155\x6c\x5f\x61\x6c\x6c\157\x77\x5f\144\x65\156\171\137\165\x73\x65\162\137\x77\151\164\x68\137\144\x6f\x6d\x61\x69\156"]) && !empty($_POST["\155\x6f\x5f\x73\141\155\154\x5f\x61\x6c\154\157\167\x5f\x64\145\x6e\171\x5f\165\163\x65\162\x5f\167\151\164\150\137\x64\x6f\x6d\x61\x69\156"]) ? htmlspecialchars($_POST["\x6d\157\x5f\163\141\155\154\137\141\154\154\x6f\x77\137\144\x65\156\x79\137\165\x73\x65\162\x5f\x77\151\x74\x68\137\144\157\x6d\x61\x69\x6e"]) : "\141\x6c\x6c\157\167";
        $BX = isset($_POST["\x73\141\155\154\137\x61\x6d\137\x65\155\x61\151\154\x5f\x64\x6f\155\141\x69\156\163"]) && !empty($_POST["\163\141\x6d\154\137\x61\x6d\x5f\145\155\x61\x69\154\137\x64\157\x6d\x61\x69\156\x73"]) ? htmlspecialchars($_POST["\163\x61\155\x6c\137\x61\x6d\x5f\145\x6d\141\x69\x6c\137\x64\157\x6d\x61\151\x6e\163"]) : '';
        update_site_option("\155\x6f\x5f\x73\x61\x6d\x6c\137\145\x6e\x61\x62\x6c\x65\x5f\x64\x6f\155\141\x69\156\x5f\162\145\x73\x74\162\x69\143\164\x69\x6f\156\x5f\x6c\157\147\151\156", $iD);
        update_site_option("\x6d\157\x5f\163\141\x6d\x6c\137\141\x6c\x6c\157\167\x5f\144\145\156\x79\x5f\165\163\x65\162\137\x77\x69\164\150\137\x64\x6f\x6d\x61\x69\x6e", $mG);
        update_site_option("\x73\141\155\x6c\137\141\155\x5f\145\x6d\x61\151\x6c\x5f\144\x6f\155\x61\151\156\163", $BX);
        update_site_option("\x6d\157\x5f\163\141\155\154\x5f\x6d\145\163\163\x61\147\145", "\x44\x6f\x6d\141\x69\x6e\x20\122\x65\163\x74\162\x69\143\164\151\x6f\156\40\150\141\163\x20\142\x65\145\156\x20\x73\x61\x76\145\x64\x20\x73\165\x63\143\x65\163\163\x66\165\x6c\x6c\x79\56");
        $this->mo_saml_show_success_message();
        iJ:
        if (!self::mo_check_option_admin_referer("\154\x6f\147\x69\156\137\x77\x69\144\147\x65\x74\137\x73\141\x6d\x6c\137\162\157\x6c\145\137\155\141\x70\x70\151\x6e\147")) {
            goto fh;
        }
        if (mo_saml_is_extension_installed("\x63\x75\x72\154")) {
            goto h1;
        }
        update_site_option("\x6d\157\x5f\163\141\x6d\154\x5f\x6d\x65\x73\x73\141\147\145", "\105\x52\x52\117\x52\72\x20\74\x61\x20\150\x72\x65\146\x3d\x22\x68\164\x74\x70\72\x2f\57\160\150\x70\56\x6e\145\x74\x2f\x6d\x61\x6e\165\x61\154\57\145\x6e\57\x63\165\x72\154\x2e\151\156\163\x74\141\154\x6c\x61\164\x69\157\156\x2e\160\x68\160\x22\x20\x74\x61\162\x67\145\x74\75\42\137\142\x6c\x61\x6e\x6b\42\76\x50\x48\120\x20\x63\x55\122\114\x20\x65\170\x74\145\x6e\x73\151\157\x6e\74\x2f\x61\x3e\x20\151\x73\40\x6e\157\164\x20\151\156\163\x74\x61\x6c\154\145\x64\40\157\x72\x20\144\151\163\x61\x62\154\x65\144\56\x20\x53\141\x76\x65\40\122\x6f\x6c\145\40\x4d\x61\x70\x70\x69\x6e\147\x20\146\x61\151\154\x65\x64\56");
        $this->mo_saml_show_error_message();
        return;
        h1:
        if (isset($_POST["\155\157\137\x61\160\x70\x6c\171\137\162\x6f\154\145\x5f\x6d\141\160\160\151\156\x67\137\x66\157\162\x5f\x73\151\164\x65\x73"]) && $_POST["\155\157\x5f\x61\x70\x70\x6c\171\137\162\x6f\154\x65\x5f\155\x61\160\160\151\156\x67\x5f\146\157\x72\137\163\x69\x74\x65\163"] == 0) {
            goto Jm;
        }
        if (!(isset($_POST["\155\157\137\141\160\160\x6c\x79\x5f\162\x6f\x6c\x65\x5f\x6d\x61\160\160\x69\156\x67\x5f\x66\x6f\162\137\163\151\164\145\x73"]) && $_POST["\155\x6f\137\x61\160\160\154\171\x5f\162\157\x6c\x65\x5f\155\x61\160\x70\x69\x6e\x67\137\146\157\162\x5f\163\151\164\x65\163"] == 1)) {
            goto Sq;
        }
        update_site_option("\155\x6f\137\x61\160\x70\154\x79\x5f\162\x6f\x6c\145\x5f\155\x61\160\x70\151\x6e\x67\x5f\x66\x6f\x72\x5f\x73\151\x74\145\163", 1);
        $ht = 0;
        $wW = array();
        update_site_option("\x73\141\x6d\x6c\x5f\x61\x6d\x5f\x72\157\154\x65\x5f\155\141\x70\160\151\156\x67", $wW);
        Sq:
        goto UQ;
        Jm:
        if (!$this->mo_saml_check_empty_or_null($_POST["\162\157\x6c\145\137\155\141\x70\x70\151\x6e\147\137\163\x69\x74\145"])) {
            goto bL;
        }
        update_site_option("\155\157\137\163\141\x6d\x6c\x5f\155\145\163\x73\x61\147\x65", "\x50\154\145\x61\163\145\x20\x73\x65\154\x65\x63\x74\40\141\40\x73\x69\164\x65\x20\164\x6f\40\163\141\166\x65\x20\x72\157\x6c\x65\40\x6d\x61\x70\x70\x69\x6e\x67");
        $this->mo_saml_show_error_message();
        return;
        bL:
        update_site_option("\155\157\137\141\x70\x70\x6c\171\x5f\x72\x6f\154\145\x5f\x6d\141\x70\x70\x69\156\147\137\x66\x6f\x72\x5f\x73\x69\x74\145\x73", 0);
        $ht = htmlspecialchars($_POST["\162\x6f\154\145\x5f\155\x61\160\160\x69\x6e\x67\x5f\163\151\164\x65"]);
        UQ:
        if (!isset($_POST["\x73\141\x6d\x6c\137\x61\155\x5f\144\145\146\141\x75\154\164\137\165\163\145\x72\137\162\x6f\154\x65"])) {
            goto ba;
        }
        $Tk = htmlspecialchars($_POST["\163\x61\x6d\154\x5f\x61\x6d\x5f\x64\x65\x66\x61\x75\154\164\137\165\x73\x65\x72\x5f\x72\x6f\154\145"]);
        ba:
        if (isset($_POST["\163\x61\155\154\x5f\x61\x6d\x5f\144\x6f\x6e\x74\137\141\154\154\x6f\167\137\x75\x6e\154\151\163\164\x65\x64\x5f\x75\x73\145\162\137\x72\x6f\x6c\145"])) {
            goto vU;
        }
        $fd = "\165\x6e\143\150\145\143\153\x65\x64";
        goto re;
        vU:
        $fd = "\143\x68\145\x63\153\x65\x64";
        $Tk = false;
        re:
        if (isset($_POST["\x6d\157\137\x73\141\x6d\x6c\x5f\144\157\156\x74\x5f\143\x72\x65\141\164\145\x5f\x75\x73\x65\x72\x5f\x69\146\x5f\x72\157\154\x65\x5f\156\x6f\164\137\x6d\x61\160\x70\145\x64"])) {
            goto R1;
        }
        $D3 = "\165\x6e\143\x68\x65\143\x6b\145\144";
        goto iE;
        R1:
        $D3 = "\x63\150\x65\x63\153\x65\x64";
        $fd = "\165\156\143\x68\x65\143\x6b\x65\x64";
        $Tk = false;
        iE:
        if (isset($_POST["\x6d\157\137\163\141\155\154\x5f\x6b\x65\145\x70\x5f\x65\x78\151\x73\164\151\x6e\x67\x5f\165\x73\x65\162\163\x5f\162\x6f\x6c\145"])) {
            goto WK;
        }
        $zj = "\x75\156\x63\150\145\143\153\145\144";
        goto KL;
        WK:
        $zj = "\143\150\145\143\x6b\x65\x64";
        KL:
        if (isset($_POST["\x6d\157\137\163\141\x6d\x6c\137\x64\157\x6e\164\137\x61\x6c\154\157\x77\137\x75\x73\145\x72\137\164\157\154\x6f\x67\x69\156\137\x63\x72\145\x61\x74\x65\137\x77\151\164\x68\x5f\x67\151\x76\x65\x6e\x5f\147\x72\157\165\x70\163"])) {
            goto AV;
        }
        $qz = "\x75\x6e\x63\x68\x65\143\153\x65\144";
        goto tF;
        AV:
        $qz = "\x63\x68\x65\x63\x6b\x65\x64";
        tF:
        if (!isset($_POST["\155\x6f\137\x73\141\155\x6c\x5f\162\145\163\164\x72\x69\143\x74\137\x75\163\145\162\x73\137\x77\x69\x74\150\137\x67\162\x6f\165\x70\163"])) {
            goto Xu;
        }
        $cO = htmlspecialchars($_POST["\x6d\x6f\137\x73\141\155\x6c\x5f\x72\x65\163\164\162\x69\143\164\137\165\x73\145\162\x73\x5f\x77\x69\164\150\137\147\x72\157\x75\160\x73"]);
        Xu:
        if (!isset($_POST["\163\141\155\154\137\x61\x6d\137\x67\162\157\x75\160\x5f\x61\x74\164\162\137\166\141\x6c\x75\x65\x73\137\x73\165\x70\x65\x72\x61\144\155\x69\x6e"])) {
            goto UG;
        }
        $hG = htmlspecialchars($_POST["\x73\141\x6d\x6c\x5f\x61\155\137\147\x72\157\165\160\137\141\x74\x74\162\137\166\x61\x6c\x75\145\163\137\x73\165\160\145\162\x61\x64\155\x69\x6e"]);
        UG:
        $wp_roles = new WP_Roles($ht);
        $pQ = $wp_roles->get_names();
        $wW = maybe_unserialize(get_site_option("\163\x61\155\x6c\137\x61\155\137\162\157\x6c\145\x5f\x6d\x61\x70\x70\151\x6e\147"));
        foreach ($pQ as $bC => $Kp) {
            $Bd = "\x73\x61\x6d\154\x5f\141\155\137\147\162\157\x75\160\x5f\x61\164\x74\162\137\x76\x61\154\x75\x65\x73\137" . $bC;
            $wW[$ht][$bC] = stripslashes($_POST[$Bd]);
            S1:
        }
        js:
        $wW[$ht]["\x64\145\146\141\x75\x6c\164\x5f\162\x6f\154\x65"] = $Tk;
        $wW[$ht]["\144\157\x6e\x74\137\x63\x72\x65\x61\x74\x65\137\x75\x73\x65\162"] = $D3;
        $wW[$ht]["\x64\157\x6e\164\137\x61\154\x6c\x6f\167\x5f\165\156\154\x69\163\164\x65\x64\137\x75\x73\145\x72"] = $fd;
        $wW[$ht]["\x6b\145\145\160\x5f\145\170\x69\x73\x74\151\x6e\147\137\165\163\x65\162\163\x5f\x72\157\x6c\x65"] = $zj;
        $wW[$ht]["\155\x6f\137\163\141\155\x6c\137\x64\x6f\156\x74\137\141\x6c\154\157\167\x5f\x75\x73\145\162\137\164\157\x6c\x6f\147\151\x6e\x5f\x63\x72\x65\141\164\145\137\167\x69\x74\150\137\147\x69\x76\145\156\x5f\x67\162\x6f\165\x70\163"] = $qz;
        $wW[$ht]["\x6d\x6f\137\163\x61\x6d\x6c\x5f\162\145\163\x74\x72\x69\143\x74\137\x75\163\x65\162\163\x5f\x77\151\x74\150\137\147\162\x6f\165\160\163"] = $cO;
        $wW = array_filter($wW, "\x66\x69\x6c\164\x65\x72\137\145\x6d\160\x74\x79\x5f\166\x61\x6c\165\x65\x73");
        $Aa = false;
        if (!(isset($_POST["\x6d\x6f\x5f\163\141\155\154\x5f\x64\x69\163\141\x62\x6c\145\x5f\162\x6f\x6c\145\x5f\155\141\x70\160\151\156\147"]) and $_POST["\155\157\x5f\163\x61\155\154\x5f\144\151\x73\141\x62\x6c\x65\x5f\162\157\154\x65\x5f\155\141\x70\x70\x69\156\x67"] == "\x74\x72\165\145")) {
            goto Ju;
        }
        $Aa = true;
        Ju:
        update_site_option("\155\x6f\137\163\x61\x6d\x6c\x5f\x64\x69\163\141\142\x6c\145\x5f\162\x6f\x6c\145\x5f\x6d\x61\160\x70\x69\x6e\x67", $Aa);
        update_site_option("\x73\x61\155\154\137\141\x6d\137\162\157\x6c\x65\x5f\155\x61\x70\x70\x69\x6e\147", $wW);
        update_site_option("\155\x6f\x5f\x73\141\x6d\x6c\137\155\x65\x73\163\x61\147\x65", "\122\157\x6c\145\40\x4d\141\160\x70\151\156\147\x20\144\x65\x74\141\x69\154\x73\40\163\141\x76\x65\x64\40\163\x75\x63\x63\x65\163\163\146\x75\154\154\x79\x2e");
        update_site_option("\155\x6f\x5f\163\141\155\x6c\137\163\165\160\x65\162\x5f\141\x64\155\x69\156\x5f\x72\157\x6c\145\137\x6d\141\x70\x70\x69\x6e\x67", $hG);
        $this->mo_saml_show_success_message();
        fh:
        if (!self::mo_check_option_admin_referer("\x6d\x6f\137\x73\141\155\x6c\x5f\163\x75\142\163\151\x74\x65\137\x73\x65\154\145\x63\164\x69\157\x6e\x5f\x66\x6f\162\137\162\x6f\x6c\x65\x5f\x6d\141\160\160\x69\x6e\147")) {
            goto HK;
        }
        $mC = isset($_POST["\155\157\x5f\x61\160\160\x6c\x79\x5f\162\x6f\x6c\145\137\x6d\x61\x70\x70\151\x6e\147\x5f\146\x6f\162\x5f\163\x69\164\x65\163"]) ? htmlspecialchars($_POST["\x6d\x6f\137\141\160\x70\154\x79\x5f\162\157\x6c\145\137\x6d\x61\x70\160\x69\x6e\147\137\x66\157\x72\x5f\163\x69\164\x65\163"]) : 0;
        $j5 = isset($_POST["\x72\x6f\154\145\137\155\x61\x70\160\151\156\x67\137\163\x69\164\145"]) ? htmlspecialchars($_POST["\x72\157\154\x65\137\155\x61\x70\x70\x69\156\x67\x5f\163\x69\164\x65"]) : false;
        update_site_option("\x72\x6f\154\x65\137\155\x61\x70\160\x69\x6e\x67\137\163\151\x74\x65", $j5);
        update_site_option("\x6d\157\137\141\x70\160\x6c\171\x5f\x72\157\x6c\x65\x5f\x6d\x61\160\160\x69\x6e\x67\x5f\146\x6f\x72\137\163\x69\164\x65\163", $mC);
        HK:
        if (!self::mo_check_option_admin_referer("\x6d\157\x5f\x73\141\155\x6c\x5f\162\145\x73\145\164\137\162\x6f\154\x65\x5f\155\x61\160\x70\x69\156\147\x5f\x61\164\x74\162\151\142\165\x74\145\163")) {
            goto L1;
        }
        update_site_option("\x6d\157\137\141\160\160\x6c\x79\x5f\x72\157\154\145\137\155\x61\x70\x70\x69\156\147\x5f\x66\157\x72\137\x73\x69\164\x65\x73", 0);
        $wW = array();
        update_site_option("\x73\141\155\154\137\141\155\137\162\x6f\154\x65\x5f\155\x61\160\160\x69\x6e\147", $wW);
        update_site_option("\155\x6f\137\163\x61\155\x6c\x5f\163\165\x70\145\x72\137\x61\144\x6d\x69\x6e\137\162\x6f\154\145\x5f\155\x61\x70\160\x69\156\147", '');
        update_site_option("\x6d\157\x5f\x73\x61\155\x6c\x5f\x6d\145\163\x73\x61\x67\x65", "\x52\157\x6c\x65\40\115\x61\x70\x70\151\156\147\40\x68\x61\x73\x20\x62\145\x65\x6e\x20\162\x65\163\145\164\40\x73\165\143\x63\x65\163\163\146\165\154\154\171\56");
        $this->mo_saml_show_success_message();
        L1:
        if (!self::mo_check_option_admin_referer("\x6d\x6f\x5f\163\141\x6d\154\x5f\x72\x65\x73\145\164\x5f\x73\163\x6f\x5f\x73\x65\164\x74\x69\x6e\x67\163\x5f\x6f\x70\x74\x69\x6f\156")) {
            goto E4;
        }
        $sT = array();
        update_site_option("\x73\141\155\154\137\163\163\x6f\137\x73\x65\164\x74\151\x6e\x67\163", $sT);
        update_site_option("\155\157\x5f\163\141\x6d\x6c\137\155\x65\163\x73\141\x67\145", "\123\123\x4f\40\123\x65\164\x74\x69\156\x67\163\x20\150\x61\x73\x20\142\145\x65\156\x20\x72\145\163\x65\164\40\x73\x75\143\x63\145\x73\x73\x66\165\154\x6c\171\40\x66\x6f\x72\x20\x61\x6c\x6c\40\171\157\165\162\x20\163\x75\x62\x2d\x73\x69\x74\x65\x73\56");
        $this->mo_saml_show_success_message();
        E4:
        if (!(isset($_POST["\x6f\160\164\151\157\x6e"]) and $_POST["\x6f\x70\x74\151\157\x6e"] == "\x6d\157\137\x73\x61\155\x6c\137\x75\160\144\141\x74\x65\137\x73\160\x5f\142\x61\x73\145\x5f\165\162\154\x5f\157\160\x74\x69\x6f\x6e")) {
            goto Ll;
        }
        if (!(isset($_POST["\x6d\157\x5f\x73\141\155\x6c\x5f\163\x70\x5f\142\x61\163\145\x5f\165\x72\154"]) && isset($_POST["\x6d\157\137\163\141\155\154\x5f\x73\160\137\145\x6e\x74\151\164\x79\137\x69\144"]))) {
            goto EC;
        }
        $ia = sanitize_text_field($_POST["\155\x6f\x5f\163\141\x6d\x6c\x5f\163\x70\137\x62\141\x73\145\x5f\x75\162\x6c"]);
        $P6 = sanitize_text_field($_POST["\155\x6f\x5f\x73\141\x6d\x6c\137\163\160\137\x65\156\164\151\x74\171\137\151\x64"]);
        if (!(substr($ia, -1) == "\x2f")) {
            goto W1;
        }
        $ia = substr($ia, 0, -1);
        W1:
        update_site_option("\155\x6f\137\163\141\x6d\x6c\137\x73\x70\137\x62\141\163\x65\137\165\x72\x6c", $ia);
        update_site_option("\155\x6f\x5f\163\x61\155\x6c\x5f\163\160\x5f\145\156\x74\151\164\x79\137\x69\x64", $P6);
        EC:
        update_site_option("\155\157\x5f\x73\141\x6d\154\137\155\145\163\163\141\x67\x65", "\123\x50\40\x42\x61\163\x65\40\x55\x52\114\x20\x75\160\x64\141\164\x65\x64\40\x73\165\143\143\145\x73\163\146\165\154\154\x79\x2e");
        $this->mo_saml_show_success_message();
        Ll:
        if (!self::mo_check_option_admin_referer("\163\141\155\154\x5f\x75\x70\x6c\x6f\141\x64\x5f\x6d\x65\164\x61\144\141\164\x61")) {
            goto U4;
        }
        if (!function_exists("\167\160\x5f\x68\141\156\x64\x6c\x65\x5f\x75\160\154\157\x61\144")) {
            require_once ABSPATH . "\x77\x70\55\x61\144\x6d\151\156\57\151\x6e\143\154\x75\144\x65\x73\x2f\x66\x69\154\x65\x2e\160\x68\160";
        }
        $this->upload_metadata();
        U4:
        if (!self::mo_check_option_admin_referer("\155\157\x5f\x73\x61\x6d\x6c\x5f\x75\160\144\141\x74\x65\x5f\x69\144\160\137\163\x65\x74\164\x69\156\x67\163\x5f\157\x70\x74\151\x6f\156")) {
            goto bb;
        }
        if (!(isset($_POST["\x6d\157\x5f\163\141\155\x6c\137\163\160\x5f\142\x61\163\145\137\x75\162\x6c"]) && isset($_POST["\x6d\x6f\x5f\x73\x61\155\154\137\163\x70\137\x65\x6e\x74\x69\164\171\x5f\151\x64"]))) {
            goto Ky;
        }
        $ia = sanitize_text_field($_POST["\x6d\x6f\137\x73\x61\155\x6c\x5f\163\160\x5f\142\x61\163\x65\x5f\165\x72\x6c"]);
        $P6 = sanitize_text_field($_POST["\155\157\x5f\163\x61\155\154\137\x73\160\x5f\x65\x6e\x74\x69\x74\171\x5f\x69\144"]);
        if (!(substr($ia, -1) == "\x2f")) {
            goto dJ;
        }
        $ia = substr($ia, 0, -1);
        dJ:
        update_site_option("\155\157\137\x73\x61\x6d\154\x5f\163\x70\x5f\x62\x61\x73\145\x5f\165\162\x6c", $ia);
        update_site_option("\155\x6f\137\x73\x61\155\x6c\137\163\x70\137\x65\x6e\x74\x69\164\x79\137\x69\x64", $P6);
        Ky:
        update_site_option("\155\x6f\x5f\x73\141\155\154\x5f\155\x65\163\x73\x61\147\145", "\x53\x65\164\x74\151\x6e\147\x73\40\x75\160\x64\x61\164\145\144\x20\x73\165\143\143\x65\163\163\x66\x75\x6c\x6c\x79\56");
        $this->mo_saml_show_success_message();
        bb:
        if (!self::mo_check_option_admin_referer("\x65\156\x61\142\154\145\137\163\163\157\137\156\x65\x77\x5f\x73\151\x74\x65\x5f\x6f\x70\164\x69\x6f\156")) {
            goto kD;
        }
        if (isset($_POST["\145\x6e\x61\142\154\x65\x5f\163\163\x6f\137\156\145\167\137\163\x69\x74\145"]) and $_POST["\145\x6e\x61\142\154\x65\137\163\x73\x6f\137\x6e\x65\167\x5f\x73\151\164\145"] == "\164\162\x75\x65") {
            goto N_;
        }
        $qI = "\x66\141\x6c\x73\x65";
        goto k4;
        N_:
        $qI = "\164\162\165\x65";
        k4:
        update_site_option("\155\x6f\137\163\141\x6d\154\137\145\x6e\x61\142\x6c\x65\x5f\x73\x73\x6f\137\x6e\x65\x77\137\163\151\164\x65", $qI);
        update_site_option("\x6d\157\x5f\x73\141\x6d\x6c\137\155\x65\x73\x73\x61\x67\x65", "\123\x65\164\164\151\x6e\147\163\x20\165\x70\x64\x61\x74\145\144\x20\x73\x75\143\143\x65\x73\163\146\165\x6c\x6c\171\56");
        $this->mo_saml_show_success_message();
        kD:
        if (!self::mo_check_option_admin_referer("\x75\160\147\162\141\144\x65\137\x63\x65\162\x74")) {
            goto QA;
        }
        $lK = file_get_contents(plugin_dir_path(__FILE__) . "\x72\x65\x73\x6f\x75\162\x63\145\163" . DIRECTORY_SEPARATOR . mo_options_enum_default_sp_certificate::SP_Public_Certificate);
        $E2 = file_get_contents(plugin_dir_path(__FILE__) . "\x72\145\x73\x6f\165\162\143\x65\163" . DIRECTORY_SEPARATOR . mo_options_enum_default_sp_certificate::SP_Private_Key);
        update_site_option("\x6d\157\x5f\x73\141\x6d\154\x5f\x63\165\x72\x72\x65\156\x74\137\x63\x65\x72\x74", $lK);
        update_site_option("\155\157\137\x73\141\155\x6c\137\x63\x75\162\x72\x65\156\164\137\x63\x65\x72\x74\137\160\x72\x69\166\x61\164\145\x5f\x6b\x65\x79", $E2);
        update_site_option("\155\x6f\x5f\163\x61\155\x6c\137\143\145\162\164\x69\x66\151\x63\x61\164\x65\137\162\x6f\x6c\x6c\137\x62\x61\x63\153\137\141\166\x61\151\x6c\x61\142\x6c\145", true);
        update_site_option("\155\x6f\137\163\x61\x6d\x6c\x5f\155\x65\x73\163\141\x67\x65", "\103\x65\162\x74\151\146\x69\143\x61\x74\x65\x20\125\x70\147\162\x61\144\x65\x64\x20\x73\x75\x63\143\x65\x73\163\x66\x75\x6c\x6c\171");
        $this->mo_saml_show_success_message();
        QA:
        if (!self::mo_check_option_admin_referer("\162\x6f\x6c\154\x62\x61\x63\153\x5f\143\145\162\x74")) {
            goto iv;
        }
        $lK = file_get_contents(plugin_dir_path(__FILE__) . "\162\145\163\157\165\x72\x63\145\163" . DIRECTORY_SEPARATOR . mo_options_enum_default_sp_certificate::SP_Rollback_Public_Cert);
        $E2 = file_get_contents(plugin_dir_path(__FILE__) . "\162\145\163\157\x75\x72\143\x65\163" . DIRECTORY_SEPARATOR . mo_options_enum_default_sp_certificate::SP_Rollback_Public_Key);
        update_site_option("\x6d\x6f\137\163\141\x6d\x6c\137\x63\165\x72\x72\x65\156\x74\x5f\143\x65\162\x74", $lK);
        update_site_option("\155\x6f\x5f\163\141\155\154\x5f\x63\165\x72\x72\145\156\164\x5f\x63\145\x72\164\137\160\162\x69\166\141\164\145\x5f\x6b\145\171", $E2);
        update_site_option("\x6d\157\137\163\141\155\x6c\x5f\155\145\x73\163\141\147\145", "\x43\145\162\x74\x69\146\x69\143\x61\x74\145\40\122\157\x6c\154\x2d\x62\141\x63\x6b\145\x64\x20\163\165\x63\x63\145\163\163\x66\165\x6c\154\x79");
        delete_option("\x6d\x6f\x5f\163\x61\155\154\x5f\143\x65\x72\164\151\x66\151\143\x61\164\145\x5f\x72\157\154\x6c\x5f\x62\x61\x63\x6b\137\141\166\x61\x69\x6c\x61\x62\154\145");
        $this->mo_saml_show_success_message();
        iv:
        if (self::mo_check_option_admin_referer("\141\144\x64\137\143\x75\163\x74\x6f\155\137\x63\x65\162\x74\x69\x66\151\x63\141\x74\145")) {
            goto H1;
        }
        if (self::mo_check_option_admin_referer("\155\157\137\x73\141\x6d\154\x5f\x72\x65\155\157\x76\x65\x5f\x61\x63\x63\157\x75\x6e\x74")) {
            goto Bq;
        }
        if (!self::mo_check_option_admin_referer("\141\144\x64\x5f\x63\165\163\x74\x6f\x6d\x5f\x6d\145\x73\x73\x61\x67\145\163")) {
            goto ov;
        }
        update_site_option("\155\x6f\137\x73\141\155\154\137\x61\x63\143\157\165\x6e\164\137\x63\x72\x65\141\164\x69\x6f\x6e\137\x64\151\163\141\142\x6c\x65\144\137\x6d\x73\x67", sanitize_text_field($_POST["\155\x6f\x5f\163\x61\x6d\x6c\x5f\141\x63\x63\157\165\x6e\164\x5f\143\x72\x65\141\x74\x69\157\156\x5f\144\x69\163\x61\x62\x6c\x65\144\x5f\155\x73\147"]));
        update_site_option("\155\x6f\x5f\x73\x61\x6d\x6c\137\x72\145\163\164\x72\x69\143\164\x65\144\x5f\x64\157\x6d\x61\151\156\x5f\145\162\162\157\162\137\155\x73\x67", sanitize_text_field($_POST["\x6d\157\137\163\141\x6d\154\x5f\x72\145\x73\164\x72\x69\x63\x74\145\144\x5f\x64\157\155\141\151\x6e\x5f\x65\162\x72\x6f\162\137\155\163\147"]));
        update_site_option("\155\x6f\137\163\141\x6d\x6c\137\x6d\x65\163\163\141\x67\145", "\103\x6f\156\146\x69\147\165\x72\x61\x74\151\157\156\x20\150\141\163\40\142\x65\x65\x6e\40\163\x61\166\x65\144\40\x73\x75\143\x63\145\163\x73\146\x75\x6c\x6c\x79\56");
        $this->mo_saml_show_success_message();
        ov:
        goto F6;
        Bq:
        $this->mo_sso_saml_deactivate();
        add_site_option("\155\157\x5f\163\x61\155\154\x5f\162\x65\147\x69\163\x74\162\141\x74\x69\x6f\156\x5f\x73\x74\x61\x74\165\163", "\x72\x65\x6d\157\x76\145\144\137\141\143\x63\x6f\x75\x6e\x74");
        $Tz = add_query_arg(array("\164\x61\142" => "\154\x6f\147\x69\x6e"), $_SERVER["\122\105\x51\125\105\123\x54\137\x55\122\x49"]);
        header("\x4c\x6f\143\141\164\x69\157\156\72\40" . $Tz);
        F6:
        goto w_;
        H1:
        $lK = file_get_contents(plugin_dir_path(__FILE__) . "\x72\145\x73\x6f\x75\162\143\x65\x73" . DIRECTORY_SEPARATOR . mo_options_enum_default_sp_certificate::SP_Public_Certificate);
        $E2 = file_get_contents(plugin_dir_path(__FILE__) . "\162\x65\163\x6f\x75\x72\143\x65\x73" . DIRECTORY_SEPARATOR . mo_options_enum_default_sp_certificate::SP_Private_Key);
        if (isset($_POST["\x73\165\x62\155\x69\164"]) and $_POST["\163\165\142\155\151\x74"] == "\125\160\154\157\141\x64") {
            goto IG;
        }
        if (!(isset($_POST["\163\165\x62\x6d\151\164"]) and $_POST["\x73\x75\142\x6d\151\164"] == "\122\145\163\145\x74")) {
            goto gt;
        }
        delete_site_option("\x6d\157\x5f\x73\141\x6d\x6c\x5f\x63\x75\x73\x74\x6f\x6d\137\x63\x65\x72\164");
        delete_site_option("\x6d\157\x5f\x73\141\x6d\154\137\x63\x75\163\x74\157\155\137\143\x65\162\164\x5f\160\x72\x69\166\x61\164\145\x5f\x6b\x65\171");
        update_site_option("\x6d\157\137\163\x61\x6d\154\x5f\x63\165\162\162\145\156\x74\137\143\145\x72\x74", $lK);
        update_site_option("\155\157\x5f\163\141\155\x6c\x5f\143\165\x72\162\x65\x6e\x74\137\x63\145\162\x74\x5f\x70\162\151\166\x61\x74\145\137\x6b\x65\171", $E2);
        update_site_option("\155\x6f\137\x73\x61\155\154\x5f\x6d\145\x73\x73\x61\147\x65", "\x52\145\x73\x65\164\x20\x43\145\162\x74\151\x66\151\143\x61\164\145\40\163\x75\x63\x63\x65\163\163\x66\165\x6c\x6c\171\56");
        $this->mo_saml_show_success_message();
        gt:
        goto vy;
        IG:
        if (!@openssl_x509_read($_POST["\x73\141\x6d\154\137\x70\165\142\154\151\x63\x5f\x78\x35\60\71\x5f\x63\145\x72\164\151\146\x69\x63\x61\x74\x65"])) {
            goto ny;
        }
        if (!@openssl_x509_check_private_key($_POST["\163\141\155\154\x5f\160\165\142\154\151\x63\x5f\x78\x35\60\x39\137\143\x65\162\164\x69\146\x69\143\141\x74\x65"], $_POST["\x73\x61\x6d\154\137\x70\162\x69\x76\141\x74\x65\x5f\x78\65\x30\71\x5f\143\145\x72\x74\151\x66\151\x63\141\x74\x65"])) {
            goto np;
        }
        if (openssl_x509_read($_POST["\x73\141\155\154\137\160\165\142\x6c\x69\x63\x5f\x78\65\60\71\137\143\145\162\x74\x69\x66\151\x63\x61\x74\x65"]) && openssl_x509_check_private_key($_POST["\163\141\x6d\x6c\x5f\x70\x75\x62\154\x69\x63\x5f\170\x35\x30\x39\137\x63\145\162\164\x69\146\x69\143\141\x74\145"], $_POST["\x73\x61\155\x6c\x5f\160\x72\x69\x76\141\x74\x65\137\170\65\60\x39\x5f\x63\x65\x72\x74\151\146\x69\143\141\x74\x65"])) {
            goto y8;
        }
        goto dK;
        ny:
        update_site_option("\x6d\x6f\x5f\x73\141\x6d\154\137\x6d\145\163\163\x61\147\x65", "\x49\156\166\x61\x6c\x69\x64\40\103\x65\x72\164\151\146\x69\x63\x61\164\145\40\146\x6f\x72\x6d\141\x74\56\x20\120\154\x65\x61\x73\x65\40\x65\156\x74\145\162\x20\x61\x20\x76\141\x6c\x69\144\x20\x63\x65\x72\164\151\146\151\x63\x61\164\145\x2e");
        $this->mo_saml_show_error_message();
        return;
        goto dK;
        np:
        update_site_option("\x6d\157\137\163\141\x6d\154\137\155\x65\163\x73\141\x67\x65", "\111\x6e\166\141\x6c\x69\x64\x20\120\162\151\166\x61\164\x65\40\113\x65\x79\x2e");
        $this->mo_saml_show_error_message();
        return;
        goto dK;
        y8:
        $Pn = $_POST["\x73\141\155\x6c\x5f\x70\165\142\x6c\x69\x63\x5f\x78\x35\x30\x39\x5f\x63\x65\x72\164\151\146\x69\x63\x61\164\145"];
        $Vz = $_POST["\x73\141\155\x6c\x5f\x70\x72\151\x76\x61\x74\x65\137\170\65\60\x39\137\x63\x65\162\x74\x69\146\151\143\141\x74\145"];
        update_site_option("\x6d\157\137\163\141\155\154\x5f\x63\x75\x73\x74\157\x6d\x5f\x63\x65\x72\164", $Pn);
        update_site_option("\x6d\157\x5f\163\141\155\154\137\x63\165\x73\164\x6f\x6d\137\x63\x65\162\x74\137\x70\x72\151\166\141\x74\x65\x5f\153\145\x79", $Vz);
        update_site_option("\x6d\x6f\x5f\163\x61\x6d\x6c\137\143\165\x72\x72\145\x6e\164\x5f\x63\x65\162\164", $Pn);
        update_site_option("\x6d\157\x5f\163\141\x6d\154\x5f\x63\x75\x72\162\x65\156\164\137\x63\x65\x72\x74\137\160\x72\x69\166\141\x74\x65\x5f\153\x65\171", $Vz);
        update_site_option("\x6d\157\x5f\163\141\155\x6c\x5f\x6d\145\x73\x73\141\147\x65", "\103\165\x73\x74\x6f\155\40\x43\145\162\x74\x69\x66\x69\x63\x61\164\145\x20\165\x70\144\141\164\x65\144\40\x73\165\x63\x63\x65\163\163\146\165\154\x6c\171\x2e");
        $this->mo_saml_show_success_message();
        dK:
        vy:
        w_:
        if (!self::mo_check_option_admin_referer("\155\x61\x6e\x61\147\x65\137\163\x73\157\137\x73\x69\164\x65\x73")) {
            goto bm;
        }
        $lf = Utilities::get_sites();
        $D7 = Utilities::get_active_sites();
        $cU = false;
        $XM = false;
        if (isset($_POST["\x65\x6e\141\x62\154\x65\101\x6c\x6c"]) and $_POST["\145\x6e\x61\142\154\x65\x41\x6c\x6c"] == "\164\x72\165\145") {
            goto ZI;
        }
        if (!(isset($_POST["\144\x69\163\141\x62\x6c\x65\x41\154\x6c"]) and $_POST["\144\x69\163\141\x62\154\145\x41\x6c\154"] == "\164\162\x75\145")) {
            goto zv;
        }
        $XM = true;
        zv:
        goto v5;
        ZI:
        $cU = true;
        v5:
        foreach ($lf as $LQ) {
            $ht = $LQ->blog_id;
            if ($cU) {
                goto tZ;
            }
            if ($XM) {
                goto l5;
            }
            if (!isset($_POST[$ht])) {
                goto KM;
            }
            if ($_POST[$ht] == "\x66\141\154\163\145") {
                goto hf;
            }
            if ($_POST[$ht] == "\x74\x72\x75\145") {
                goto vt;
            }
            goto Gt;
            hf:
            $XC = array_search($ht, $D7);
            if (!($XC !== false)) {
                goto Ab;
            }
            unset($D7[$XC]);
            Ab:
            goto Gt;
            vt:
            if (in_array($ht, $D7)) {
                goto km;
            }
            array_push($D7, $ht);
            km:
            Gt:
            KM:
            goto lg;
            tZ:
            if (in_array($ht, $D7)) {
                goto e5;
            }
            array_push($D7, $ht);
            e5:
            goto lg;
            l5:
            $XC = array_search($ht, $D7);
            if (!($XC !== false)) {
                goto b0;
            }
            unset($D7[$XC]);
            b0:
            lg:
            RH:
        }
        vY:
        $hz = Utilities::get_main_subsite_id();
        if (in_array($hz, $D7)) {
            goto id;
        }
        array_push($D7, $hz);
        id:
        update_site_option("\155\157\137\145\156\x61\x62\154\145\137\163\163\157\x5f\x73\x69\x74\145\x73", $D7);
        bm:
        if (!self::mo_check_option_admin_referer("\x6d\157\137\x73\x61\155\154\137\x72\145\154\141\171\x5f\163\164\141\164\145\137\x6f\x70\x74\x69\x6f\156")) {
            goto yd;
        }
        $tR = sanitize_text_field($_POST["\x6d\157\137\x73\x61\155\154\137\x72\145\x6c\x61\x79\x5f\163\x74\x61\x74\145"]);
        $sT = maybe_unserialize(get_site_option("\163\141\155\x6c\x5f\163\x73\157\x5f\x73\x65\x74\x74\151\156\x67\163"));
        if ($sT) {
            goto hg;
        }
        $sT = array();
        hg:
        $LQ = "\x44\105\x46\x41\125\x4c\x54";
        if (!isset($_POST["\x73\x69\164\x65"])) {
            goto Zv;
        }
        $LQ = htmlspecialchars($_POST["\163\x69\x74\x65"]);
        Zv:
        if (!(empty($sT[$LQ]) && !empty($sT["\104\x45\x46\x41\x55\114\x54"]))) {
            goto Ja;
        }
        $sT[$LQ] = $sT["\104\x45\x46\101\x55\x4c\x54"];
        Ja:
        $sT[$LQ]["\155\157\x5f\163\x61\x6d\x6c\x5f\162\x65\x6c\141\x79\137\x73\164\x61\164\145"] = $tR;
        update_site_option("\x73\141\x6d\x6c\137\x73\163\157\x5f\163\145\x74\x74\x69\156\x67\x73", $sT);
        update_site_option("\155\157\x5f\x73\141\x6d\154\137\x6d\145\163\163\141\147\145", "\x52\x65\x6c\x61\171\40\x53\164\x61\164\x65\x20\165\x70\x64\x61\x74\145\x64\x20\163\165\143\x63\x65\163\x73\x66\x75\154\154\171\x2e");
        $this->mo_saml_show_success_message();
        yd:
        if (!self::mo_check_option_admin_referer("\155\x6f\x5f\163\x61\155\x6c\137\x77\x69\x64\147\145\x74\x5f\x6f\160\x74\151\x6f\x6e")) {
            goto uT;
        }
        $sT = maybe_unserialize(get_site_option("\x73\141\x6d\x6c\137\163\163\x6f\x5f\x73\145\164\164\x69\x6e\147\x73"));
        if ($sT) {
            goto EW;
        }
        $sT = array();
        EW:
        $LQ = "\x44\105\106\x41\125\x4c\124";
        if (!isset($_POST["\x73\151\164\x65"])) {
            goto mz;
        }
        $LQ = htmlspecialchars($_POST["\x73\151\164\145"]);
        mz:
        if (!(empty($sT[$LQ]) && !empty($sT["\104\105\106\101\125\x4c\124"]))) {
            goto PS;
        }
        $sT[$LQ] = $sT["\x44\x45\106\x41\x55\114\x54"];
        PS:
        $o2 = sanitize_text_field($_POST["\155\x6f\x5f\163\x61\155\x6c\137\143\x75\x73\164\157\x6d\x5f\154\157\x67\x69\156\137\x74\145\170\164"]);
        $sT[$LQ]["\155\157\x5f\x73\141\x6d\154\x5f\x63\165\x73\164\x6f\x6d\x5f\x6c\157\x67\x69\x6e\137\164\145\170\164"] = stripcslashes($o2);
        $Lb = sanitize_text_field($_POST["\x6d\157\x5f\163\141\x6d\154\x5f\x63\165\163\164\x6f\155\x5f\x67\x72\145\x65\x74\151\156\x67\137\164\x65\x78\x74"]);
        $sT[$LQ]["\x6d\x6f\137\x73\141\155\154\x5f\x63\165\163\x74\157\x6d\137\x67\162\x65\x65\x74\x69\156\x67\x5f\x74\145\x78\164"] = stripcslashes($Lb);
        $we = htmlspecialchars(stripslashes($_POST["\x6d\x6f\137\x73\141\x6d\154\137\147\x72\145\x65\x74\151\156\x67\x5f\156\141\x6d\x65"]));
        $sT[$LQ]["\155\157\137\x73\x61\155\154\137\x67\162\x65\x65\x74\x69\x6e\147\x5f\156\141\155\145"] = $we;
        $Sn = sanitize_text_field($_POST["\x6d\157\x5f\x73\141\155\154\x5f\x63\x75\163\164\x6f\x6d\137\154\157\147\x6f\x75\x74\137\x74\145\170\x74"]);
        $sT[$LQ]["\155\157\x5f\x73\x61\x6d\154\x5f\x63\165\163\x74\x6f\155\137\x6c\x6f\147\157\165\x74\137\x74\145\x78\x74"] = stripcslashes($Sn);
        update_site_option("\x73\x61\x6d\x6c\137\x73\x73\157\x5f\x73\x65\x74\164\151\x6e\147\x73", $sT);
        update_site_option("\155\157\137\163\141\x6d\x6c\137\155\145\163\163\141\147\x65", "\127\x69\x64\147\x65\164\x20\123\x65\x74\x74\x69\156\147\163\40\x75\160\x64\141\x74\145\x64\x20\163\x75\143\143\145\163\163\x66\165\x6c\x6c\171\56");
        $this->mo_saml_show_success_message();
        uT:
        if (!self::mo_check_option_admin_referer("\163\x73\157\x5f\163\x65\x74\x74\x69\156\x67\163\137\163\x69\164\x65\x5f\157\160\x74\x69\157\156")) {
            goto p5;
        }
        if (!isset($_POST["\x73\x73\157\137\x73\145\x74\x74\151\156\x67\x73\137\x73\151\164\x65"])) {
            goto ql;
        }
        update_site_option("\x73\x73\157\137\163\145\164\164\x69\156\147\x73\137\x73\151\164\145", htmlspecialchars($_POST["\163\163\157\x5f\163\x65\x74\x74\x69\x6e\x67\163\x5f\x73\151\164\x65"]));
        ql:
        p5:
        if (!self::mo_check_option_admin_referer("\x6d\x6f\x5f\163\141\x6d\x6c\137\x72\145\147\x69\163\x74\145\x72\137\x63\x75\163\x74\157\x6d\145\162")) {
            goto DS;
        }
        if (mo_saml_is_extension_installed("\x63\x75\x72\154")) {
            goto Ua;
        }
        update_site_option("\155\x6f\137\163\x61\x6d\x6c\137\x6d\145\x73\x73\x61\x67\145", "\105\122\122\x4f\x52\x3a\40\74\x61\40\x68\162\x65\x66\75\x22\150\x74\164\x70\x3a\x2f\57\x70\x68\x70\x2e\156\x65\x74\x2f\155\141\156\165\x61\154\57\x65\x6e\x2f\x63\x75\162\154\x2e\151\156\163\x74\141\x6c\154\141\x74\151\x6f\x6e\56\160\150\x70\42\x20\164\141\x72\147\145\x74\75\x22\137\x62\x6c\141\x6e\153\x22\76\x50\110\120\x20\x63\125\x52\x4c\x20\145\x78\x74\145\x6e\x73\151\157\156\x3c\57\x61\x3e\x20\x69\x73\40\x6e\157\x74\x20\x69\x6e\163\164\141\154\x6c\145\144\x20\x6f\162\x20\x64\x69\163\141\142\154\145\144\x2e\40\x52\x65\147\x69\x73\164\162\x61\164\151\157\156\40\146\x61\x69\154\x65\x64\x2e");
        $this->mo_saml_show_error_message();
        return;
        Ua:
        $QC = '';
        $zA = '';
        $qP = '';
        $MF = '';
        if ($this->mo_saml_check_empty_or_null($_POST["\145\x6d\x61\151\154"]) || $this->mo_saml_check_empty_or_null($_POST["\160\141\163\x73\167\x6f\162\x64"]) || $this->mo_saml_check_empty_or_null($_POST["\143\x6f\x6e\x66\151\162\155\x50\x61\x73\x73\167\x6f\162\144"])) {
            goto C7;
        }
        if (strlen($_POST["\160\x61\163\163\167\157\x72\x64"]) < 6 || strlen($_POST["\x63\x6f\156\146\x69\x72\x6d\120\141\x73\163\x77\157\x72\144"]) < 6) {
            goto ug;
        }
        if ($this->checkPasswordPattern(strip_tags($_POST["\x70\x61\163\x73\x77\x6f\x72\x64"]))) {
            goto Pp;
        }
        $QC = sanitize_email($_POST["\x65\155\141\151\x6c"]);
        if (!array_key_exists("\x70\x68\157\156\145", $_POST)) {
            goto jV;
        }
        $zA = sanitize_text_field($_POST["\x70\x68\x6f\156\x65"]);
        jV:
        $qP = stripslashes(strip_tags($_POST["\160\x61\163\x73\x77\x6f\162\144"]));
        $MF = stripslashes(strip_tags($_POST["\x63\x6f\156\146\x69\162\x6d\120\141\x73\x73\167\x6f\x72\x64"]));
        goto rg;
        Pp:
        update_site_option("\155\x6f\x5f\x73\141\155\x6c\137\x6d\x65\163\163\x61\147\145", "\115\x69\156\x69\155\165\155\x20\66\x20\143\x68\141\x72\x61\143\x74\145\162\163\40\x73\x68\x6f\165\x6c\144\40\x62\145\40\x70\162\145\x73\145\156\164\56\40\x4d\141\170\x69\x6d\165\155\x20\x31\x35\x20\x63\x68\141\162\x61\x63\164\145\x72\163\40\163\150\157\165\x6c\x64\40\142\x65\40\x70\162\145\x73\145\x6e\x74\56\x20\x4f\x6e\154\171\40\146\x6f\154\154\x6f\167\151\156\147\40\x73\x79\155\x62\157\x6c\163\40\x28\41\100\43\56\44\45\136\x26\x2a\55\137\51\x20\163\x68\x6f\x75\x6c\x64\40\x62\145\40\160\162\145\x73\x65\156\164\x2e");
        $this->mo_saml_show_error_message();
        return;
        rg:
        goto qj;
        ug:
        update_site_option("\x6d\157\x5f\163\141\155\x6c\x5f\x6d\x65\163\163\141\147\x65", "\x43\x68\157\x6f\x73\145\x20\x61\x20\160\141\x73\x73\167\x6f\x72\144\x20\x77\x69\x74\x68\40\155\x69\156\151\155\x75\x6d\40\x6c\145\156\147\x74\150\x20\x36\x2e");
        $this->mo_saml_show_error_message();
        return;
        qj:
        goto uE;
        C7:
        update_site_option("\x6d\x6f\137\x73\141\155\x6c\137\x6d\145\163\x73\x61\147\145", "\101\154\x6c\x20\x74\x68\x65\40\x66\151\145\x6c\144\163\40\x61\162\145\x20\x72\145\161\165\x69\162\145\x64\56\40\120\154\x65\x61\163\145\40\x65\156\164\145\x72\x20\166\141\154\x69\x64\x20\x65\156\164\162\151\145\x73\x2e");
        $this->mo_saml_show_error_message();
        return;
        uE:
        update_site_option("\x6d\x6f\137\163\141\155\154\x5f\141\144\x6d\x69\x6e\137\145\x6d\141\x69\154", $QC);
        update_site_option("\155\157\137\163\141\155\x6c\x5f\141\x64\x6d\x69\156\137\160\x68\157\x6e\x65", $zA);
        if (strcmp($qP, $MF) == 0) {
            goto xf;
        }
        update_site_option("\x6d\157\x5f\x73\x61\x6d\154\137\155\145\x73\x73\x61\147\145", "\x50\x61\x73\x73\167\157\162\x64\x73\40\144\157\40\156\157\x74\x20\155\141\164\143\x68\56");
        delete_site_option("\155\157\x5f\163\141\x6d\x6c\x5f\x76\145\x72\x69\x66\171\x5f\x63\x75\x73\164\157\155\x65\x72");
        $this->mo_saml_show_error_message();
        goto zC;
        xf:
        update_site_option("\x6d\x6f\x5f\163\x61\x6d\x6c\137\x61\x64\x6d\151\156\x5f\x70\141\x73\x73\167\x6f\162\x64", $qP);
        $QC = get_site_option("\x6d\x6f\x5f\163\x61\155\154\137\x61\x64\155\x69\156\x5f\x65\155\141\151\x6c");
        $ZX = new CustomerSaml();
        $H5 = $ZX->check_customer($this);
        if ($H5) {
            goto zG;
        }
        return;
        zG:
        $Nd = json_decode($H5, true);
        if (strcasecmp($Nd["\x73\164\x61\164\x75\x73"], "\103\x55\x53\x54\117\115\x45\122\x5f\x4e\117\x54\137\x46\x4f\x55\116\x44") == 0) {
            goto zB;
        }
        $this->get_current_customer();
        goto PE;
        zB:
        $Nd = json_decode($ZX->send_otp_token($QC, '', $this), true);
        if (strcasecmp($Nd["\x73\164\x61\164\165\x73"], "\123\x55\x43\103\105\x53\123") == 0) {
            goto RK;
        }
        update_site_option("\155\157\137\x73\141\x6d\x6c\137\x6d\x65\163\163\141\x67\x65", "\x54\150\x65\162\145\x20\167\141\x73\x20\x61\x6e\x20\x65\162\162\157\x72\40\151\156\x20\163\x65\x6e\144\x69\156\x67\40\145\155\x61\151\x6c\56\x20\120\x6c\x65\x61\x73\x65\x20\166\145\162\151\146\x79\x20\x79\x6f\x75\162\40\x65\155\x61\x69\x6c\x20\141\156\144\40\164\x72\171\40\x61\x67\x61\x69\x6e\56");
        update_site_option("\x6d\157\x5f\x73\141\155\154\x5f\162\x65\147\x69\x73\164\162\141\164\151\x6f\156\x5f\x73\164\141\164\165\x73", "\x4d\117\x5f\117\124\x50\x5f\x44\105\114\x49\x56\x45\x52\x45\104\137\x46\x41\x49\114\125\x52\x45\x5f\x45\x4d\x41\111\x4c");
        $this->mo_saml_show_error_message();
        goto zc;
        RK:
        update_site_option("\155\157\x5f\x73\x61\155\x6c\x5f\x6d\145\x73\163\x61\147\x65", "\40\101\x20\157\x6e\145\x20\164\x69\155\x65\x20\x70\x61\163\163\x63\x6f\144\145\40\151\163\x20\163\x65\x6e\164\40\164\157\40" . get_site_option("\155\157\137\x73\x61\155\154\137\x61\144\155\151\x6e\x5f\145\x6d\141\151\154") . "\x2e\x20\x50\154\x65\x61\163\145\40\145\x6e\x74\145\162\x20\164\x68\x65\x20\x6f\164\160\40\x68\145\x72\x65\x20\164\x6f\x20\x76\145\x72\151\x66\x79\x20\171\157\165\162\40\x65\155\141\151\154\56");
        update_site_option("\x6d\157\x5f\163\141\155\154\x5f\164\162\141\156\x73\141\143\x74\x69\x6f\x6e\x49\144", $Nd["\x74\x78\111\x64"]);
        update_site_option("\x6d\x6f\x5f\x73\x61\x6d\x6c\137\162\x65\147\x69\163\x74\x72\x61\x74\151\x6f\x6e\x5f\163\164\x61\164\x75\163", "\x4d\x4f\137\117\124\120\137\x44\x45\x4c\x49\x56\105\x52\x45\104\x5f\123\x55\103\103\x45\123\123\137\105\115\x41\111\x4c");
        $this->mo_saml_show_success_message();
        zc:
        PE:
        zC:
        DS:
        if (!self::mo_check_option_admin_referer("\x6d\x6f\x5f\x73\x61\155\154\137\x76\141\154\x69\x64\141\164\x65\x5f\x6f\164\160")) {
            goto yh;
        }
        if (mo_saml_is_extension_installed("\143\x75\x72\154")) {
            goto AU;
        }
        update_site_option("\x6d\157\x5f\163\141\x6d\154\x5f\x6d\x65\x73\163\141\147\145", "\x45\x52\x52\117\x52\72\x20\74\141\40\x68\x72\145\x66\75\x22\x68\x74\x74\160\x3a\57\x2f\x70\x68\160\56\x6e\145\x74\57\155\x61\156\165\141\154\x2f\x65\156\x2f\x63\165\x72\154\x2e\151\x6e\163\x74\141\x6c\154\x61\x74\151\x6f\x6e\56\x70\150\160\x22\40\x74\x61\x72\x67\x65\164\75\42\137\142\x6c\x61\x6e\153\x22\x3e\120\110\x50\40\x63\125\122\114\40\145\x78\164\x65\x6e\x73\x69\157\x6e\74\57\141\76\x20\x69\x73\40\x6e\157\164\x20\x69\x6e\163\x74\x61\x6c\x6c\145\x64\x20\x6f\162\40\144\151\163\141\x62\x6c\x65\144\56\x20\x56\x61\x6c\x69\x64\141\164\145\40\117\x54\x50\x20\x66\x61\x69\154\145\x64\x2e");
        $this->mo_saml_show_error_message();
        return;
        AU:
        $iz = '';
        if ($this->mo_saml_check_empty_or_null($_POST["\157\164\x70\137\164\157\153\x65\x6e"])) {
            goto tB;
        }
        $iz = sanitize_text_field($_POST["\x6f\x74\x70\x5f\164\157\153\145\x6e"]);
        goto fu;
        tB:
        update_site_option("\155\x6f\137\163\x61\x6d\x6c\137\155\x65\x73\163\x61\x67\145", "\x50\154\x65\x61\x73\x65\40\x65\156\164\145\x72\x20\141\x20\166\x61\x6c\x75\x65\x20\151\156\x20\157\x74\x70\40\146\151\x65\x6c\144\56");
        $this->mo_saml_show_error_message();
        return;
        fu:
        $ZX = new CustomerSaml();
        $Nd = json_decode($ZX->validate_otp_token(get_site_option("\155\x6f\137\163\x61\155\154\137\164\162\x61\156\163\141\x63\x74\x69\x6f\156\x49\144"), $iz, $this), true);
        if (strcasecmp($Nd["\163\164\141\164\x75\x73"], "\x53\125\x43\x43\x45\x53\123") == 0) {
            goto VS;
        }
        update_site_option("\x6d\157\x5f\163\x61\x6d\x6c\x5f\x6d\145\x73\163\x61\147\x65", "\111\156\x76\x61\x6c\x69\144\40\157\156\x65\40\x74\151\x6d\145\40\x70\x61\163\x73\x63\157\x64\145\56\40\120\154\x65\141\x73\x65\x20\x65\x6e\x74\145\x72\40\141\40\166\141\x6c\x69\x64\x20\157\x74\160\56");
        $this->mo_saml_show_error_message();
        goto Ys;
        VS:
        $this->create_customer();
        Ys:
        yh:
        if (self::mo_check_option_admin_referer("\x6d\x6f\137\x73\141\x6d\154\x5f\x76\145\x72\151\x66\171\x5f\143\x75\x73\164\x6f\155\145\x72")) {
            goto Qw;
        }
        if (self::mo_check_option_admin_referer("\155\157\x5f\163\141\155\154\x5f\143\157\156\164\141\143\164\137\x75\x73\137\x71\x75\x65\x72\x79\x5f\157\x70\x74\x69\157\x6e")) {
            goto mv;
        }
        if (self::mo_check_option_admin_referer("\x6d\x6f\137\163\x61\x6d\x6c\137\162\145\x73\x65\x6e\x64\137\x6f\x74\x70\137\145\x6d\x61\151\x6c")) {
            goto Tq;
        }
        if (self::mo_check_option_admin_referer("\155\x6f\x5f\163\141\x6d\x6c\137\x72\145\x73\145\156\x64\x5f\x6f\x74\160\137\x70\x68\x6f\x6e\145")) {
            goto Z5;
        }
        if (self::mo_check_option_admin_referer("\155\157\137\163\x61\155\x6c\x5f\x67\x6f\137\142\x61\x63\153")) {
            goto pW;
        }
        if (self::mo_check_option_admin_referer("\x6d\157\137\x73\141\x6d\x6c\137\162\145\147\151\163\x74\x65\x72\137\x77\x69\164\150\x5f\x70\x68\x6f\x6e\x65\137\157\x70\164\151\x6f\156")) {
            goto gp;
        }
        if (self::mo_check_option_admin_referer("\x6d\x6f\x5f\x73\141\x6d\x6c\x5f\x72\x65\147\151\163\x74\145\x72\145\x64\x5f\157\156\x6c\171\137\x61\143\143\145\x73\163\x5f\x6f\160\x74\x69\x6f\156")) {
            goto FQ;
        }
        if (self::mo_check_option_admin_referer("\155\157\x5f\163\x61\155\154\x5f\x73\x75\142\x73\151\x74\145\137\x61\x63\143\145\x73\163\137\144\x65\156\151\x65\x64\x5f\157\x70\164\x69\157\156")) {
            goto Uu;
        }
        if (self::mo_check_option_admin_referer("\x6d\157\137\163\141\x6d\154\137\146\157\x72\143\145\x5f\141\x75\164\150\145\x6e\x74\151\143\141\164\x69\157\156\x5f\x6f\160\164\x69\x6f\156")) {
            goto Nn;
        }
        if (self::mo_check_option_admin_referer("\155\157\137\163\x61\155\154\x5f\x65\x6e\141\x62\154\x65\x5f\154\157\x67\x69\156\x5f\x72\145\144\151\162\145\x63\x74\x5f\157\x70\x74\x69\x6f\156")) {
            goto vN;
        }
        if (self::mo_check_option_admin_referer("\155\157\137\163\x61\155\x6c\137\x72\145\144\151\162\145\x63\x74\x5f\164\x6f\137\x77\160\x5f\154\x6f\x67\151\x6e\x5f\x6f\x70\164\151\157\156")) {
            goto lc;
        }
        if (self::mo_check_option_admin_referer("\x6d\157\x5f\163\x61\155\x6c\x5f\x61\144\x64\137\163\163\157\137\x62\165\164\164\x6f\156\x5f\x77\160\x5f\157\x70\x74\151\157\x6e")) {
            goto PP;
        }
        if (self::mo_check_option_admin_referer("\155\x6f\137\x73\x61\x6d\154\137\165\x73\145\x5f\142\x75\x74\x74\x6f\x6e\137\141\163\137\163\150\x6f\x72\164\x63\157\x64\x65\137\x6f\160\x74\x69\157\x6e")) {
            goto iG;
        }
        if (self::mo_check_option_admin_referer("\x6d\157\x5f\163\141\155\154\x5f\x75\x73\145\137\x62\x75\164\x74\157\x6e\137\x61\x73\137\167\151\x64\x67\x65\164\x5f\x6f\160\x74\151\157\156")) {
            goto Vu;
        }
        if (self::mo_check_option_admin_referer("\x6d\x6f\x5f\x73\141\x6d\154\x5f\x63\165\163\x74\157\x6d\x5f\142\x75\164\164\157\x6e\137\x6f\160\x74\x69\x6f\x6e")) {
            goto ka;
        }
        if (self::mo_check_option_admin_referer("\155\x6f\x5f\163\141\x6d\x6c\137\141\x6c\x6c\157\167\137\167\x70\137\163\x69\x67\x6e\151\156\137\x6f\x70\x74\x69\x6f\x6e")) {
            goto cV;
        }
        if (!self::mo_check_option_admin_referer("\x6d\x6f\x5f\x73\x61\x6d\154\137\x66\157\x72\147\157\164\137\160\141\163\163\167\157\162\144\x5f\146\157\162\x6d\137\157\x70\164\151\157\156")) {
            goto nL;
        }
        if (mo_saml_is_extension_installed("\143\165\162\x6c")) {
            goto Rt;
        }
        update_site_option("\x6d\x6f\137\x73\141\155\x6c\x5f\155\x65\163\163\141\x67\x65", "\x45\x52\x52\x4f\x52\72\40\74\x61\x20\x68\x72\145\x66\x3d\x22\x68\164\x74\160\72\x2f\57\160\150\160\x2e\x6e\x65\x74\x2f\155\x61\x6e\165\x61\154\x2f\145\156\x2f\143\x75\x72\154\56\x69\x6e\163\x74\x61\x6c\x6c\x61\164\x69\157\x6e\56\160\150\160\42\x20\x74\x61\162\147\145\164\75\x22\x5f\142\x6c\x61\156\x6b\x22\x3e\120\x48\x50\x20\143\125\122\114\40\145\170\x74\x65\x6e\x73\x69\157\156\74\57\x61\x3e\x20\151\163\40\156\x6f\x74\40\151\x6e\x73\x74\141\154\154\145\x64\x20\x6f\x72\x20\144\151\x73\141\142\x6c\x65\144\56\40\122\145\x73\145\x6e\144\40\x4f\x54\120\x20\146\141\x69\154\x65\x64\x2e");
        $this->mo_saml_show_error_message();
        return;
        Rt:
        $QC = get_site_option("\155\157\x5f\163\141\155\x6c\x5f\141\x64\155\151\x6e\x5f\145\x6d\x61\151\x6c");
        $ZX = new Customersaml();
        $Nd = json_decode($ZX->mo_saml_forgot_password($QC, $this), true);
        if (strcasecmp($Nd["\163\164\141\164\x75\163"], "\123\125\x43\x43\105\x53\x53") == 0) {
            goto g3;
        }
        update_site_option("\155\x6f\137\163\x61\x6d\x6c\137\x6d\x65\x73\x73\x61\147\145", "\x41\156\40\145\x72\x72\157\x72\40\x6f\143\x63\165\x72\x65\x64\x20\167\150\151\x6c\145\40\160\x72\157\x63\x65\163\163\x69\x6e\147\x20\171\157\165\x72\40\x72\145\161\165\145\163\x74\x2e\x20\x50\x6c\x65\x61\x73\x65\40\x54\162\x79\x20\141\x67\141\x69\156\x2e");
        $this->mo_saml_show_error_message();
        goto QD;
        g3:
        update_site_option("\x6d\157\x5f\x73\141\x6d\154\137\155\145\163\x73\141\147\145", "\131\157\165\162\x20\160\x61\x73\163\167\x6f\x72\144\x20\x68\x61\x73\40\142\x65\145\156\40\x72\x65\x73\x65\x74\x20\163\x75\x63\143\x65\163\163\x66\x75\154\x6c\171\56\x20\120\154\145\141\163\145\40\145\156\x74\x65\x72\x20\164\150\x65\40\156\145\167\x20\x70\x61\163\163\x77\157\x72\x64\40\163\145\x6e\x74\x20\164\157\x20" . $QC . "\x2e");
        $this->mo_saml_show_success_message();
        QD:
        nL:
        goto SN;
        cV:
        $sT = maybe_unserialize(get_site_option("\x73\141\x6d\154\137\163\x73\x6f\x5f\x73\x65\164\164\151\x6e\147\x73"));
        if (!empty($sT)) {
            goto Ro;
        }
        $sT = array();
        Ro:
        $LQ = "\104\x45\106\101\125\114\124";
        if (!isset($_POST["\x73\151\x74\x65"])) {
            goto Qf;
        }
        $LQ = htmlspecialchars($_POST["\x73\151\x74\x65"]);
        Qf:
        if (!(empty($sT[$LQ]) && !empty($sT["\x44\x45\x46\x41\125\114\124"]))) {
            goto z8;
        }
        $sT[$LQ] = $sT["\104\x45\106\101\125\x4c\124"];
        z8:
        $Ef = "\146\x61\x6c\x73\x65";
        if (array_key_exists("\155\x6f\137\163\x61\155\x6c\x5f\x61\154\154\157\x77\137\x77\x70\137\x73\151\x67\x6e\x69\x6e", $_POST)) {
            goto gE;
        }
        $Fw = "\146\x61\154\163\x65";
        goto Ux;
        gE:
        $Fw = htmlspecialchars($_POST["\x6d\x6f\137\163\141\155\x6c\x5f\x61\154\154\x6f\x77\x5f\167\x70\x5f\163\151\x67\156\151\156"]);
        Ux:
        if ($Fw == "\x74\x72\x75\x65") {
            goto XH;
        }
        $sT[$LQ]["\155\157\137\163\141\x6d\154\x5f\x61\154\x6c\x6f\x77\137\167\x70\137\163\x69\x67\156\151\156"] = '';
        goto Ry;
        XH:
        $sT[$LQ]["\155\157\x5f\163\x61\155\x6c\137\x61\154\x6c\x6f\x77\x5f\x77\160\137\163\151\x67\x6e\x69\x6e"] = "\x74\x72\165\x65";
        if (!array_key_exists("\155\x6f\137\x73\x61\155\154\137\142\141\x63\153\144\x6f\x6f\162\x5f\165\162\x6c", $_POST)) {
            goto YB;
        }
        $Ef = htmlspecialchars(trim($_POST["\155\x6f\137\x73\x61\x6d\x6c\x5f\x62\x61\x63\x6b\144\157\157\162\137\x75\162\154"]));
        YB:
        Ry:
        $sT[$LQ]["\x6d\x6f\x5f\163\141\x6d\154\x5f\142\141\143\x6b\144\x6f\157\x72\137\165\x72\154"] = $Ef;
        update_site_option("\x73\x61\x6d\x6c\x5f\x73\x73\157\137\x73\145\x74\164\x69\156\147\163", $sT);
        update_site_option("\x6d\157\137\163\x61\x6d\154\137\x6d\x65\x73\163\141\x67\145", "\123\x69\x67\156\x20\x49\156\40\163\x65\x74\x74\x69\x6e\147\163\40\165\160\144\141\x74\145\x64\x2e");
        $this->mo_saml_show_success_message();
        SN:
        goto oN;
        ka:
        $sT = maybe_unserialize(get_site_option("\x73\x61\x6d\x6c\x5f\x73\163\157\137\x73\145\x74\x74\151\156\147\x73"));
        if ($sT) {
            goto q2;
        }
        $sT = array();
        q2:
        $LQ = "\x44\x45\x46\x41\x55\x4c\x54";
        if (!isset($_POST["\163\x69\x74\145"])) {
            goto wh;
        }
        $LQ = htmlspecialchars($_POST["\163\x69\x74\145"]);
        wh:
        if (!(empty($sT[$LQ]) && !empty($sT["\x44\105\106\101\125\114\124"]))) {
            goto YT;
        }
        $sT[$LQ] = $sT["\104\105\x46\101\125\x4c\x54"];
        YT:
        $e0 = '';
        $LY = '';
        $jm = '';
        $dz = '';
        $Hk = '';
        $OR = '';
        $hS = '';
        $Ol = '';
        $uf = '';
        $U4 = '';
        $f2 = "\x61\142\x6f\166\145";
        if (!(array_key_exists("\155\157\137\163\141\155\x6c\137\x62\x75\164\x74\157\x6e\x5f\163\151\172\145", $_POST) && !empty($_POST["\x6d\x6f\x5f\x73\141\x6d\154\137\x62\165\164\164\157\156\137\163\x69\172\x65"]))) {
            goto UE;
        }
        $jm = htmlspecialchars($_POST["\x6d\157\137\163\x61\155\x6c\x5f\142\x75\x74\164\157\x6e\x5f\x73\x69\172\145"]);
        UE:
        if (!(array_key_exists("\155\x6f\137\163\x61\155\154\137\x62\x75\x74\164\x6f\x6e\x5f\167\x69\144\164\150", $_POST) && !empty($_POST["\155\157\137\163\x61\x6d\154\137\142\165\164\x74\157\156\137\167\x69\144\164\150"]))) {
            goto ky;
        }
        $dz = htmlspecialchars($_POST["\x6d\x6f\137\163\x61\155\x6c\137\x62\165\164\x74\x6f\x6e\x5f\167\x69\144\x74\150"]);
        ky:
        if (!(array_key_exists("\155\x6f\137\163\141\155\154\137\142\x75\x74\164\157\156\x5f\x68\145\x69\147\x68\x74", $_POST) && !empty($_POST["\x6d\x6f\137\163\141\155\154\x5f\x62\165\164\x74\x6f\156\x5f\150\145\151\147\x68\164"]))) {
            goto MG;
        }
        $Hk = htmlspecialchars($_POST["\155\x6f\x5f\x73\x61\x6d\x6c\137\x62\x75\164\x74\157\x6e\137\x68\145\151\x67\x68\164"]);
        MG:
        if (!(array_key_exists("\155\157\x5f\163\141\x6d\x6c\137\142\x75\164\164\157\156\x5f\x63\165\162\166\x65", $_POST) && !empty($_POST["\155\157\137\163\141\x6d\154\x5f\x62\165\x74\x74\157\x6e\137\x63\165\x72\x76\145"]))) {
            goto yN;
        }
        $OR = htmlspecialchars($_POST["\x6d\157\x5f\163\141\x6d\x6c\x5f\142\165\164\164\157\156\x5f\x63\165\x72\166\x65"]);
        yN:
        if (!array_key_exists("\155\157\x5f\163\x61\x6d\x6c\137\x62\x75\x74\x74\x6f\156\137\x63\157\x6c\157\x72", $_POST)) {
            goto Xi;
        }
        $hS = htmlspecialchars($_POST["\x6d\x6f\137\163\x61\x6d\x6c\x5f\142\165\164\x74\157\156\137\143\157\154\x6f\162"]);
        Xi:
        if (!array_key_exists("\x6d\157\137\x73\x61\155\x6c\137\142\x75\x74\164\x6f\x6e\137\164\x68\145\155\145", $_POST)) {
            goto kL;
        }
        $e0 = htmlspecialchars($_POST["\x6d\x6f\137\x73\x61\155\154\x5f\142\x75\164\x74\x6f\156\x5f\x74\150\x65\x6d\145"]);
        kL:
        if (!array_key_exists("\x6d\x6f\x5f\163\141\155\154\137\142\x75\x74\164\x6f\x6e\137\164\145\170\x74", $_POST)) {
            goto vH;
        }
        $Ol = htmlspecialchars($_POST["\x6d\x6f\137\163\x61\x6d\x6c\137\142\x75\x74\x74\157\x6e\137\x74\145\x78\164"]);
        if (!(empty($Ol) || $Ol == "\x23\43\x49\x44\x50\x23\x23")) {
            goto Ib;
        }
        $Ol = "\x23\x23\111\104\120\x23\43";
        Ib:
        $Xs = get_site_option("\163\141\155\154\x5f\151\144\145\x6e\x74\x69\x74\x79\x5f\156\141\x6d\145");
        $Ol = str_replace("\x23\43\111\104\120\x23\x23", $Xs, $Ol);
        vH:
        if (!array_key_exists("\155\157\x5f\x73\141\x6d\154\137\x66\157\x6e\x74\x5f\143\157\154\157\x72", $_POST)) {
            goto vs;
        }
        $uf = htmlspecialchars($_POST["\x6d\157\x5f\x73\x61\155\154\x5f\146\157\x6e\164\137\x63\x6f\x6c\157\162"]);
        vs:
        if (!array_key_exists("\x6d\x6f\x5f\163\x61\x6d\154\x5f\x66\157\156\x74\x5f\x73\151\x7a\x65", $_POST)) {
            goto je;
        }
        $U4 = htmlspecialchars($_POST["\155\157\x5f\163\141\x6d\154\x5f\146\x6f\156\x74\x5f\163\x69\x7a\145"]);
        je:
        if (!array_key_exists("\x73\163\157\137\142\x75\x74\x74\x6f\156\x5f\154\157\x67\151\x6e\x5f\x66\x6f\x72\x6d\137\160\x6f\x73\x69\x74\x69\157\x6e", $_POST)) {
            goto sT;
        }
        $f2 = htmlspecialchars($_POST["\x73\x73\157\x5f\x62\x75\164\164\x6f\x6e\x5f\x6c\x6f\147\x69\x6e\x5f\x66\x6f\x72\x6d\137\160\x6f\x73\151\x74\151\157\156"]);
        sT:
        $sT[$LQ]["\x6d\x6f\137\163\x61\155\x6c\137\x62\165\x74\x74\157\156\x5f\164\150\145\155\x65"] = $e0;
        $sT[$LQ]["\x6d\157\137\x73\141\155\154\137\x62\165\164\x74\x6f\156\137\x73\151\172\x65"] = $jm;
        $sT[$LQ]["\x6d\x6f\137\163\x61\155\x6c\137\x62\x75\164\164\x6f\x6e\x5f\167\x69\144\x74\x68"] = $dz;
        $sT[$LQ]["\x6d\157\137\163\x61\155\154\x5f\x62\x75\164\164\x6f\156\137\x68\x65\151\147\x68\x74"] = $Hk;
        $sT[$LQ]["\x6d\157\x5f\163\x61\155\154\137\142\165\x74\164\x6f\156\x5f\x63\165\x72\166\x65"] = $OR;
        $sT[$LQ]["\155\157\x5f\163\x61\155\x6c\x5f\x62\165\x74\x74\x6f\156\x5f\143\x6f\154\x6f\x72"] = $hS;
        $sT[$LQ]["\155\157\137\x73\x61\x6d\x6c\137\x62\165\x74\x74\157\156\137\x74\145\170\x74"] = $Ol;
        $sT[$LQ]["\x6d\x6f\x5f\163\141\x6d\x6c\137\x66\x6f\156\x74\137\143\x6f\154\x6f\162"] = $uf;
        $sT[$LQ]["\x6d\x6f\137\163\x61\155\x6c\x5f\146\157\156\164\137\x73\x69\x7a\x65"] = $U4;
        $sT[$LQ]["\x73\x73\157\137\142\165\164\x74\157\x6e\x5f\x6c\x6f\147\x69\x6e\x5f\x66\157\162\x6d\x5f\160\157\163\x69\164\x69\157\x6e"] = $f2;
        update_site_option("\163\141\155\x6c\137\x73\163\x6f\x5f\x73\x65\164\x74\x69\156\147\x73", $sT);
        update_site_option("\155\157\x5f\x73\x61\x6d\154\x5f\x6d\145\163\x73\x61\x67\x65", "\123\x69\x67\x6e\x20\x49\156\40\x73\145\x74\164\151\156\147\163\x20\x75\160\x64\x61\x74\145\144\56");
        $this->mo_saml_show_success_message();
        oN:
        goto rB;
        Vu:
        if (mo_saml_is_sp_configured()) {
            goto a7;
        }
        update_site_option("\x6d\157\x5f\163\x61\x6d\154\x5f\155\145\x73\163\x61\x67\145", "\x50\x6c\145\141\x73\x65\x20\143\x6f\155\160\x6c\145\x74\145\40" . addLink("\x53\x65\162\166\x69\143\145\x20\x50\162\x6f\x76\x69\x64\x65\162", add_query_arg(array("\x74\x61\x62" => "\163\141\x76\145"), $_SERVER["\122\x45\x51\x55\105\x53\x54\137\125\122\x49"])) . "\40\x63\157\x6e\146\x69\x67\x75\x72\x61\x74\x69\157\x6e\x20\x66\x69\162\163\x74\56");
        $this->mo_saml_show_error_message();
        goto og;
        a7:
        $sT = maybe_unserialize(get_site_option("\163\141\155\154\x5f\163\x73\157\x5f\x73\145\x74\164\151\156\147\163"));
        if ($sT) {
            goto Wd;
        }
        $sT = array();
        Wd:
        $LQ = "\104\x45\106\x41\x55\x4c\124";
        if (!isset($_POST["\163\151\164\x65"])) {
            goto rx;
        }
        $LQ = htmlspecialchars($_POST["\163\151\164\145"]);
        rx:
        if (!(empty($sT[$LQ]) && !empty($sT["\104\x45\x46\x41\125\x4c\x54"]))) {
            goto Q0;
        }
        $sT[$LQ] = $sT["\104\x45\x46\x41\125\x4c\x54"];
        Q0:
        if (array_key_exists("\155\x6f\137\163\141\x6d\x6c\x5f\165\x73\x65\137\142\x75\x74\164\x6f\x6e\137\x61\163\x5f\x77\151\144\147\x65\x74", $_POST)) {
            goto gS;
        }
        $Jr = "\x66\x61\x6c\x73\x65";
        goto ME;
        gS:
        $Jr = htmlspecialchars($_POST["\155\x6f\137\163\x61\x6d\x6c\x5f\165\x73\x65\x5f\142\165\x74\164\157\156\137\x61\163\137\167\151\144\147\x65\x74"]);
        ME:
        $sT[$LQ]["\x6d\x6f\137\x73\141\155\154\137\x75\x73\145\x5f\x62\165\x74\x74\157\156\x5f\141\163\137\x77\x69\x64\x67\x65\x74"] = $Jr;
        update_site_option("\163\x61\155\154\x5f\163\163\157\x5f\163\x65\x74\164\x69\156\147\163", $sT);
        update_site_option("\x6d\157\x5f\x73\141\x6d\x6c\137\155\145\x73\x73\x61\x67\145", "\x53\x69\x67\x6e\40\x69\x6e\40\157\x70\x74\151\157\x6e\163\40\165\160\x64\x61\x74\x65\x64\x2e");
        $this->mo_saml_show_success_message();
        og:
        rB:
        goto xe;
        iG:
        if (mo_saml_is_sp_configured()) {
            goto bP;
        }
        update_site_option("\x6d\157\x5f\x73\x61\x6d\x6c\137\155\145\163\x73\141\x67\145", "\120\x6c\x65\141\x73\145\40\x63\157\x6d\x70\154\145\x74\145\x20" . addLink("\123\145\x72\166\151\143\x65\40\120\162\157\166\x69\x64\145\x72", add_query_arg(array("\164\141\x62" => "\x73\x61\x76\145"), $_SERVER["\122\x45\x51\x55\x45\123\124\x5f\x55\x52\x49"])) . "\x20\x63\157\x6e\146\151\x67\x75\162\141\x74\x69\x6f\156\x20\x66\151\162\x73\x74\56");
        $this->mo_saml_show_error_message();
        goto Ic;
        bP:
        $sT = maybe_unserialize(get_site_option("\163\x61\155\x6c\137\163\x73\157\137\163\x65\164\164\151\x6e\x67\x73"));
        if ($sT) {
            goto ud;
        }
        $sT = array();
        ud:
        $LQ = "\104\105\x46\x41\125\114\124";
        if (!isset($_POST["\x73\x69\x74\x65"])) {
            goto ux;
        }
        $LQ = htmlspecialchars($_POST["\x73\x69\x74\145"]);
        ux:
        if (!(empty($sT[$LQ]) && !empty($sT["\x44\105\106\101\125\x4c\x54"]))) {
            goto ok;
        }
        $sT[$LQ] = $sT["\104\x45\x46\x41\125\114\x54"];
        ok:
        if (array_key_exists("\155\157\x5f\163\141\x6d\154\x5f\165\x73\145\x5f\142\x75\164\x74\157\156\x5f\x61\x73\x5f\x73\150\x6f\x72\x74\x63\x6f\144\145", $_POST)) {
            goto n0;
        }
        $Jr = "\x66\x61\154\163\145";
        goto CA;
        n0:
        $Jr = htmlspecialchars($_POST["\x6d\157\x5f\x73\x61\x6d\x6c\x5f\165\163\145\x5f\142\165\x74\x74\157\156\137\141\163\137\x73\x68\x6f\162\164\x63\157\x64\145"]);
        CA:
        $sT[$LQ]["\155\x6f\x5f\163\141\x6d\x6c\x5f\x75\163\x65\137\142\x75\x74\164\157\x6e\x5f\141\x73\137\x73\150\157\162\x74\143\157\x64\145"] = $Jr;
        update_site_option("\x73\141\155\x6c\x5f\x73\x73\x6f\x5f\163\x65\x74\164\151\x6e\x67\163", $sT);
        update_site_option("\155\x6f\137\x73\141\155\x6c\137\x6d\145\x73\163\x61\x67\145", "\123\151\147\156\40\x69\156\40\x6f\160\164\151\157\x6e\x73\40\x75\x70\144\141\x74\145\144\x2e");
        $this->mo_saml_show_success_message();
        Ic:
        xe:
        goto Y8;
        PP:
        if (mo_saml_is_sp_configured()) {
            goto rZ;
        }
        update_site_option("\x6d\157\x5f\x73\x61\x6d\154\137\x6d\145\163\x73\x61\x67\145", "\x50\154\145\x61\x73\x65\40\x63\x6f\155\160\x6c\145\164\145\x20" . addLink("\123\145\162\x76\x69\143\x65\x20\120\162\157\166\x69\144\145\x72", add_query_arg(array("\164\x61\x62" => "\163\x61\x76\x65"), $_SERVER["\122\x45\121\x55\105\123\124\137\x55\x52\x49"])) . "\x20\143\157\x6e\x66\x69\147\x75\162\x61\164\151\157\156\40\x66\151\x72\x73\164\56");
        $this->mo_saml_show_error_message();
        goto lM;
        rZ:
        $sT = maybe_unserialize(get_site_option("\163\x61\x6d\x6c\137\163\163\157\x5f\163\x65\x74\x74\151\x6e\x67\x73"));
        if ($sT) {
            goto uO;
        }
        $sT = array();
        uO:
        $LQ = "\104\105\106\101\x55\114\x54";
        if (!isset($_POST["\x73\x69\x74\x65"])) {
            goto tT;
        }
        $LQ = htmlspecialchars($_POST["\x73\151\x74\x65"]);
        tT:
        if (!(empty($sT[$LQ]) && !empty($sT["\x44\x45\x46\101\125\114\124"]))) {
            goto Dl;
        }
        $sT[$LQ] = $sT["\x44\x45\106\101\125\x4c\x54"];
        Dl:
        if (array_key_exists("\x6d\x6f\137\163\x61\155\x6c\137\141\x64\144\x5f\x73\x73\157\137\142\x75\x74\164\157\x6e\137\x77\x70", $_POST)) {
            goto Wm;
        }
        $o5 = "\x66\141\154\x73\145";
        goto br;
        Wm:
        $o5 = htmlspecialchars($_POST["\155\x6f\137\163\141\x6d\x6c\x5f\x61\144\144\137\x73\x73\x6f\x5f\142\165\164\x74\x6f\x6e\137\167\x70"]);
        br:
        $sT[$LQ]["\x6d\x6f\x5f\163\x61\x6d\154\x5f\x61\x64\x64\x5f\x73\x73\157\x5f\x62\x75\x74\164\x6f\x6e\137\167\160"] = $o5;
        update_site_option("\x73\141\155\x6c\x5f\163\x73\x6f\137\163\145\164\x74\x69\156\147\x73", $sT);
        update_site_option("\155\157\x5f\163\x61\x6d\154\137\x6d\145\163\163\x61\x67\x65", "\x53\151\147\x6e\x20\x69\x6e\40\157\x70\x74\x69\157\x6e\163\40\165\160\x64\141\164\x65\x64\x2e");
        $this->mo_saml_show_success_message();
        lM:
        Y8:
        goto LN;
        lc:
        if (!mo_saml_is_sp_configured()) {
            goto Uq;
        }
        $sT = maybe_unserialize(get_site_option("\x73\x61\155\x6c\x5f\163\163\x6f\137\163\145\x74\164\x69\156\147\163"));
        if ($sT) {
            goto R6;
        }
        $sT = array();
        R6:
        $LQ = "\104\x45\x46\x41\x55\114\x54";
        if (!isset($_POST["\x73\151\164\145"])) {
            goto VB;
        }
        $LQ = htmlspecialchars($_POST["\163\151\x74\145"]);
        VB:
        if (!(empty($sT[$LQ]) && !empty($sT["\104\105\x46\x41\125\114\124"]))) {
            goto sx;
        }
        $sT[$LQ] = $sT["\x44\x45\x46\x41\x55\114\124"];
        sx:
        if (array_key_exists("\155\157\x5f\x73\x61\155\154\137\162\145\144\x69\x72\x65\x63\x74\x5f\164\x6f\137\167\x70\x5f\x6c\x6f\147\151\156", $_POST)) {
            goto z6;
        }
        $Q0 = "\146\x61\x6c\x73\x65";
        goto Y9;
        z6:
        $Q0 = htmlspecialchars($_POST["\155\x6f\137\x73\141\x6d\x6c\x5f\x72\145\144\151\x72\145\143\164\137\x74\157\137\167\160\137\x6c\157\x67\x69\x6e"]);
        Y9:
        $sT[$LQ]["\155\157\x5f\x73\x61\155\154\137\162\145\144\151\x72\145\143\x74\x5f\164\x6f\137\167\x70\x5f\x6c\157\147\x69\x6e"] = $Q0;
        update_site_option("\x73\141\x6d\x6c\137\163\x73\157\x5f\163\x65\x74\x74\151\156\x67\163", $sT);
        update_site_option("\155\x6f\137\x73\141\155\x6c\137\155\x65\163\x73\x61\147\x65", "\x53\151\147\x6e\40\151\156\x20\157\160\164\151\x6f\156\163\40\x75\x70\x64\141\x74\x65\x64\56");
        $this->mo_saml_show_success_message();
        Uq:
        LN:
        goto KN;
        vN:
        if (mo_saml_is_sp_configured()) {
            goto LO;
        }
        update_site_option("\155\157\x5f\163\x61\155\154\x5f\x6d\145\163\x73\x61\147\145", "\120\x6c\145\x61\x73\145\40\x63\x6f\155\160\x6c\145\x74\x65\40\x3c\x61\40\150\162\145\x66\75\42" . add_query_arg(array("\164\x61\142" => "\163\141\166\145"), $_SERVER["\122\x45\121\125\x45\x53\124\137\x55\122\x49"]) . "\x22\40\57\x3e\123\145\x72\x76\151\143\145\40\x50\x72\157\166\x69\x64\x65\162\74\57\x61\x3e\x20\143\x6f\156\x66\x69\147\165\162\141\x74\x69\x6f\x6e\x20\146\151\162\x73\164\56");
        $this->mo_saml_show_error_message();
        goto Dx;
        LO:
        $sT = maybe_unserialize(get_site_option("\163\141\155\154\x5f\163\163\157\137\x73\145\x74\164\x69\156\147\x73"));
        if (!empty($sT)) {
            goto MI;
        }
        $sT = array();
        MI:
        $LQ = "\x44\105\x46\x41\125\x4c\x54";
        if (!isset($_POST["\x73\x69\x74\x65"])) {
            goto il;
        }
        $LQ = htmlspecialchars($_POST["\163\x69\x74\x65"]);
        il:
        if (!(empty($sT[$LQ]) && !empty($sT["\104\105\106\x41\125\114\x54"]))) {
            goto ZC;
        }
        $sT[$LQ] = $sT["\x44\x45\x46\101\125\x4c\x54"];
        ZC:
        if (array_key_exists("\155\x6f\x5f\163\141\155\154\x5f\x65\x6e\x61\142\154\x65\x5f\154\157\x67\x69\156\x5f\162\x65\x64\x69\162\145\143\164", $_POST)) {
            goto Jg;
        }
        $PS = "\x66\x61\154\163\x65";
        goto E_;
        Jg:
        $PS = htmlspecialchars($_POST["\155\x6f\137\x73\141\x6d\154\x5f\145\x6e\141\142\154\145\x5f\154\157\x67\151\x6e\137\x72\x65\x64\151\162\x65\143\x74"]);
        E_:
        if ($PS == "\164\162\165\145") {
            goto Hi;
        }
        $sT[$LQ]["\155\x6f\x5f\x73\x61\x6d\x6c\x5f\x65\156\x61\142\154\145\137\x6c\157\147\x69\x6e\x5f\x72\x65\144\151\x72\x65\x63\x74"] = '';
        $sT[$LQ]["\155\x6f\137\x73\141\x6d\x6c\137\141\154\154\x6f\167\137\x77\160\137\163\151\147\x6e\x69\x6e"] = '';
        goto Hk;
        Hi:
        $sT[$LQ]["\x6d\x6f\137\163\141\155\154\137\145\156\x61\x62\x6c\145\137\154\x6f\147\x69\x6e\137\162\x65\x64\151\162\x65\x63\164"] = "\164\162\x75\x65";
        $sT[$LQ]["\x6d\157\x5f\x73\x61\155\154\137\x61\154\x6c\157\x77\x5f\167\160\137\x73\x69\x67\x6e\151\156"] = "\164\x72\165\x65";
        Hk:
        update_site_option("\x73\141\155\154\x5f\x73\x73\157\x5f\163\x65\164\x74\x69\x6e\x67\163", $sT);
        update_site_option("\x6d\x6f\x5f\163\x61\x6d\x6c\x5f\155\145\x73\163\141\147\x65", "\123\151\x67\x6e\40\x69\x6e\x20\x6f\x70\164\151\x6f\156\163\40\x75\160\x64\141\164\145\144\x2e");
        $this->mo_saml_show_success_message();
        Dx:
        KN:
        goto vb;
        Nn:
        if (mo_saml_is_sp_configured()) {
            goto sa;
        }
        update_site_option("\x6d\157\137\163\141\x6d\x6c\x5f\155\145\163\x73\x61\147\x65", "\x50\x6c\x65\141\163\145\40\x63\x6f\155\160\154\145\x74\145\x20\x3c\x61\x20\150\x72\145\146\x3d\x22" . add_query_arg(array("\x74\x61\x62" => "\x73\141\x76\145"), $_SERVER["\122\x45\x51\x55\x45\x53\x54\x5f\125\x52\x49"]) . "\42\x20\x2f\76\123\145\x72\166\x69\143\x65\x20\120\162\157\166\151\x64\x65\162\x3c\57\141\76\40\x63\x6f\x6e\146\151\x67\x75\162\x61\x74\x69\x6f\156\x20\146\x69\162\x73\164\x2e");
        $this->mo_saml_show_error_message();
        goto fb;
        sa:
        $sT = maybe_unserialize(get_site_option("\x73\x61\x6d\x6c\x5f\163\x73\157\137\x73\x65\x74\x74\x69\x6e\x67\163"));
        if (!empty($sT)) {
            goto fs;
        }
        $sT = array();
        fs:
        $LQ = "\104\105\x46\101\x55\x4c\124";
        if (!isset($_POST["\163\151\x74\x65"])) {
            goto Vl;
        }
        $LQ = htmlspecialchars($_POST["\163\151\164\x65"]);
        Vl:
        if (!(empty($sT[$LQ]) && !empty($sT["\104\105\x46\101\x55\x4c\124"]))) {
            goto qe;
        }
        $sT[$LQ] = $sT["\x44\x45\106\x41\x55\x4c\x54"];
        qe:
        if (array_key_exists("\155\157\x5f\163\x61\x6d\154\137\146\157\162\x63\x65\x5f\141\x75\x74\150\x65\x6e\164\x69\143\141\x74\151\x6f\156", $_POST)) {
            goto sg;
        }
        $PS = "\x66\x61\x6c\163\145";
        goto r0;
        sg:
        $PS = htmlspecialchars($_POST["\155\x6f\137\x73\141\x6d\154\137\x66\x6f\x72\x63\x65\x5f\141\165\x74\x68\145\156\164\x69\143\x61\164\x69\157\156"]);
        r0:
        if ($PS == "\164\162\x75\x65") {
            goto E3;
        }
        $sT[$LQ]["\155\x6f\x5f\163\x61\x6d\154\137\x66\157\162\x63\x65\137\141\165\x74\150\x65\156\164\x69\143\141\164\151\157\156"] = '';
        goto Zn;
        E3:
        $sT[$LQ]["\155\157\x5f\x73\141\155\154\x5f\x66\x6f\162\x63\x65\137\141\165\x74\150\145\156\x74\x69\x63\141\x74\x69\x6f\x6e"] = "\164\x72\x75\145";
        Zn:
        update_site_option("\163\x61\x6d\154\x5f\163\x73\157\x5f\163\145\164\164\151\x6e\x67\x73", $sT);
        update_site_option("\155\x6f\x5f\163\x61\155\154\x5f\155\145\x73\163\x61\x67\145", "\x53\x69\147\156\x20\151\156\40\157\x70\164\151\157\x6e\x73\40\165\160\144\141\x74\145\x64\x2e");
        $this->mo_saml_show_success_message();
        fb:
        vb:
        goto dh;
        Uu:
        if (mo_saml_is_sp_configured()) {
            goto ch;
        }
        update_site_option("\x6d\x6f\137\163\x61\155\154\137\x6d\x65\x73\163\141\147\145", "\120\154\145\141\163\x65\x20\143\x6f\x6d\160\154\145\164\x65\x20\x3c\141\40\x68\162\145\x66\75\x22" . add_query_arg(array("\x74\x61\x62" => "\x73\141\166\x65"), $_SERVER["\x52\105\121\125\105\x53\124\137\125\x52\x49"]) . "\42\x20\x2f\x3e\123\x65\x72\x76\151\x63\145\40\x50\162\157\x76\151\x64\145\162\74\x2f\141\x3e\40\143\157\x6e\x66\x69\147\165\162\141\x74\151\x6f\156\x20\x66\151\162\x73\x74\56");
        $this->mo_saml_show_error_message();
        goto fY;
        ch:
        $sT = maybe_unserialize(get_site_option("\x73\141\x6d\154\x5f\x73\163\x6f\137\x73\x65\x74\164\151\x6e\147\x73"));
        if (!empty($sT)) {
            goto pv;
        }
        $sT = array();
        pv:
        $LQ = "\x44\x45\x46\101\125\114\x54";
        if (!isset($_POST["\x73\151\164\x65"])) {
            goto a1;
        }
        $LQ = htmlspecialchars($_POST["\163\151\x74\145"]);
        a1:
        if (!(empty($sT[$LQ]) && !empty($sT["\x44\x45\106\x41\x55\114\124"]))) {
            goto Hb;
        }
        $sT[$LQ] = $sT["\104\x45\106\101\x55\x4c\x54"];
        Hb:
        if (array_key_exists("\155\x6f\x5f\163\141\155\x6c\x5f\x73\165\142\163\151\164\x65\x5f\x61\x63\x63\x65\x73\163\137\144\145\156\x69\x65\x64", $_POST)) {
            goto Mk;
        }
        $fM = "\x66\x61\154\163\x65";
        goto oX;
        Mk:
        $fM = htmlspecialchars($_POST["\155\157\x5f\163\x61\155\x6c\x5f\163\x75\142\163\151\164\145\x5f\141\143\x63\x65\x73\163\x5f\x64\145\x6e\151\145\144"]);
        oX:
        if ($fM == "\x74\162\x75\145") {
            goto aZ;
        }
        $sT[$LQ]["\155\157\x5f\x73\x61\x6d\154\137\x73\x75\142\163\x69\164\x65\137\x61\x63\143\145\x73\x73\x5f\144\145\x6e\151\145\144"] = '';
        goto H6;
        aZ:
        $sT[$LQ]["\x6d\x6f\x5f\x73\141\x6d\x6c\x5f\x73\165\x62\163\x69\164\x65\137\x61\143\x63\145\x73\163\x5f\144\145\x6e\x69\x65\144"] = "\164\x72\x75\145";
        H6:
        update_site_option("\x73\141\x6d\x6c\x5f\163\x73\157\x5f\163\145\164\x74\151\x6e\x67\163", $sT);
        update_site_option("\155\x6f\137\x73\141\x6d\154\137\x6d\x65\x73\x73\141\147\x65", "\x53\151\147\156\x20\151\x6e\x20\x6f\160\164\x69\x6f\x6e\163\40\x75\160\144\141\x74\145\x64\x2e");
        $this->mo_saml_show_success_message();
        fY:
        dh:
        goto co;
        FQ:
        if (mo_saml_is_sp_configured()) {
            goto Sn;
        }
        update_site_option("\x6d\x6f\137\163\x61\x6d\x6c\137\x6d\x65\163\163\x61\x67\145", "\x50\x6c\x65\141\x73\145\x20\143\157\x6d\x70\x6c\x65\164\145\x20\74\141\x20\150\162\x65\x66\75\42" . add_query_arg(array("\164\141\142" => "\163\141\x76\x65"), $_SERVER["\122\x45\121\125\105\x53\124\x5f\125\122\111"]) . "\42\40\57\76\x53\145\162\x76\x69\143\145\40\120\162\x6f\166\x69\144\145\162\x3c\x2f\141\x3e\40\x63\x6f\156\x66\x69\147\165\162\141\164\x69\157\156\x20\x66\151\162\x73\164\56");
        $this->mo_saml_show_error_message();
        goto XZ;
        Sn:
        if (array_key_exists("\x6d\157\137\163\141\155\154\x5f\162\x65\147\151\x73\164\x65\162\x65\144\x5f\157\x6e\154\x79\137\141\x63\x63\145\163\x73", $_POST)) {
            goto Bl;
        }
        $PS = "\146\x61\x6c\x73\x65";
        goto Pm;
        Bl:
        $PS = htmlspecialchars($_POST["\155\157\x5f\x73\141\155\x6c\137\162\145\147\151\163\164\145\x72\145\x64\x5f\x6f\x6e\x6c\x79\x5f\141\143\143\145\163\x73"]);
        Pm:
        $sT = maybe_unserialize(get_site_option("\163\141\155\154\137\x73\x73\157\137\x73\145\164\164\x69\156\147\x73"));
        if (!empty($sT)) {
            goto im;
        }
        $sT = array();
        im:
        $LQ = "\x44\x45\106\x41\x55\x4c\124";
        if (!isset($_POST["\x73\151\164\145"])) {
            goto qz;
        }
        $LQ = htmlspecialchars($_POST["\x73\151\x74\145"]);
        qz:
        if (!(empty($sT[$LQ]) && !empty($sT["\104\x45\x46\101\125\114\x54"]))) {
            goto cw;
        }
        $sT[$LQ] = $sT["\104\x45\106\x41\x55\x4c\124"];
        cw:
        if ($PS == "\x74\162\x75\x65") {
            goto UN;
        }
        $sT[$LQ]["\155\x6f\x5f\x73\x61\155\154\x5f\x72\145\147\151\x73\x74\145\x72\x65\144\x5f\x6f\x6e\x6c\x79\137\x61\x63\143\x65\x73\163"] = '';
        goto IY;
        UN:
        $sT[$LQ]["\x6d\x6f\137\163\x61\x6d\x6c\137\x72\x65\147\x69\163\164\x65\162\x65\x64\137\157\156\x6c\171\x5f\x61\x63\x63\145\x73\x73"] = "\164\x72\165\145";
        IY:
        update_site_option("\x73\x61\x6d\x6c\x5f\x73\x73\157\137\163\x65\x74\x74\151\156\147\x73", $sT);
        update_site_option("\x6d\x6f\137\163\141\155\x6c\137\x6d\145\x73\163\x61\147\145", "\123\151\x67\156\x20\x69\156\x20\157\160\164\x69\157\156\163\40\165\x70\144\x61\x74\x65\x64\56");
        $this->mo_saml_show_success_message();
        XZ:
        co:
        goto WE;
        gp:
        if (mo_saml_is_extension_installed("\143\x75\162\x6c")) {
            goto H0;
        }
        update_site_option("\155\x6f\x5f\x73\x61\155\x6c\137\155\145\x73\163\141\x67\145", "\x45\x52\122\117\122\x3a\40\74\x61\40\150\162\145\146\x3d\x22\150\164\164\160\72\x2f\x2f\160\x68\160\x2e\x6e\145\x74\x2f\x6d\x61\x6e\165\141\x6c\57\x65\x6e\57\143\165\x72\x6c\56\151\x6e\163\164\x61\x6c\x6c\141\164\x69\157\156\56\x70\x68\160\42\40\164\141\x72\147\145\x74\75\42\137\x62\x6c\x61\156\153\x22\x3e\120\110\120\x20\143\125\x52\114\x20\145\x78\x74\x65\156\163\151\x6f\156\74\57\x61\x3e\40\151\x73\x20\156\157\x74\x20\151\156\x73\164\x61\x6c\x6c\x65\144\x20\x6f\162\x20\144\x69\x73\x61\x62\154\145\144\56\x20\122\x65\163\x65\x6e\x64\x20\x4f\x54\x50\40\146\x61\x69\x6c\x65\x64\56");
        $this->mo_saml_show_error_message();
        return;
        H0:
        $zA = sanitize_text_field($_POST["\x70\150\157\x6e\145"]);
        $zA = str_replace("\40", '', $zA);
        $zA = str_replace("\55", '', $zA);
        update_site_option("\155\x6f\x5f\163\141\155\x6c\137\141\144\155\151\x6e\137\x70\x68\157\156\x65", $zA);
        $ZX = new CustomerSaml();
        $Nd = json_decode($ZX->send_otp_token('', $zA, $this, FALSE, TRUE), true);
        if (strcasecmp($Nd["\x73\x74\141\x74\x75\163"], "\x53\125\x43\x43\105\123\x53") == 0) {
            goto RW;
        }
        update_site_option("\155\x6f\x5f\x73\141\155\154\137\155\145\x73\x73\141\147\145", "\124\x68\x65\162\145\40\167\141\163\40\x61\156\40\x65\x72\x72\157\162\x20\151\156\x20\x73\x65\156\144\x69\x6e\x67\x20\x53\x4d\x53\x2e\40\120\x6c\x65\141\163\145\x20\x63\x6c\x69\143\x6b\x20\x6f\156\40\x52\145\163\145\156\x64\40\x4f\124\120\40\164\x6f\40\164\x72\x79\x20\x61\x67\141\151\x6e\56");
        update_site_option("\x6d\x6f\137\163\141\155\154\137\x72\145\147\x69\x73\x74\162\141\164\151\x6f\156\x5f\163\164\141\164\x75\x73", "\x4d\x4f\137\x4f\x54\120\137\x44\105\114\111\x56\x45\x52\105\x44\137\x46\x41\x49\x4c\125\x52\x45\x5f\x50\x48\117\x4e\105");
        $this->mo_saml_show_error_message();
        goto R8;
        RW:
        update_site_option("\155\x6f\x5f\163\x61\x6d\x6c\x5f\x6d\x65\163\163\x61\147\145", "\x20\101\x20\157\x6e\145\x20\164\x69\x6d\145\x20\160\x61\x73\x73\x63\x6f\x64\x65\x20\x69\163\x20\163\145\x6e\164\x20\164\x6f\40" . get_site_option("\155\157\137\x73\x61\x6d\154\137\141\x64\x6d\151\x6e\x5f\x70\x68\157\156\x65") . "\x2e\x20\120\x6c\x65\x61\163\x65\x20\x65\156\x74\x65\x72\x20\x74\x68\x65\40\157\x74\160\x20\150\145\x72\145\40\164\x6f\40\166\145\162\x69\146\x79\x20\171\157\x75\162\40\145\155\x61\151\x6c\x2e");
        update_site_option("\155\x6f\x5f\163\x61\x6d\154\137\164\x72\141\156\163\x61\x63\164\x69\157\x6e\111\x64", $Nd["\164\170\111\x64"]);
        update_site_option("\155\157\x5f\x73\x61\x6d\154\x5f\x72\145\147\x69\163\x74\162\141\164\151\157\156\x5f\x73\x74\141\164\x75\x73", "\x4d\x4f\137\117\x54\x50\x5f\104\105\x4c\x49\126\105\x52\x45\104\x5f\123\x55\103\x43\x45\x53\x53\137\120\110\x4f\116\105");
        $this->mo_saml_show_success_message();
        R8:
        WE:
        goto hG;
        pW:
        update_site_option("\x6d\157\x5f\163\141\x6d\x6c\137\162\145\x67\151\163\x74\x72\141\x74\151\157\156\137\163\164\141\164\x75\x73", '');
        update_site_option("\155\157\x5f\163\x61\155\154\x5f\166\145\x72\151\146\x79\137\x63\x75\163\x74\157\155\x65\x72", '');
        delete_site_option("\155\157\x5f\163\141\x6d\x6c\x5f\156\x65\167\x5f\162\x65\x67\151\x73\x74\162\141\x74\151\x6f\x6e");
        delete_site_option("\155\157\x5f\163\141\155\154\137\141\x64\x6d\151\156\x5f\x65\155\x61\151\x6c");
        delete_site_option("\155\157\137\163\141\x6d\x6c\x5f\141\x64\155\x69\x6e\137\x70\150\x6f\x6e\145");
        delete_site_option("\163\155\x6c\x5f\x6c\x6b");
        delete_site_option("\x74\x5f\x73\x69\164\145\x5f\163\164\141\164\x75\x73");
        delete_site_option("\163\151\164\x65\x5f\x63\x6b\x5f\154");
        delete_site_option("\156\157\x5f\163\x62\163");
        delete_site_option("\x75\x73\145\162\x5f\141\x6c\x65\162\164\x5f\x65\x6d\x61\151\x6c\137\x73\x65\x6e\164");
        delete_site_option("\154\x69\x63\145\x6e\163\x65\x5f\x61\154\145\x72\164\x5f\145\155\141\151\x6c\137\x73\145\156\164");
        delete_site_option("\x6d\x6f\x5f\163\x61\x6d\154\x5f\141\x6c\145\162\x74\x5f\x73\145\156\x74\x5f\146\x6f\162\137\x6f\x6e\145");
        delete_site_option("\x6d\x6f\137\x73\141\x6d\x6c\137\x61\154\145\x72\164\137\x73\x65\x6e\x74\x5f\146\157\162\x5f\164\x77\157");
        delete_site_option("\x6d\157\x5f\x73\141\x6d\154\x5f\x75\163\162\137\x6c\155\164");
        hG:
        goto kV;
        Z5:
        if (mo_saml_is_extension_installed("\x63\x75\x72\x6c")) {
            goto sZ;
        }
        update_site_option("\155\157\137\x73\141\155\154\137\155\x65\x73\x73\x61\x67\x65", "\105\122\122\117\x52\x3a\40\x3c\141\40\x68\162\145\x66\x3d\42\150\164\x74\160\x3a\57\57\x70\150\x70\56\156\145\x74\x2f\x6d\x61\x6e\x75\141\154\57\x65\156\57\143\165\x72\x6c\56\x69\x6e\x73\x74\141\x6c\154\x61\x74\151\x6f\x6e\x2e\x70\x68\160\42\40\x74\141\x72\147\x65\164\x3d\42\137\142\x6c\x61\x6e\153\42\x3e\x50\x48\x50\x20\x63\x55\x52\x4c\40\x65\x78\x74\x65\x6e\x73\x69\157\156\74\57\x61\x3e\x20\x69\163\40\x6e\157\x74\x20\x69\x6e\x73\164\141\154\154\x65\144\x20\157\162\40\144\x69\x73\141\142\x6c\x65\144\56\40\122\x65\163\x65\x6e\x64\40\x4f\x54\x50\40\146\141\x69\x6c\x65\144\x2e");
        $this->mo_saml_show_error_message();
        return;
        sZ:
        $zA = get_site_option("\155\157\137\x73\141\x6d\x6c\x5f\141\x64\155\151\156\137\x70\150\157\156\145");
        $ZX = new CustomerSaml();
        $Nd = json_decode($ZX->send_otp_token('', $zA, $this, FALSE, TRUE), true);
        if (strcasecmp($Nd["\163\164\x61\x74\x75\163"], "\x53\125\x43\x43\105\x53\123") == 0) {
            goto DX;
        }
        update_site_option("\x6d\157\x5f\163\141\155\x6c\x5f\x6d\145\163\163\x61\147\145", "\124\150\x65\x72\x65\x20\x77\x61\163\40\141\156\x20\145\x72\162\x6f\x72\40\151\156\40\x73\x65\156\x64\151\156\147\40\x65\x6d\x61\151\154\x2e\x20\x50\154\x65\141\163\x65\40\x63\x6c\x69\143\153\x20\x6f\156\x20\x52\145\163\145\156\144\40\x4f\x54\120\x20\164\157\40\164\x72\171\x20\x61\x67\x61\x69\156\56");
        update_site_option("\x6d\x6f\137\163\x61\x6d\154\137\x72\145\147\151\x73\164\x72\x61\x74\151\x6f\x6e\137\163\x74\x61\164\165\x73", "\x4d\x4f\x5f\117\124\x50\x5f\x44\105\x4c\111\x56\x45\122\x45\x44\x5f\106\x41\x49\x4c\125\x52\105\x5f\x50\110\x4f\116\x45");
        $this->mo_saml_show_error_message();
        goto QX;
        DX:
        update_site_option("\155\157\x5f\x73\x61\155\154\137\x6d\145\163\x73\141\147\x65", "\40\x41\x20\x6f\x6e\x65\40\164\x69\155\x65\40\x70\x61\163\163\143\x6f\144\145\40\x69\x73\x20\163\145\x6e\x74\x20\164\157\x20" . $zA . "\40\141\x67\141\151\156\56\x20\120\x6c\x65\141\x73\145\40\x63\150\145\143\x6b\40\x69\x66\x20\171\x6f\165\x20\147\157\x74\40\x74\150\145\x20\157\164\160\x20\141\156\144\x20\145\x6e\164\x65\x72\x20\151\164\x20\150\145\x72\x65\x2e");
        update_site_option("\155\157\137\163\141\x6d\x6c\137\164\162\141\156\x73\141\x63\164\x69\x6f\156\111\144", $Nd["\x74\x78\111\144"]);
        update_site_option("\155\x6f\x5f\x73\x61\x6d\x6c\x5f\162\x65\147\x69\163\x74\162\141\164\151\x6f\x6e\137\x73\164\141\x74\x75\163", "\115\x4f\137\117\x54\x50\x5f\104\105\114\111\126\105\x52\x45\104\137\123\125\103\103\x45\123\x53\x5f\x50\x48\117\x4e\x45");
        $this->mo_saml_show_success_message();
        QX:
        kV:
        goto qx;
        Tq:
        if (mo_saml_is_extension_installed("\143\165\x72\x6c")) {
            goto Bp;
        }
        update_site_option("\x6d\157\x5f\163\141\x6d\x6c\137\x6d\145\x73\163\141\147\145", "\105\x52\x52\x4f\122\x3a\x20\x3c\x61\x20\150\x72\145\x66\75\x22\x68\x74\164\x70\x3a\x2f\x2f\160\x68\160\x2e\156\x65\x74\57\x6d\x61\156\x75\141\154\57\145\x6e\x2f\143\x75\x72\x6c\56\x69\x6e\163\x74\x61\154\x6c\141\x74\x69\157\x6e\56\x70\x68\160\42\x20\164\141\162\x67\145\x74\x3d\x22\137\142\154\x61\x6e\x6b\42\76\x50\110\120\x20\143\125\122\114\x20\x65\x78\164\x65\x6e\x73\x69\x6f\x6e\x3c\x2f\x61\76\x20\x69\163\40\156\157\x74\40\x69\x6e\x73\x74\141\x6c\154\145\144\x20\x6f\162\40\144\x69\163\x61\x62\x6c\x65\144\56\x20\x52\x65\163\145\156\x64\x20\x4f\x54\x50\x20\146\x61\151\x6c\x65\144\x2e");
        $this->mo_saml_show_error_message();
        return;
        Bp:
        $QC = get_site_option("\x6d\x6f\x5f\x73\141\x6d\x6c\x5f\141\x64\x6d\x69\x6e\x5f\x65\x6d\x61\x69\154");
        $ZX = new CustomerSaml();
        $Nd = json_decode($ZX->send_otp_token($QC, '', $this), true);
        if (strcasecmp($Nd["\x73\164\x61\x74\x75\x73"], "\x53\x55\103\103\x45\123\123") == 0) {
            goto yS;
        }
        update_site_option("\x6d\x6f\x5f\163\141\155\154\137\x6d\145\163\163\x61\x67\145", "\124\150\x65\x72\145\x20\167\141\163\x20\141\x6e\x20\x65\x72\x72\157\x72\x20\151\x6e\x20\x73\x65\156\x64\151\156\x67\x20\x65\155\x61\x69\154\56\x20\120\154\x65\x61\163\145\40\x63\154\x69\x63\153\40\157\x6e\40\122\x65\163\145\156\144\x20\117\x54\120\40\x74\157\x20\164\x72\x79\40\141\x67\x61\151\156\56");
        update_site_option("\155\157\x5f\163\x61\x6d\154\x5f\x72\x65\x67\x69\163\164\162\x61\x74\151\x6f\156\x5f\x73\164\141\164\x75\x73", "\115\117\x5f\x4f\124\x50\137\x44\105\114\x49\126\105\x52\x45\104\x5f\x46\x41\x49\114\x55\122\105\x5f\105\115\x41\x49\x4c");
        $this->mo_saml_show_error_message();
        goto QF;
        yS:
        update_site_option("\155\157\x5f\x73\141\x6d\154\137\x6d\145\163\x73\x61\147\145", "\40\x41\40\x6f\x6e\x65\40\x74\x69\x6d\145\x20\160\141\163\x73\x63\157\144\145\x20\x69\x73\x20\163\x65\x6e\x74\40\x74\157\40" . get_site_option("\155\x6f\137\163\x61\x6d\154\137\x61\144\x6d\x69\x6e\137\x65\x6d\x61\151\154") . "\40\x61\147\141\x69\156\x2e\40\120\x6c\145\141\x73\x65\40\x63\x68\145\x63\x6b\x20\151\x66\40\171\x6f\165\x20\x67\157\164\x20\164\150\x65\x20\157\x74\160\40\141\156\x64\40\145\x6e\x74\145\x72\40\151\x74\x20\150\x65\162\x65\56");
        update_site_option("\x6d\157\x5f\163\141\155\154\137\x74\x72\x61\156\x73\141\143\164\151\157\x6e\111\x64", $Nd["\164\170\111\x64"]);
        update_site_option("\155\157\x5f\x73\141\155\154\137\x72\145\147\x69\x73\x74\x72\x61\164\151\157\156\x5f\163\x74\141\164\x75\x73", "\115\x4f\x5f\117\124\120\137\x44\105\x4c\x49\126\105\122\105\104\x5f\123\x55\103\x43\105\x53\123\137\x45\115\x41\x49\x4c");
        $this->mo_saml_show_success_message();
        QF:
        qx:
        goto Zd;
        mv:
        if (mo_saml_is_extension_installed("\143\165\162\154")) {
            goto zE;
        }
        update_site_option("\155\x6f\x5f\163\141\x6d\154\x5f\x6d\145\163\163\141\x67\x65", "\x45\122\122\x4f\x52\x3a\40\x3c\141\40\150\x72\x65\146\x3d\x22\x68\x74\x74\x70\x3a\x2f\x2f\x70\150\x70\56\156\x65\164\x2f\155\x61\156\165\141\x6c\57\x65\x6e\57\x63\x75\162\154\56\x69\156\163\164\x61\154\x6c\141\164\151\157\156\56\160\150\x70\x22\40\164\x61\162\147\x65\164\x3d\x22\137\142\x6c\141\x6e\153\x22\x3e\120\x48\120\40\143\125\x52\x4c\x20\145\170\x74\145\156\x73\151\x6f\x6e\74\57\x61\x3e\40\151\x73\x20\x6e\157\164\40\x69\x6e\x73\x74\141\154\154\x65\x64\x20\x6f\x72\x20\x64\x69\x73\141\x62\x6c\x65\x64\x2e\40\x51\x75\x65\162\171\x20\x73\x75\142\155\x69\164\x20\x66\x61\151\154\145\144\56");
        $this->mo_saml_show_error_message();
        return;
        zE:
        $QC = htmlspecialchars($_POST["\155\x6f\x5f\x73\x61\x6d\x6c\137\143\157\x6e\x74\x61\143\164\137\165\163\137\145\155\141\x69\x6c"]);
        $zA = htmlspecialchars($_POST["\155\157\137\163\x61\155\x6c\x5f\x63\x6f\156\164\x61\x63\164\137\x75\163\x5f\160\150\157\x6e\x65"]);
        $wO = htmlspecialchars($_POST["\x6d\157\x5f\x73\141\x6d\154\137\x63\157\156\x74\x61\x63\164\137\165\x73\x5f\161\x75\x65\x72\171"]);
        if (array_key_exists("\x73\x65\x6e\x64\x5f\x70\x6c\x75\x67\x69\156\x5f\143\157\x6e\x66\151\147", $_POST) === true) {
            goto QM;
        }
        update_site_option("\x73\145\156\x64\x5f\160\154\165\x67\151\x6e\x5f\x63\x6f\156\146\151\x67", "\157\x66\x66");
        goto Lc;
        QM:
        $GD = miniorange_import_export(true, true);
        $wO .= $GD;
        delete_site_option("\x73\145\x6e\x64\137\x70\154\x75\147\151\156\137\143\x6f\156\146\x69\147");
        Lc:
        $ZX = new CustomerSaml();
        if ($this->mo_saml_check_empty_or_null($QC) || $this->mo_saml_check_empty_or_null($wO)) {
            goto G_;
        }
        $Y9 = $ZX->submit_contact_us($QC, $zA, $wO, $this);
        if ($Y9 == false) {
            goto BR;
        }
        update_site_option("\x6d\x6f\137\x73\141\x6d\x6c\x5f\155\145\163\163\x61\x67\145", "\x54\150\x61\156\x6b\x73\x20\146\157\x72\x20\147\145\x74\164\x69\x6e\x67\40\x69\156\x20\x74\157\165\143\x68\x21\40\x57\x65\x20\x73\x68\x61\x6c\x6c\x20\147\145\164\x20\142\x61\x63\153\x20\164\x6f\40\x79\x6f\165\x20\163\x68\157\162\164\x6c\171\56");
        $this->mo_saml_show_success_message();
        goto Gs;
        BR:
        update_site_option("\x6d\x6f\137\x73\141\155\154\x5f\x6d\x65\163\x73\141\x67\145", "\131\157\x75\162\40\161\165\x65\x72\x79\40\x63\x6f\165\x6c\x64\40\156\x6f\x74\x20\x62\x65\x20\x73\165\142\155\151\164\164\145\x64\x2e\x20\120\154\x65\141\163\x65\40\164\162\171\x20\x61\147\141\151\x6e\56");
        $this->mo_saml_show_error_message();
        Gs:
        goto rb;
        G_:
        update_site_option("\x6d\157\x5f\x73\x61\x6d\154\137\155\x65\x73\163\x61\x67\145", "\x50\x6c\145\x61\163\x65\40\146\151\x6c\154\40\x75\x70\40\x45\155\141\x69\x6c\x20\x61\x6e\x64\40\121\165\x65\162\171\40\146\151\145\154\x64\163\x20\164\157\x20\x73\165\x62\x6d\x69\x74\40\171\x6f\x75\162\x20\161\x75\x65\162\171\56");
        $this->mo_saml_show_error_message();
        rb:
        Zd:
        goto AM;
        Qw:
        if (mo_saml_is_extension_installed("\143\165\162\154")) {
            goto FS;
        }
        update_site_option("\155\157\137\163\141\x6d\154\x5f\x6d\145\x73\163\141\x67\145", "\x45\x52\122\x4f\x52\x3a\40\74\141\x20\150\x72\x65\146\x3d\x22\x68\x74\164\x70\x3a\57\57\x70\x68\160\56\156\145\164\x2f\x6d\x61\x6e\x75\141\154\x2f\145\x6e\57\143\165\162\x6c\x2e\x69\156\x73\164\x61\x6c\154\x61\164\x69\157\x6e\x2e\x70\150\x70\x22\x20\164\x61\162\147\145\164\75\42\137\142\x6c\x61\156\153\x22\x3e\120\110\x50\x20\143\125\x52\114\40\x65\x78\164\145\156\x73\151\x6f\x6e\74\57\x61\x3e\x20\x69\x73\x20\156\x6f\164\40\151\x6e\163\x74\141\154\154\x65\144\40\157\x72\40\144\151\163\141\142\154\145\x64\x2e\x20\114\157\x67\x69\156\40\146\141\151\154\x65\x64\x2e");
        $this->mo_saml_show_error_message();
        return;
        FS:
        $QC = '';
        $qP = '';
        if ($this->mo_saml_check_empty_or_null($_POST["\x65\155\141\x69\x6c"]) || $this->mo_saml_check_empty_or_null($_POST["\x70\x61\x73\x73\x77\x6f\x72\x64"])) {
            goto AL;
        }
        if ($this->checkPasswordPattern(strip_tags($_POST["\x70\x61\163\163\x77\157\162\x64"]))) {
            goto gZ;
        }
        $QC = sanitize_email($_POST["\145\x6d\141\151\x6c"]);
        $qP = stripslashes(strip_tags($_POST["\160\x61\x73\163\167\157\x72\144"]));
        goto pu;
        gZ:
        update_site_option("\155\x6f\x5f\x73\x61\x6d\154\137\155\x65\x73\x73\x61\x67\145", "\115\151\x6e\151\x6d\165\155\40\66\x20\143\150\141\162\141\x63\x74\145\x72\163\40\x73\x68\x6f\x75\154\144\40\x62\x65\x20\160\x72\x65\163\x65\x6e\164\56\x20\x4d\141\170\151\155\165\x6d\40\61\65\40\143\x68\141\162\x61\x63\x74\x65\162\x73\x20\163\150\x6f\x75\x6c\144\x20\x62\x65\x20\x70\x72\145\x73\145\156\x74\56\40\x4f\156\x6c\x79\40\146\x6f\154\x6c\157\167\x69\156\x67\x20\x73\x79\155\142\157\x6c\163\40\x28\41\100\x23\56\x24\45\x5e\x26\52\x2d\137\x29\x20\163\x68\x6f\x75\x6c\x64\x20\x62\145\40\x70\162\x65\163\145\156\164\x2e");
        $this->mo_saml_show_error_message();
        return;
        pu:
        goto Le;
        AL:
        update_site_option("\x6d\157\x5f\163\141\155\x6c\137\x6d\x65\163\x73\x61\x67\145", "\x41\154\x6c\40\x74\150\145\40\x66\x69\145\154\x64\x73\x20\141\162\145\x20\162\x65\x71\165\151\162\x65\x64\56\40\120\154\145\x61\x73\x65\x20\x65\156\x74\x65\162\40\x76\x61\154\151\x64\x20\145\156\x74\162\151\x65\163\x2e");
        $this->mo_saml_show_error_message();
        return;
        Le:
        update_site_option("\155\157\137\163\141\x6d\x6c\137\141\x64\155\151\156\x5f\x65\155\x61\151\x6c", $QC);
        update_site_option("\x6d\157\x5f\x73\x61\x6d\x6c\137\x61\x64\155\x69\156\137\x70\x61\163\163\167\x6f\x72\x64", $qP);
        $ZX = new Customersaml();
        $Nd = $ZX->get_customer_key($this);
        if ($Nd) {
            goto H7;
        }
        return;
        H7:
        $aS = json_decode($Nd, true);
        if (json_last_error() == JSON_ERROR_NONE) {
            goto nJ;
        }
        update_site_option("\x6d\x6f\x5f\163\x61\155\154\137\x6d\145\x73\163\x61\x67\145", "\x49\x6e\x76\141\154\151\144\40\x75\163\145\162\156\141\x6d\x65\x20\x6f\162\x20\x70\x61\163\163\167\157\162\x64\56\x20\x50\154\145\141\163\x65\x20\164\162\171\x20\x61\x67\x61\x69\x6e\x2e");
        $this->mo_saml_show_error_message();
        goto l9;
        nJ:
        update_site_option("\155\x6f\137\163\141\x6d\x6c\137\x61\x64\155\x69\x6e\x5f\x63\x75\x73\x74\157\x6d\x65\162\137\153\145\x79", $aS["\151\x64"]);
        update_site_option("\155\157\137\x73\141\x6d\x6c\x5f\141\144\155\x69\x6e\137\141\x70\151\x5f\153\x65\x79", $aS["\141\x70\151\x4b\x65\x79"]);
        update_site_option("\155\x6f\x5f\x73\141\155\x6c\x5f\x63\x75\163\164\x6f\x6d\145\162\x5f\x74\157\153\145\x6e", $aS["\x74\157\x6b\x65\156"]);
        update_site_option("\x6d\157\x5f\x73\x61\x6d\x6c\x5f\x61\x64\155\x69\x6e\x5f\x70\x61\163\163\x77\157\x72\144", '');
        update_site_option("\x6d\157\137\163\141\x6d\154\x5f\x6d\145\x73\163\x61\x67\x65", "\103\165\x73\x74\x6f\155\x65\x72\x20\x72\x65\x74\x72\x69\145\x76\x65\144\40\163\x75\143\143\x65\x73\x73\146\x75\x6c\154\171");
        update_site_option("\x6d\x6f\137\163\x61\155\x6c\x5f\x72\145\x67\x69\163\x74\162\141\164\x69\x6f\156\x5f\163\x74\x61\x74\x75\x73", "\x45\170\151\163\164\x69\156\x67\x20\x55\x73\x65\162");
        delete_site_option("\x6d\157\x5f\x73\141\155\x6c\x5f\166\x65\162\x69\x66\x79\x5f\143\165\163\164\157\155\145\x72");
        if (get_site_option("\163\155\154\x5f\x6c\x6b")) {
            goto f7;
        }
        $this->mo_saml_show_success_message();
        goto V1;
        f7:
        $XC = get_site_option("\x6d\x6f\x5f\163\x61\155\154\137\x63\x75\x73\164\x6f\155\x65\x72\x5f\164\157\153\x65\156");
        $d3 = AESEncryption::decrypt_data(get_site_option("\163\155\x6c\137\x6c\x6b"), $XC);
        $Tz = add_query_arg(array("\x74\141\x62" => "\x6c\151\143\x65\156\x73\x69\156\147"), $_SERVER["\x52\x45\x51\x55\x45\x53\x54\137\x55\122\111"]);
        $H5 = $ZX->mo_saml_verify_license($d3, $this);
        if ($H5) {
            goto mI;
        }
        return;
        mI:
        $Nd = json_decode($H5, true);
        if (is_array($Nd) and strcasecmp($Nd["\163\164\x61\164\x75\x73"], "\123\x55\103\103\x45\123\123") == 0) {
            goto AZ;
        }
        update_site_option("\x6d\x6f\x5f\x73\141\155\x6c\137\155\x65\x73\163\x61\x67\145", "\114\x69\x63\145\x6e\x73\145\40\153\x65\x79\40\146\157\x72\40\x74\150\151\x73\40\151\156\163\164\141\156\143\145\40\151\x73\x20\151\156\143\x6f\x72\162\145\x63\164\56\40\115\141\153\x65\x20\163\165\162\145\x20\171\157\x75\x20\x68\141\166\x65\40\156\157\x74\x20\164\141\x6d\160\145\x72\x65\144\x20\167\151\164\x68\x20\151\x74\40\x61\164\40\141\x6c\154\x2e\x20\120\154\x65\141\x73\145\40\x65\156\164\145\162\x20\x61\40\x76\x61\154\151\x64\x20\x6c\x69\x63\145\156\163\x65\40\x6b\x65\171\x2e");
        delete_site_option("\x73\155\154\137\x6c\153");
        $this->mo_saml_show_error_message();
        goto iX;
        AZ:
        $this->mo_saml_show_success_message();
        iX:
        V1:
        l9:
        update_site_option("\155\157\x5f\x73\141\x6d\154\137\x61\144\155\x69\156\137\160\141\x73\x73\167\157\x72\144", '');
        AM:
        if (!get_site_option("\x6e\157\137\163\142\x73")) {
            goto Mm;
        }
        $XC = get_site_option("\155\x6f\x5f\x73\x61\x6d\154\x5f\143\x75\x73\x74\157\x6d\145\162\137\164\x6f\x6b\145\156");
        $Zy = AESEncryption::decrypt_data(get_site_option("\156\x6f\137\163\x62\x73"), $XC);
        $sD = count(Utilities::get_sites());
        if (!($Zy < $sD)) {
            goto lN;
        }
        if (get_site_option("\x6c\151\143\145\156\x73\145\137\141\x6c\145\x72\164\137\145\155\141\151\x6c\x5f\x73\x65\x6e\x74")) {
            goto gK;
        }
        $ZX = new Customersaml();
        $ZX->mo_saml_send_alert_email_for_license($Zy, $this);
        gK:
        lN:
        Mm:
        if (self::mo_check_option_admin_referer("\x6d\157\x5f\163\141\155\x6c\137\166\x65\x72\151\146\171\x5f\154\151\143\x65\156\x73\145")) {
            goto vG;
        }
        if (self::mo_check_option_admin_referer("\155\157\137\x73\x61\x6d\x6c\x5f\146\x72\145\x65\137\x74\162\x69\x61\154")) {
            goto Df;
        }
        if (!self::mo_check_option_admin_referer("\x6d\x6f\137\163\141\155\x6c\137\x63\150\145\143\x6b\x5f\154\x69\143\145\x6e\163\145")) {
            goto ix;
        }
        $ZX = new Customersaml();
        $H5 = $ZX->check_customer_ln($this);
        if ($H5) {
            goto jK;
        }
        return;
        jK:
        $Nd = json_decode($H5, true);
        if (strcasecmp($Nd["\x73\x74\x61\164\165\163"], "\x53\125\103\x43\x45\123\123") == 0) {
            goto V0;
        }
        $XC = get_site_option("\155\x6f\x5f\163\141\x6d\x6c\x5f\x63\165\163\164\x6f\x6d\x65\162\137\x74\x6f\x6b\x65\156");
        $Tz = add_query_arg(array("\x74\x61\142" => "\154\x69\143\x65\x6e\163\151\x6e\x67"), $_SERVER["\x52\x45\121\x55\x45\x53\x54\137\x55\x52\111"]);
        update_site_option("\x6d\157\x5f\x73\x61\155\x6c\137\155\145\163\163\x61\x67\145", "\x59\157\165\x20\150\141\x76\x65\40\156\157\164\x20\165\x70\x67\x72\141\x64\145\x64\40\x79\x65\164\x2e\40\x3c\141\40\x68\162\x65\x66\75\x22" . $Tz . "\42\x3e\x43\154\x69\x63\x6b\x20\x68\x65\x72\x65\x3c\57\x61\76\x20\164\x6f\40\165\x70\x67\x72\x61\x64\x65\40\164\x6f\40\x70\x72\145\x6d\151\165\155\40\166\x65\x72\x73\151\x6f\x6e\x2e");
        $this->mo_saml_show_error_message();
        goto L9;
        V0:
        if (!array_key_exists("\x69\163\x4d\165\x6c\164\x69\123\151\164\x65\x50\x6c\165\x67\x69\156\x52\x65\161\x75\x65\163\x74\x65\144", $Nd)) {
            goto pZ;
        }
        $Nt = $Nd["\151\x73\115\x75\154\164\151\x53\151\164\145\x50\x6c\x75\147\151\156\122\145\161\165\145\163\164\145\x64"];
        pZ:
        $sD = count(Utilities::get_sites());
        if ($Nt && array_key_exists("\156\157\x4f\x66\x53\x75\142\x53\x69\x74\x65\163", $Nd) && $sD <= $Nd["\x6e\x6f\x4f\x66\123\165\142\123\x69\x74\145\163"]) {
            goto R9;
        }
        $XC = get_site_option("\x6d\157\137\163\x61\x6d\154\x5f\143\165\163\164\157\x6d\145\162\137\164\x6f\153\145\x6e");
        if (empty($Ye)) {
            goto rh;
        }
        update_site_option("\x6e\157\137\x73\x62\x73", AESEncryption::encrypt_data($Ye, $XC));
        rh:
        update_site_option("\x73\x69\x74\145\x5f\x63\x6b\x5f\154", AESEncryption::encrypt_data("\146\x61\154\x73\x65", $XC));
        $Tz = add_query_arg(array("\164\141\142" => "\154\x69\143\x65\x6e\x73\x69\156\x67"), $_SERVER["\x52\105\x51\x55\105\x53\124\x5f\x55\x52\x49"]);
        update_site_option("\x6d\x6f\x5f\x73\x61\x6d\154\x5f\155\x65\x73\x73\141\x67\x65", "\x59\157\165\x20\x68\x61\166\x65\x20\156\157\164\x20\165\160\147\162\141\144\x65\x64\x20\x74\157\40\x74\150\145\x20\143\x6f\x72\x72\x65\143\164\40\x6c\x69\143\x65\156\163\145\x20\160\x6c\x61\x6e\x2e\40\x45\x69\164\x68\x65\162\x20\x79\x6f\x75\x20\x68\x61\x76\145\40\x70\165\162\143\150\x61\163\x65\144\40\x66\x6f\x72\40\151\x6e\143\x6f\x72\162\145\x63\164\x20\x6e\x6f\56\40\x6f\x66\x20\163\x69\x74\x65\163\40\157\162\40\x79\157\165\x20\x68\x61\x76\145\40\x6e\x6f\164\40\163\x65\154\x65\143\164\145\x64\x20\155\x75\154\x74\x69\163\151\x74\x65\x20\x6f\x70\164\151\x6f\156\x20\167\x68\x69\154\x65\40\160\x75\162\143\150\141\163\x69\156\147\56\x20\74\141\x20\x68\x72\145\146\75\42\x23\x22\x20\x6f\x6e\x63\154\x69\x63\153\75\42\147\145\164\165\x70\x67\162\x61\x64\x65\x6c\151\x63\145\156\163\x65\x73\x66\x6f\x72\x6d\50\x29\42\x3e\103\x6c\x69\x63\x6b\x20\150\x65\x72\x65\x3c\x2f\141\x3e\40\x74\157\x20\x75\x70\147\162\141\x64\x65\40\x74\x6f\x20\x70\162\145\x6d\151\165\x6d\40\x76\x65\162\163\151\157\x6e\x2e");
        $this->mo_saml_show_error_message();
        goto tb;
        R9:
        $XC = get_site_option("\x6d\x6f\137\163\x61\155\154\137\x63\x75\x73\164\x6f\155\x65\162\137\164\157\153\145\x6e");
        $Ye = $Nd["\x6e\157\x4f\x66\x53\165\142\123\151\x74\x65\163"];
        if (!(array_key_exists("\154\151\143\x65\156\163\x65\105\170\160\x69\x72\171", $Nd) && !$this->mo_saml_check_empty_or_null($Nd["\154\151\x63\145\156\x73\x65\x45\170\160\x69\162\171"]))) {
            goto IL;
        }
        $uY = $this->mo_saml_parse_expiry_date($Nd["\x6c\x69\143\145\156\163\x65\x45\x78\x70\x69\x72\171"]);
        update_site_option("\x6d\x6f\137\x73\141\x6d\x6c\x5f\154\x69\143\145\x6e\x73\145\137\x65\170\x70\x69\x72\x79\x5f\144\x61\164\x65", $uY);
        update_site_option("\155\x6f\137\x73\x61\155\x6c\x5f\163\x6c\x65", $this->is_license_expired($Nd["\x6c\x69\x63\x65\x6e\x73\145\x45\170\x70\x69\162\x79"]));
        IL:
        update_site_option("\x73\x69\x74\145\x5f\x63\x6b\x5f\x6c", AESEncryption::encrypt_data("\x74\x72\165\x65", $XC));
        update_site_option("\x6e\157\137\x73\x62\163", AESEncryption::encrypt_data($Ye, $XC));
        $Tz = add_query_arg(array("\164\x61\142" => "\154\157\147\x69\x6e"), $_SERVER["\x52\105\x51\125\x45\123\x54\137\125\x52\111"]);
        update_site_option("\155\x6f\x5f\x73\141\x6d\x6c\137\x6d\145\163\x73\x61\147\x65", "\131\157\x75\40\x68\141\166\x65\40\x73\x75\143\x63\x65\x73\x73\x66\x75\154\154\x79\40\x75\160\x67\162\x61\144\145\x64\x20\164\157\40\160\x72\x65\155\x69\165\155\x20\166\x65\162\x73\151\157\x6e\x2e");
        $this->mo_saml_show_success_message();
        tb:
        L9:
        ix:
        goto Gz;
        Df:
        if (decryptSamlElement()) {
            goto zw;
        }
        $d3 = postResponse();
        $ZX = new Customersaml();
        $H5 = $ZX->mo_saml_verify_license($d3, $this);
        $Nd = json_decode($H5, true);
        if (strcasecmp($Nd["\163\164\x61\164\165\x73"], "\x53\x55\x43\x43\x45\123\123") == 0) {
            goto dr;
        }
        if (strcasecmp($Nd["\x73\x74\x61\164\x75\163"], "\106\x41\111\x4c\105\104") == 0) {
            goto sP;
        }
        update_site_option("\x6d\x6f\x5f\163\141\x6d\154\x5f\x6d\145\163\x73\141\147\x65", "\x41\x6e\40\145\162\x72\157\x72\x20\157\143\143\165\162\145\x64\x20\167\150\x69\154\145\40\160\x72\157\x63\145\163\163\x69\156\x67\x20\x79\157\165\x72\40\x72\x65\161\x75\145\163\164\56\x20\x50\x6c\145\x61\x73\x65\x20\x54\x72\171\40\141\x67\x61\x69\x6e\56");
        $this->mo_saml_show_error_message();
        goto x_;
        sP:
        update_site_option("\155\x6f\x5f\163\141\x6d\154\x5f\155\145\x73\163\141\147\x65", "\124\150\145\162\145\40\x77\x61\163\40\141\x6e\x20\145\162\162\157\162\40\x61\143\x74\151\x76\141\164\151\156\x67\x20\x79\x6f\x75\x72\x20\x54\x52\111\x41\x4c\x20\x76\145\162\x73\151\157\156\x2e\40\x50\154\145\141\x73\x65\40\143\x6f\156\x74\141\143\164\x20\x69\x6e\146\157\x40\155\151\x6e\x69\x6f\x72\141\156\147\145\56\x63\x6f\155\x20\146\157\x72\40\x67\x65\x74\164\151\156\147\x20\156\x65\167\x20\154\x69\143\x65\x6e\x73\145\x20\x66\x6f\x72\x20\164\x72\151\141\154\x20\x76\x65\x72\x73\x69\157\156\x2e");
        $this->mo_saml_show_error_message();
        x_:
        goto A5;
        dr:
        $XC = get_site_option("\x6d\x6f\x5f\x73\141\155\x6c\x5f\143\x75\163\x74\157\155\145\162\137\x74\x6f\153\145\156");
        $XC = get_site_option("\155\157\137\163\141\155\x6c\137\143\x75\x73\x74\x6f\155\x65\x72\x5f\164\157\x6b\x65\x6e");
        update_site_option("\164\x5f\x73\151\x74\145\x5f\163\x74\141\164\165\x73", AESEncryption::encrypt_data("\164\162\165\145", $XC));
        update_site_option("\155\x6f\x5f\x73\x61\155\154\137\x6d\x65\x73\x73\141\147\x65", "\x59\x6f\x75\x72\x20\x35\40\x64\141\171\x73\40\x54\x52\x49\101\114\x20\151\163\x20\x61\x63\x74\151\166\141\164\x65\x64\x2e\40\131\157\165\x20\143\141\x6e\40\156\x6f\x77\x20\x73\145\164\165\160\x20\164\150\x65\x20\160\x6c\165\147\151\156\56");
        $this->mo_saml_show_success_message();
        A5:
        goto S2;
        zw:
        update_site_option("\155\x6f\137\163\141\155\x6c\x5f\155\145\x73\163\x61\147\x65", "\x54\150\x65\162\145\x20\x77\141\x73\40\x61\156\x20\x65\x72\162\157\162\x20\141\143\x74\x69\x76\x61\164\151\x6e\x67\40\x79\x6f\165\162\40\x54\122\x49\x41\x4c\x20\166\145\162\163\x69\x6f\156\x2e\x20\x45\x69\164\x68\145\x72\40\x79\157\165\x72\x20\x74\x72\151\141\154\x20\x70\x65\162\151\157\144\40\x69\x73\40\x65\170\x70\151\x72\145\144\40\x6f\x72\x20\x79\157\x75\40\x61\162\145\x20\x75\x73\x69\156\147\40\167\162\x6f\156\147\x20\164\162\151\141\x6c\x20\166\145\x72\x73\x69\157\156\x2e\40\120\154\145\x61\163\145\40\x63\x6f\156\x74\x61\x63\164\x20\151\156\146\157\x40\x6d\151\x6e\151\157\162\141\156\x67\x65\56\143\157\155\x20\146\157\162\40\147\x65\x74\164\151\156\147\x20\156\x65\167\x20\154\x69\x63\x65\156\163\x65\40\x66\157\x72\40\164\x72\151\x61\154\40\166\145\162\163\x69\157\156\56");
        $this->mo_saml_show_error_message();
        S2:
        Gz:
        goto tM;
        vG:
        if (!$this->mo_saml_check_empty_or_null($_POST["\x73\141\x6d\x6c\137\154\x69\x63\x65\156\x73\145\137\153\145\x79"])) {
            goto xF;
        }
        update_site_option("\155\x6f\137\x73\141\x6d\154\x5f\x6d\145\163\x73\141\147\145", "\x41\x6c\154\40\164\x68\145\x20\146\x69\x65\x6c\144\163\x20\x61\162\x65\x20\162\145\x71\165\x69\x72\x65\144\56\x20\x50\154\x65\x61\163\145\x20\x65\156\164\145\162\40\166\141\154\x69\x64\x20\x6c\151\x63\145\x6e\x73\x65\x20\153\145\x79\x2e");
        $this->mo_saml_show_error_message();
        return;
        xF:
        $d3 = trim($_POST["\x73\x61\155\154\137\x6c\x69\x63\x65\x6e\163\x65\137\153\x65\x79"]);
        $ZX = new Customersaml();
        $H5 = $ZX->check_customer_ln($this);
        if ($H5) {
            goto no;
        }
        return;
        no:
        $Nd = json_decode($H5, true);
        $Tz = add_query_arg(array("\164\x61\x62" => "\x6c\x69\x63\145\156\x73\151\156\x67"), $_SERVER["\122\105\x51\x55\105\x53\124\137\x55\122\x49"]);
        if (strcasecmp($Nd["\x73\164\x61\164\x75\163"], "\x53\x55\103\103\105\123\123") == 0) {
            goto CN;
        }
        $XC = get_site_option("\155\x6f\137\163\141\155\x6c\137\x63\x75\x73\x74\157\x6d\145\162\x5f\x74\x6f\153\145\x6e");
        $Tz = add_query_arg(array("\164\141\x62" => "\x6c\151\x63\x65\x6e\163\151\156\x67"), $_SERVER["\122\x45\x51\125\105\x53\x54\x5f\x55\x52\x49"]);
        update_site_option("\155\157\137\x73\141\155\x6c\x5f\x6d\145\163\163\x61\x67\x65", "\131\157\x75\x20\x68\x61\x76\145\40\x6e\x6f\164\x20\165\160\x67\x72\141\x64\145\144\40\x79\145\x74\56\x20\74\141\40\x68\x72\145\146\x3d\x22" . $Tz . "\x22\x3e\x43\x6c\x69\x63\153\40\x68\x65\162\x65\74\x2f\141\x3e\x20\x74\157\x20\x75\160\147\x72\141\x64\145\x20\164\x6f\x20\160\x72\x65\x6d\x69\165\155\x20\166\x65\162\x73\151\x6f\x6e\x2e");
        $this->mo_saml_show_error_message();
        goto Wc;
        CN:
        if (!array_key_exists("\151\x73\115\165\x6c\164\x69\123\x69\164\x65\x50\x6c\x75\x67\x69\x6e\122\145\x71\x75\145\163\164\145\144", $Nd)) {
            goto le;
        }
        $Nt = $Nd["\151\163\x4d\x75\154\x74\151\123\151\164\x65\x50\154\165\x67\x69\156\122\x65\161\165\145\163\x74\x65\x64"];
        le:
        $sD = count(Utilities::get_sites());
        if ($Nt && array_key_exists("\x6e\x6f\x4f\146\123\x75\142\x53\151\x74\x65\x73", $Nd) && $sD <= $Nd["\x6e\157\x4f\146\x53\x75\x62\123\x69\x74\x65\163"]) {
            goto Rg;
        }
        $Zy = $Nd["\156\x6f\117\146\123\x75\x62\x53\x69\164\145\163"];
        $XC = get_site_option("\x6d\157\x5f\x73\x61\155\154\x5f\x63\165\163\x74\157\155\x65\162\137\x74\157\153\x65\x6e");
        update_site_option("\x6e\157\137\163\142\x73", AESEncryption::encrypt_data($Zy, $XC));
        update_site_option("\x73\155\x6c\137\154\153", AESEncryption::encrypt_data($d3, $XC));
        update_site_option("\163\x69\164\145\137\x63\x6b\137\x6c", AESEncryption::encrypt_data("\x74\x72\165\145", $XC));
        update_site_option("\155\x6f\x5f\x73\x61\x6d\x6c\x5f\x6d\x65\163\163\x61\147\145", "\131\x6f\165\x20\150\x61\166\x65\40\160\165\x72\x63\x68\x61\163\145\x64\x20\164\x68\145\40\x6c\151\x63\x65\156\x73\145\40\146\157\x72\x20\x3c\x62\76" . $Nd["\156\157\x4f\x66\123\x75\x62\x53\x69\164\x65\163"] . "\40\163\151\x74\145\163\x3c\57\x62\76\56\40\102\x75\164\40\171\x6f\x75\x20\x68\x61\x76\145\40\74\142\x3e" . $sD . "\x20\x3c\x2f\142\x3e\x73\151\x74\x65\163\x20\151\x6e\40\x79\157\165\162\x20\155\165\x6c\x74\151\x73\x69\164\x65\40\x6e\x65\x74\x77\157\x72\153\56\40\74\x61\40\x68\x72\145\146\x3d\42\43\42\40\157\156\143\x6c\151\x63\153\x3d\42\147\145\x74\x75\x70\x67\x72\x61\x64\145\x6c\151\143\x65\x6e\163\x65\163\x66\x6f\x72\x6d\x28\x29\42\x3e\103\x6c\x69\x63\153\x20\x68\x65\162\145\x3c\x2f\x61\76\40\x74\x6f\40\142\x75\x79\x20\154\151\143\x65\x6e\x73\145\40\x66\x6f\162\x20\155\157\162\145\x20\163\151\x74\x65\163\56");
        $this->mo_saml_show_error_message();
        goto Si;
        Rg:
        $Zy = $Nd["\156\x6f\x4f\x66\x53\x75\142\123\x69\x74\145\x73"];
        $XC = get_site_option("\155\157\x5f\163\x61\x6d\x6c\137\143\x75\x73\164\x6f\155\x65\x72\x5f\164\x6f\153\x65\x6e");
        if (!array_key_exists("\x6e\157\x4f\146\x55\x73\145\162\x73", $Nd)) {
            goto lr;
        }
        $Du = $Nd["\156\x6f\117\x66\125\x73\x65\162\x73"];
        lr:
        $H5 = $ZX->mo_saml_verify_license($d3, $this);
        if ($H5) {
            goto cN;
        }
        return;
        cN:
        $Nd = json_decode($H5, true);
        if (strcasecmp($Nd["\x73\x74\141\164\x75\163"], "\x53\x55\x43\103\x45\123\123") == 0) {
            goto wM;
        }
        if (strcasecmp($Nd["\x73\x74\141\164\x75\163"], "\x46\101\111\114\105\104") == 0) {
            goto Mr;
        }
        update_site_option("\x6d\157\137\x73\x61\155\154\x5f\x6d\x65\x73\x73\x61\147\x65", "\x41\x6e\40\145\x72\x72\157\x72\x20\157\143\143\x75\x72\x65\144\x20\x77\150\x69\x6c\x65\x20\x70\162\x6f\x63\x65\x73\x73\151\x6e\147\40\x79\157\165\162\40\x72\x65\x71\165\x65\x73\164\56\x20\x50\154\145\141\163\x65\40\124\x72\171\40\141\x67\141\151\x6e\x2e");
        $this->mo_saml_show_error_message();
        goto ma;
        Mr:
        if (strcasecmp($Nd["\155\145\x73\163\x61\x67\x65"], "\x43\157\144\x65\40\150\141\163\x20\x45\x78\x70\x69\162\145\x64") == 0) {
            goto Lq;
        }
        update_site_option("\155\157\x5f\163\x61\155\154\137\155\x65\163\163\x61\x67\x65", "\x59\157\x75\40\150\x61\166\x65\40\145\156\164\145\x72\145\x64\x20\x61\156\40\151\x6e\166\x61\x6c\151\x64\x20\x6c\x69\143\145\156\163\x65\40\153\145\x79\56\x20\x50\154\145\x61\163\x65\x20\145\x6e\x74\x65\x72\40\141\x20\166\x61\154\x69\144\x20\154\x69\143\145\156\163\145\40\x6b\145\x79\x2e");
        goto wY;
        Lq:
        update_site_option("\155\x6f\x5f\x73\x61\x6d\x6c\x5f\155\145\163\163\141\x67\145", "\x4c\x69\143\145\x6e\163\145\x20\153\145\171\x20\x79\x6f\165\40\x68\141\x76\145\x20\145\156\164\x65\162\145\144\x20\150\x61\163\40\x61\x6c\x72\x65\141\144\171\40\x62\x65\x65\x6e\40\165\163\x65\144\x2e\x20\x50\154\145\x61\163\145\x20\x65\x6e\x74\x65\162\x20\x61\x20\153\145\171\x20\167\x68\x69\143\150\40\150\141\163\x20\156\157\164\40\142\x65\145\x6e\40\x75\x73\145\x64\x20\x62\x65\x66\x6f\162\145\40\x6f\x6e\x20\x61\156\x79\40\x6f\x74\150\x65\162\40\151\156\x73\164\x61\156\143\145\40\157\x72\40\151\146\40\x79\157\165\x20\150\x61\166\x65\40\145\x78\141\165\x73\x74\x65\144\40\141\154\x6c\x20\171\x6f\165\x72\x20\153\145\171\x73\x20\x74\x68\145\x6e\x20\x3c\x61\40\150\x72\145\x66\75\42\43\42\x20\x6f\x6e\143\154\151\143\153\75\x22\x67\145\164\x75\x70\x67\x72\x61\x64\145\154\151\143\145\x6e\163\x65\x73\146\157\162\155\50\51\42\x20\76\x43\154\x69\x63\153\x20\x68\x65\162\145\x3c\x2f\141\x3e\40\164\157\x20\x62\165\171\x20\x6d\157\x72\x65\x2e");
        wY:
        $this->mo_saml_show_error_message();
        ma:
        goto PO;
        wM:
        if (!array_key_exists("\156\157\117\x66\125\x73\x65\162\x73", $Nd)) {
            goto qu;
        }
        update_site_option("\x6d\x6f\x5f\x73\x61\x6d\154\137\x75\x73\162\137\x6c\155\x74", AESEncryption::encrypt_data($Du, $XC));
        qu:
        update_site_option("\163\x6d\154\137\x6c\153", AESEncryption::encrypt_data($d3, $XC));
        update_site_option("\156\x6f\x5f\x73\142\x73", AESEncryption::encrypt_data($Zy, $XC));
        update_site_option("\163\x69\x74\145\x5f\x63\153\137\154", AESEncryption::encrypt_data("\x74\162\165\x65", $XC));
        update_site_option("\x74\x5f\163\x69\164\x65\x5f\x73\x74\x61\x74\x75\x73", AESEncryption::encrypt_data("\146\141\154\163\145", $XC));
        update_site_option("\155\157\x5f\x73\141\155\x6c\137\155\x65\163\x73\141\x67\x65", "\131\157\165\162\40\x6c\x69\143\x65\156\163\145\40\x69\163\40\x76\x65\x72\x69\146\151\145\144\56\40\x59\x6f\165\x20\x63\141\156\40\156\x6f\167\40\x73\145\x74\165\160\x20\x74\x68\x65\x20\160\154\x75\147\151\156\56");
        $XC = get_site_option("\155\157\x5f\163\x61\x6d\x6c\137\143\x75\x73\164\157\x6d\145\x72\x5f\x74\157\153\145\x6e");
        update_site_option("\164\137\163\151\x74\145\x5f\x73\164\x61\164\x75\x73", AESEncryption::encrypt_data("\x66\141\154\163\145", $XC));
        $this->mo_saml_show_success_message();
        PO:
        Si:
        Wc:
        tM:
        if (!(isset($_REQUEST["\x75\x70\144\141\164\x65"]) && "\141\144\x64\145\x64" == $_REQUEST["\x75\x70\144\x61\x74\x65"] && get_site_option("\155\157\x5f\163\x61\155\x6c\137\x65\156\141\142\154\x65\x5f\x73\163\x6f\x5f\x6e\145\x77\137\x73\151\x74\145") == "\x74\162\x75\x65")) {
            goto zi;
        }
        $AL = isset($_REQUEST["\142\154\157\x67\x5b\x64\157\x6d\x61\x69\x6e\x5d"]) ? $_REQUEST["\x62\x6c\x6f\x67\x5b\144\157\x6d\141\151\156\135"] : '';
        if (!isset($_REQUEST["\151\x64"])) {
            goto bN;
        }
        $ht = $_REQUEST["\151\144"];
        bN:
        if (empty($ht)) {
            goto mg;
        }
        $D7 = Utilities::get_active_sites();
        if (in_array($ht, $D7)) {
            goto BT;
        }
        array_push($D7, $ht);
        BT:
        update_site_option("\x6d\157\137\x65\156\x61\142\154\x65\137\163\x73\x6f\137\x73\151\x74\145\x73", $D7);
        mg:
        zi:
        hV:
        if (mo_saml_is_trial_active()) {
            goto n7;
        }
        if (!site_check()) {
            goto cY;
        }
        goto pr;
        n7:
        if (!decryptSamlElement()) {
            goto cZ;
        }
        $XC = get_site_option("\x6d\x6f\x5f\x73\141\155\x6c\137\x63\165\163\x74\x6f\x6d\145\162\137\164\157\153\145\156");
        update_site_option("\164\x5f\163\151\x74\x65\137\x73\164\141\x74\x75\x73", AESEncryption::encrypt_data("\x66\x61\x6c\x73\x65", $XC));
        cZ:
        goto pr;
        cY:
        delete_site_option("\x6d\157\x5f\x73\x61\x6d\x6c\x5f\x65\156\x61\142\x6c\145\137\154\157\147\151\x6e\137\x72\145\x64\x69\x72\x65\143\x74");
        delete_site_option("\155\157\x5f\163\141\x6d\x6c\137\x61\154\154\157\167\137\x77\x70\x5f\163\151\147\156\151\156");
        delete_site_option("\155\x6f\x5f\x73\x61\155\x6c\x5f\x72\145\147\x69\163\x74\145\x72\145\144\137\157\156\154\x79\x5f\x61\x63\x63\145\163\x73");
        delete_site_option("\x6d\x6f\x5f\x73\x61\x6d\x6c\137\x66\157\162\x63\x65\x5f\x61\x75\164\x68\x65\x6e\x74\x69\143\x61\x74\151\x6f\x6e");
        pr:
    }
    function create_customer()
    {
        $ZX = new CustomerSaml();
        $aS = json_decode($ZX->create_customer($this), true);
        if (strcasecmp($aS["\x73\x74\x61\x74\165\x73"], "\x43\x55\x53\x54\x4f\x4d\105\122\x5f\125\x53\105\x52\116\101\115\105\137\101\114\x52\x45\x41\104\x59\x5f\105\130\x49\123\x54\123") == 0) {
            goto jG;
        }
        if (!(strcasecmp($aS["\x73\164\x61\x74\x75\x73"], "\x53\125\x43\103\x45\123\x53") == 0)) {
            goto GS;
        }
        update_site_option("\x6d\x6f\137\x73\141\155\x6c\x5f\x61\x64\155\151\x6e\x5f\143\165\163\x74\157\155\145\x72\137\153\x65\171", $aS["\x69\x64"]);
        update_site_option("\x6d\157\x5f\x73\x61\x6d\154\137\141\144\155\x69\x6e\x5f\x61\x70\x69\137\153\145\171", $aS["\141\x70\151\x4b\145\171"]);
        update_site_option("\x6d\157\137\x73\141\155\x6c\137\x63\165\x73\164\x6f\x6d\x65\162\137\x74\x6f\153\145\156", $aS["\164\x6f\153\145\x6e"]);
        update_site_option("\155\x6f\137\x73\141\x6d\154\137\x61\144\x6d\x69\156\x5f\x70\141\163\163\x77\157\x72\x64", '');
        update_site_option("\x6d\x6f\137\x73\141\155\154\137\155\x65\x73\163\141\147\x65", "\124\x68\141\x6e\x6b\x20\x79\157\x75\x20\146\157\162\x20\x72\x65\x67\x69\x73\x74\145\162\x69\156\x67\x20\167\x69\164\150\x20\155\151\x6e\151\157\x72\x61\x6e\x67\145\x2e");
        update_site_option("\155\157\x5f\163\141\155\154\x5f\x72\145\x67\151\163\x74\162\141\x74\151\157\x6e\x5f\163\164\x61\164\x75\x73", '');
        delete_site_option("\155\x6f\x5f\x73\141\155\154\137\x76\x65\162\151\146\171\x5f\x63\165\163\164\157\x6d\x65\162");
        delete_site_option("\x6d\157\x5f\x73\141\155\x6c\137\x6e\145\x77\137\162\145\x67\x69\163\x74\x72\x61\x74\151\157\x6e");
        $this->mo_saml_show_success_message();
        GS:
        goto bG;
        jG:
        $this->get_current_customer();
        bG:
        update_site_option("\155\x6f\137\163\x61\155\154\x5f\141\x64\x6d\151\x6e\137\x70\141\x73\x73\x77\x6f\x72\x64", '');
    }
    function get_current_customer()
    {
        $ZX = new CustomerSaml();
        $Nd = $ZX->get_customer_key($this);
        if ($Nd) {
            goto Se;
        }
        return;
        Se:
        $aS = json_decode($Nd, true);
        if (json_last_error() == JSON_ERROR_NONE) {
            goto pk;
        }
        update_site_option("\155\x6f\x5f\163\141\x6d\x6c\137\x6d\145\x73\163\x61\147\145", "\x59\157\165\40\141\x6c\x72\145\141\144\171\x20\x68\x61\x76\x65\40\x61\156\x20\141\x63\143\157\x75\156\x74\40\167\151\164\150\x20\155\x69\x6e\x69\x4f\162\x61\156\147\x65\x2e\x20\x50\x6c\x65\141\x73\145\40\x65\x6e\x74\145\x72\40\x61\x20\x76\141\154\151\144\40\160\141\163\163\167\157\162\x64\56");
        update_site_option("\155\x6f\x5f\163\x61\x6d\x6c\x5f\x76\145\x72\x69\146\x79\x5f\143\x75\163\x74\157\155\x65\162", "\x74\162\165\x65");
        delete_site_option("\155\x6f\x5f\163\x61\155\x6c\x5f\x6e\x65\167\137\x72\x65\147\x69\x73\164\162\141\x74\x69\157\x6e");
        $this->mo_saml_show_error_message();
        goto Vt;
        pk:
        update_site_option("\155\157\137\163\x61\x6d\154\x5f\141\144\155\151\156\137\x63\165\x73\x74\x6f\155\145\162\x5f\x6b\x65\171", $aS["\x69\144"]);
        update_site_option("\155\157\137\163\x61\x6d\154\137\x61\144\155\151\156\x5f\141\x70\x69\137\153\x65\x79", $aS["\141\160\151\x4b\145\x79"]);
        update_site_option("\155\x6f\x5f\x73\141\x6d\154\137\x63\x75\x73\x74\157\x6d\x65\162\x5f\164\x6f\153\x65\x6e", $aS["\x74\157\x6b\145\x6e"]);
        update_site_option("\x6d\x6f\x5f\163\x61\155\154\137\x61\144\x6d\x69\x6e\x5f\160\141\163\x73\167\157\162\x64", '');
        update_site_option("\155\157\x5f\163\x61\x6d\x6c\137\x6d\145\x73\x73\x61\x67\x65", "\x59\157\x75\x72\40\x61\143\x63\x6f\165\156\x74\40\150\141\163\40\142\x65\145\x6e\40\162\145\x74\x72\151\x65\166\x65\x64\x20\163\165\x63\143\145\x73\163\146\165\x6c\x6c\171\56");
        delete_site_option("\155\157\137\163\x61\x6d\154\x5f\166\145\162\x69\x66\171\x5f\143\x75\163\x74\x6f\x6d\145\162");
        delete_site_option("\155\x6f\137\x73\x61\x6d\x6c\x5f\x6e\145\x77\137\x72\145\147\x69\163\164\x72\141\x74\x69\157\x6e");
        $this->mo_saml_show_success_message();
        Vt:
    }
    public function mo_saml_check_empty_or_null($wE)
    {
        if (!(!isset($wE) || empty($wE))) {
            goto gw;
        }
        return true;
        gw:
        return false;
    }
    function miniorange_sso_menu()
    {
        $Ld = add_menu_page("\115\x4f\x20\x53\x41\x4d\114\x20\123\145\x74\x74\151\156\x67\x73\40" . __("\x43\157\x6e\146\151\x67\x75\162\x65\40\x53\x41\x4d\x4c\40\x49\x64\x65\x6e\164\x69\x74\171\x20\120\x72\157\166\x69\144\x65\162\x20\x66\x6f\162\x20\123\x53\117", "\155\157\x5f\163\141\155\x6c\x5f\x73\145\x74\x74\x69\x6e\x67\x73"), "\155\151\x6e\151\x4f\162\x61\156\x67\145\40\123\x41\x4d\114\x20\62\56\x30\x20\123\123\x4f", "\141\x64\155\x69\156\x69\x73\x74\162\141\x74\x6f\162", "\155\157\x5f\163\141\155\154\137\163\x65\x74\x74\x69\156\x67\x73", array($this, "\155\x6f\x5f\154\x6f\x67\151\x6e\x5f\167\x69\x64\147\145\164\137\163\141\x6d\x6c\137\x6f\160\164\151\x6f\156\163"), plugin_dir_url(__FILE__) . "\x69\155\141\147\145\x73\x2f\155\151\156\x69\x6f\162\x61\x6e\x67\145\56\x70\156\x67");
        if (!mo_saml_is_customer_license_key_verified()) {
            goto EO;
        }
        add_submenu_page("\x6d\x6f\137\163\x61\x6d\154\x5f\163\145\164\x74\151\x6e\x67\163", "\155\x69\x6e\x69\x4f\162\141\x6e\x67\x65\x20\123\x41\115\114\x20\62\x2e\60\x20\x53\x53\x4f", __("\74\144\151\166\40\x69\144\75\42\155\157\137\163\x61\155\x6c\x5f\141\144\144\x6f\x6e\163\137\x73\x75\142\155\x65\x6e\165\42\x3e\101\x64\144\55\x4f\156\163\x3c\x2f\x64\151\x76\76", "\155\151\156\x69\157\x72\x61\156\147\x65\55\163\x61\x6d\154\55\x32\x30\55\163\x69\x6e\147\x6c\145\55\x73\x69\x67\156\55\x6f\156"), "\155\x61\x6e\141\x67\x65\x5f\157\160\x74\x69\157\x6e\x73", "\155\157\x5f\x73\141\155\154\137\x73\145\x74\164\151\156\x67\163\x26\x74\141\142\75\141\x64\x64\x2d\157\x6e\163", array($this, "\x6d\x6f\x5f\x6c\157\x67\151\x6e\137\x77\151\x64\x67\x65\x74\x5f\x73\x61\155\x6c\x5f\x6f\x70\x74\151\157\x6e\x73"));
        EO:
    }
    function mo_saml_redirect_for_authentication($tR)
    {
        if (!mo_saml_is_customer_license_key_verified()) {
            goto q4;
        }
        $sT = maybe_unserialize(get_site_option("\163\141\x6d\154\x5f\163\x73\157\x5f\163\x65\x74\164\151\x6e\x67\163"));
        $bO = Utilities::get_active_sites();
        $LQ = get_current_blog_id();
        if (in_array($LQ, $bO)) {
            goto oI;
        }
        return;
        oI:
        if (!(empty($sT[$LQ]) && !empty($sT["\x44\x45\x46\101\x55\114\x54"]))) {
            goto WF;
        }
        $sT[$LQ] = $sT["\x44\105\x46\x41\125\114\124"];
        WF:
        if (isset($sT[$LQ]["\x6d\x6f\x5f\x73\141\155\x6c\137\162\145\147\151\x73\164\145\x72\145\x64\x5f\157\156\x6c\x79\137\x61\x63\143\145\163\x73"]) && $sT[$LQ]["\155\157\137\163\x61\x6d\x6c\x5f\x72\x65\147\151\x73\164\x65\x72\145\144\137\x6f\156\154\171\137\141\x63\x63\145\163\163"] == "\x74\162\x75\145" || isset($sT[$LQ]["\x6d\x6f\x5f\x73\x61\155\x6c\137\145\156\x61\x62\x6c\145\137\154\157\x67\151\x6e\x5f\162\145\144\x69\x72\145\143\x74"]) && $sT[$LQ]["\155\157\137\163\141\155\154\x5f\145\156\x61\x62\x6c\145\137\154\157\x67\x69\156\x5f\x72\145\144\151\162\145\x63\164"] == "\x74\x72\x75\x65") {
            goto vT;
        }
        if (!(isset($sT[$LQ]["\155\157\137\163\141\x6d\x6c\137\162\x65\144\151\x72\145\143\164\x5f\x74\x6f\x5f\x77\x70\x5f\154\x6f\147\151\x6e"]) and $sT[$LQ]["\155\157\137\163\141\155\154\x5f\x72\x65\144\x69\x72\x65\x63\164\137\x74\x6f\137\x77\160\137\154\157\147\x69\156"] == "\x74\x72\x75\x65")) {
            goto UM;
        }
        if (!(mo_saml_is_sp_configured() && !is_user_logged_in())) {
            goto mP;
        }
        $Tz = get_site_url($LQ) . "\57\x77\x70\55\x6c\157\147\151\156\56\x70\150\160";
        if (empty($tR)) {
            goto UF;
        }
        $Tz = $Tz . "\77\162\x65\144\151\x72\145\x63\x74\137\x74\x6f\75" . urlencode($tR) . "\x26\x72\145\141\165\164\150\75\x31";
        UF:
        header("\x4c\157\x63\141\164\x69\157\x6e\72\x20" . $Tz);
        exit;
        mP:
        UM:
        goto s9;
        vT:
        if (!(mo_saml_is_sp_configured() && !is_user_logged_in())) {
            goto Da;
        }
        $ia = get_site_option("\x6d\x6f\x5f\163\x61\155\154\137\x73\x70\x5f\x62\x61\x73\x65\x5f\x75\162\x6c");
        if (!empty($ia)) {
            goto am;
        }
        $ia = get_network_site_url();
        am:
        if (empty($sT[$LQ]["\155\157\x5f\163\141\x6d\154\137\162\x65\154\141\171\137\163\x74\x61\x74\145"])) {
            goto wL;
        }
        $tR = $sT[$LQ]["\155\157\137\x73\141\x6d\154\137\162\x65\154\141\x79\x5f\163\x74\x61\x74\145"];
        wL:
        $Io = $tR;
        $ZB = get_site_option("\x73\x61\x6d\154\x5f\154\157\147\x69\x6e\x5f\165\x72\x6c");
        $cS = !empty(get_site_option("\x73\141\x6d\154\x5f\154\157\147\x69\x6e\x5f\x62\151\156\144\x69\156\147\137\164\171\160\145")) ? get_site_option("\x73\141\x6d\154\x5f\154\x6f\x67\151\156\x5f\142\x69\156\x64\x69\156\147\137\x74\x79\160\145") : "\110\x74\x74\160\120\157\x73\x74";
        $sT = maybe_unserialize(get_site_option("\163\141\155\x6c\x5f\163\163\157\137\x73\145\x74\x74\151\x6e\x67\x73"));
        $LQ = get_current_blog_id();
        if (!(empty($sT[$LQ]) && !empty($sT["\x44\x45\106\x41\125\x4c\x54"]))) {
            goto Of;
        }
        $sT[$LQ] = $sT["\104\x45\106\101\125\114\124"];
        Of:
        if (isset($sT[$LQ]["\155\x6f\x5f\163\141\x6d\154\137\x66\157\162\143\145\x5f\141\165\x74\150\x65\x6e\x74\x69\143\x61\164\x69\x6f\156"])) {
            goto oQ;
        }
        $ny = '';
        goto G7;
        oQ:
        $ny = $sT[$LQ]["\155\157\137\x73\141\x6d\x6c\137\146\x6f\x72\143\x65\x5f\x61\165\x74\x68\x65\156\x74\151\x63\141\164\x69\157\156"];
        G7:
        $lZ = $ia . "\x2f";
        $P6 = get_site_option("\155\x6f\137\x73\x61\x6d\x6c\x5f\x73\x70\137\145\x6e\x74\151\x74\x79\137\x69\x64");
        $L3 = get_site_option("\163\x61\x6d\154\x5f\156\141\155\x65\151\x64\x5f\146\x6f\162\x6d\x61\164");
        if (!empty($L3)) {
            goto qJ;
        }
        $L3 = "\61\56\x31\72\x6e\141\x6d\145\x69\144\x2d\x66\x6f\x72\x6d\141\164\72\x75\156\x73\160\145\x63\x69\x66\151\x65\144";
        qJ:
        if (!empty($P6)) {
            goto gA;
        }
        $P6 = $ia . "\x2f\167\x70\55\x63\x6f\x6e\x74\x65\156\164\x2f\160\x6c\x75\147\x69\156\x73\x2f\x6d\151\156\x69\x6f\162\x61\x6e\147\x65\55\163\x61\x6d\x6c\x2d\62\60\55\163\151\156\x67\x6c\x65\x2d\163\x69\147\156\55\157\156\57";
        gA:
        $Da = Utilities::createAuthnRequest($lZ, $P6, $ZB, $ny, $cS, $L3);
        $Io = mo_saml_relaystate_url($Io);
        if ($cS == "\x48\x74\164\x70\122\x65\x64\151\162\x65\143\x74") {
            goto g9;
        }
        if (!(get_site_option("\x73\141\155\154\137\x72\x65\x71\x75\145\x73\x74\x5f\163\x69\147\156\145\144") == "\x75\x6e\x63\x68\x65\143\x6b\145\x64")) {
            goto vm;
        }
        $mW = base64_encode($Da);
        Utilities::postSAMLRequest($ZB, $mW, $Io);
        exit;
        vm:
        $js = '';
        $Z2 = '';
        $mW = Utilities::signXML($Da, "\x4e\x61\155\145\111\104\120\157\154\151\143\x79");
        Utilities::postSAMLRequest($ZB, $mW, $Io);
        goto MN;
        g9:
        $YR = htmlspecialchars_decode($ZB);
        if (strpos($ZB, "\x3f") !== false) {
            goto Xf;
        }
        $YR .= "\x3f";
        goto s7;
        Xf:
        $YR .= "\x26";
        s7:
        if (!(get_site_option("\x73\x61\155\x6c\137\162\145\161\165\145\x73\x74\x5f\163\x69\x67\156\145\144") == "\x75\156\x63\x68\145\143\x6b\x65\144")) {
            goto wX;
        }
        $YR .= "\123\101\115\x4c\122\145\161\165\145\x73\x74\x3d" . $Da . "\x26\x52\x65\x6c\x61\x79\x53\164\141\x74\145\75" . urlencode($Io);
        header("\114\157\143\x61\164\151\157\156\x3a\x20" . $YR);
        exit;
        wX:
        $Da = "\x53\x41\115\114\x52\145\x71\x75\x65\x73\x74\x3d" . $Da . "\46\122\145\x6c\141\x79\123\x74\141\164\145\75" . urlencode($Io) . "\46\x53\x69\x67\101\x6c\147\75" . urlencode(XMLSecurityKey::RSA_SHA256);
        $Es = array("\164\171\x70\x65" => "\x70\162\x69\166\141\164\x65");
        $XC = new XMLSecurityKey(XMLSecurityKey::RSA_SHA256, $Es);
        $Ge = get_site_option("\155\x6f\137\163\x61\155\x6c\x5f\x63\165\162\162\x65\x6e\164\x5f\143\x65\x72\x74\137\160\162\151\166\141\x74\145\x5f\x6b\x65\x79");
        $XC->loadKey($Ge, FALSE);
        $p0 = new XMLSecurityDSig();
        $l8 = $XC->signData($Da);
        $l8 = base64_encode($l8);
        $YR .= $Da . "\46\x53\151\x67\x6e\x61\x74\165\162\x65\x3d" . urlencode($l8);
        header("\114\x6f\x63\141\x74\151\x6f\x6e\72\x20" . $YR);
        exit;
        MN:
        Da:
        s9:
        q4:
    }
    function mo_saml_authenticate()
    {
        $dh = '';
        if (!isset($_REQUEST["\162\145\x64\x69\x72\x65\x63\164\x5f\x74\157"])) {
            goto Q6;
        }
        $dh = $_REQUEST["\x72\x65\144\151\162\145\143\164\137\164\157"];
        Q6:
        if (!is_user_logged_in()) {
            goto aw;
        }
        if (!empty($dh)) {
            goto LH;
        }
        $Tz = saml_get_current_page_url();
        if (!(strpos($Tz, "\x77\x70\55\154\157\x67\x69\156\x2e\160\150\160") !== false)) {
            goto Vb;
        }
        $Tz = str_replace("\167\x70\55\154\157\x67\x69\x6e\x2e\160\x68\160", '', $Tz);
        if (!filter_var($Tz, FILTER_VALIDATE_URL)) {
            goto WY;
        }
        header("\114\x6f\143\x61\164\151\x6f\156\x3a\x20" . $Tz);
        exit;
        WY:
        Vb:
        goto La;
        LH:
        header("\114\x6f\143\x61\164\x69\157\x6e\x3a\x20" . $dh);
        exit;
        La:
        aw:
        global $blog_id;
        $sT = maybe_unserialize(get_site_option("\x73\x61\155\x6c\x5f\163\x73\157\x5f\163\145\164\x74\x69\156\147\163"));
        $LQ = get_current_blog_id();
        $bO = Utilities::get_active_sites();
        if (in_array($LQ, $bO)) {
            goto e2;
        }
        return;
        e2:
        if (!(empty($sT[$LQ]) && !empty($sT["\104\105\106\101\125\114\x54"]))) {
            goto iT;
        }
        $sT[$LQ] = $sT["\104\x45\x46\101\125\x4c\124"];
        iT:
        if (!(isset($sT[$LQ]["\x6d\157\x5f\x73\141\155\x6c\x5f\145\156\141\142\154\x65\x5f\154\157\x67\151\x6e\137\x72\145\x64\x69\162\145\x63\164"]) and $sT[$LQ]["\x6d\157\137\163\141\155\154\137\x65\x6e\141\142\x6c\145\x5f\x6c\157\147\151\x6e\x5f\162\x65\144\x69\162\x65\143\x74"] == "\x74\x72\165\x65")) {
            goto g8;
        }
        $v_ = isset($sT[$LQ]["\155\x6f\137\163\141\155\154\x5f\x62\x61\143\x6b\x64\x6f\157\162\137\x75\162\154"]) ? trim($sT[$LQ]["\x6d\157\x5f\x73\141\155\x6c\x5f\x62\141\x63\x6b\144\x6f\x6f\162\137\165\x72\x6c"]) : "\x66\x61\154\x73\145";
        if (isset($_GET["\x6c\157\147\x67\145\x64\157\x75\164"]) && $_GET["\x6c\x6f\147\147\145\x64\x6f\x75\164"] == "\x74\x72\165\145") {
            goto Aq;
        }
        if (isset($sT[$LQ]["\x6d\157\137\x73\x61\x6d\x6c\x5f\x61\154\x6c\157\167\x5f\x77\x70\x5f\163\x69\147\156\151\156"]) and $sT[$LQ]["\155\x6f\x5f\x73\141\x6d\154\137\x61\x6c\154\157\167\x5f\x77\x70\137\x73\151\147\x6e\151\x6e"] == "\x74\162\165\145") {
            goto SS;
        }
        goto A9;
        Aq:
        header("\114\x6f\143\x61\164\x69\157\156\x3a\40" . get_network_site_url());
        exit;
        goto A9;
        SS:
        if (isset($_GET["\x73\x61\x6d\154\x5f\163\x73\157"]) && $_GET["\163\141\x6d\x6c\137\163\163\x6f"] == $v_ || isset($_POST["\x73\141\x6d\154\137\163\163\x6f"]) && $_POST["\163\141\155\x6c\x5f\163\x73\x6f"] == $v_) {
            goto Lo;
        }
        if (isset($_REQUEST["\x72\145\x64\151\162\x65\143\x74\x5f\x74\157"])) {
            goto wH;
        }
        goto DT;
        Lo:
        return;
        goto DT;
        wH:
        $dh = $_REQUEST["\162\145\x64\x69\162\x65\x63\x74\137\x74\157"];
        if (!(strpos($dh, "\167\x70\x2d\141\x64\155\151\x6e") !== false && strpos($dh, "\x73\141\x6d\x6c\x5f\163\163\157\x3d" . $v_) !== false)) {
            goto lD;
        }
        return;
        lD:
        DT:
        A9:
        if (!empty($dh)) {
            goto sH;
        }
        $dh = saml_get_current_page_url();
        sH:
        $this->mo_saml_redirect_for_authentication($dh);
        g8:
    }
    function mo_saml_auto_redirect()
    {
        if (!current_user_can("\x72\145\141\x64")) {
            goto FV;
        }
        return;
        FV:
        global $blog_id;
        $sT = maybe_unserialize(get_site_option("\163\141\155\154\137\x73\163\x6f\x5f\x73\145\164\164\x69\x6e\147\x73"));
        $LQ = get_current_blog_id();
        $bO = Utilities::get_active_sites();
        if (in_array($LQ, $bO)) {
            goto p2;
        }
        return;
        p2:
        if (!(empty($sT[$LQ]) && !empty($sT["\x44\x45\106\x41\125\114\x54"]))) {
            goto fD;
        }
        $sT[$LQ] = $sT["\104\x45\106\x41\125\114\x54"];
        fD:
        if (is_user_logged_in() && !empty($sT[$LQ]["\155\x6f\x5f\x73\x61\155\154\x5f\163\165\x62\x73\151\164\145\x5f\x61\x63\143\x65\x73\163\x5f\144\145\x6e\x69\145\144"])) {
            goto Xv;
        }
        if (!((isset($sT[$LQ]["\x6d\157\x5f\x73\x61\x6d\x6c\137\162\x65\x67\151\x73\x74\145\162\x65\x64\137\157\x6e\154\171\x5f\x61\143\143\145\x73\x73"]) and $sT[$LQ]["\155\x6f\x5f\163\141\155\x6c\137\x72\x65\x67\151\x73\164\x65\162\x65\x64\137\157\x6e\154\x79\137\141\x63\143\x65\163\163"] == "\x74\162\165\145") || (isset($sT[$LQ]["\155\x6f\137\x73\x61\155\x6c\x5f\x72\145\144\151\x72\145\143\164\x5f\164\x6f\x5f\x77\160\x5f\x6c\157\147\x69\156"]) and $sT[$LQ]["\155\x6f\137\163\x61\x6d\154\137\162\145\x64\x69\x72\x65\x63\x74\x5f\164\157\137\167\x70\x5f\154\x6f\x67\151\156"] == "\x74\162\165\x65"))) {
            goto P3;
        }
        $uv = $_SERVER["\110\124\124\x50\137\x48\117\x53\124"];
        if (!(substr($uv, -1) == "\x2f")) {
            goto Xg;
        }
        $uv = substr($uv, 0, -1);
        Xg:
        $M8 = $_SERVER["\122\x45\x51\125\105\x53\x54\137\x55\x52\x49"];
        if (!(substr($M8, 0, 1) == "\x2f")) {
            goto un;
        }
        $M8 = substr($M8, 1);
        un:
        $tR = "\x68\164\164\x70" . (isset($_SERVER["\110\x54\124\x50\x53"]) ? "\163" : '') . "\72\57\57" . $uv . "\57" . $M8;
        $this->mo_saml_redirect_for_authentication($tR);
        P3:
        goto Sw;
        Xv:
        global $current_user;
        if (is_user_member_of_blog($current_user->ID)) {
            goto Av;
        }
        $this->mo_saml_admin_page_access_denied();
        Av:
        Sw:
    }
    function mo_saml_modify_login_form()
    {
        $sT = maybe_unserialize(get_site_option("\x73\x61\155\154\x5f\163\x73\x6f\137\163\145\x74\x74\151\156\147\x73"));
        $LQ = get_current_blog_id();
        $bO = Utilities::get_active_sites();
        if (in_array($LQ, $bO)) {
            goto wD;
        }
        return;
        wD:
        if (!(empty($sT[$LQ]) && !empty($sT["\104\x45\x46\101\125\114\x54"]))) {
            goto jv;
        }
        $sT[$LQ] = $sT["\104\105\106\x41\125\x4c\x54"];
        jv:
        $v_ = isset($sT[$LQ]["\155\x6f\x5f\x73\x61\155\154\x5f\142\x61\143\153\x64\x6f\x6f\162\137\x75\162\154"]) ? trim($sT[$LQ]["\x6d\157\137\x73\141\x6d\x6c\x5f\x62\x61\x63\x6b\144\157\157\162\x5f\165\162\154"]) : "\146\x61\154\x73\x65";
        echo "\74\151\156\x70\165\164\x20\164\x79\x70\145\75\x22\150\151\144\144\x65\156\x22\x20\x6e\141\x6d\x65\x3d\42\x73\141\155\154\137\x73\x73\x6f\x22\40\166\x61\154\165\x65\x3d\42" . $v_ . "\42\x3e" . "\12";
        if (!(isset($sT[$LQ]["\x6d\x6f\137\163\141\155\x6c\137\x61\x64\144\x5f\163\163\x6f\137\x62\165\x74\x74\x6f\x6e\x5f\167\160"]) and $sT[$LQ]["\x6d\x6f\x5f\163\x61\x6d\154\x5f\141\x64\144\137\x73\163\157\x5f\x62\x75\164\x74\x6f\x6e\137\167\160"] == "\x74\x72\165\145")) {
            goto zn;
        }
        $this->mo_saml_add_sso_button();
        zn:
    }
    function mo_saml_add_sso_button()
    {
        $sT = maybe_unserialize(get_site_option("\163\141\x6d\154\137\x73\163\x6f\137\163\145\x74\x74\x69\156\147\163"));
        $LQ = get_current_blog_id();
        $bO = Utilities::get_active_sites();
        if (in_array($LQ, $bO)) {
            goto sI;
        }
        return;
        sI:
        if (!(empty($sT[$LQ]) && !empty($sT["\x44\x45\x46\101\125\114\x54"]))) {
            goto uR;
        }
        $sT[$LQ] = $sT["\104\x45\x46\x41\125\x4c\x54"];
        uR:
        if (is_user_logged_in()) {
            goto Va;
        }
        $ia = home_url();
        $dC = isset($sT[$LQ]["\x6d\157\137\163\x61\x6d\x6c\x5f\x62\165\x74\x74\x6f\x6e\137\x77\x69\144\x74\150"]) ? $sT[$LQ]["\155\157\137\163\141\x6d\x6c\137\x62\165\x74\164\x6f\156\137\167\151\x64\164\150"] : "\x31\60\x30";
        $M2 = isset($sT[$LQ]["\155\x6f\x5f\x73\x61\155\x6c\137\142\165\x74\x74\157\156\x5f\150\x65\151\147\x68\164"]) ? $sT[$LQ]["\x6d\x6f\137\x73\141\x6d\154\x5f\x62\165\164\164\157\156\x5f\x68\145\x69\x67\x68\164"] : "\65\60";
        $YW = isset($sT[$LQ]["\155\157\137\163\141\x6d\154\137\142\x75\164\164\157\x6e\137\x73\151\x7a\x65"]) ? $sT[$LQ]["\155\x6f\137\163\x61\155\154\137\x62\165\x74\x74\157\156\137\x73\x69\172\x65"] : "\65\60";
        $gZ = isset($sT[$LQ]["\x6d\157\x5f\163\141\155\x6c\137\142\165\164\x74\x6f\x6e\x5f\x63\165\162\166\145"]) ? $sT[$LQ]["\155\157\x5f\163\141\x6d\x6c\137\x62\x75\x74\164\x6f\x6e\x5f\143\165\x72\166\x65"] : "\x35";
        $op = isset($sT[$LQ]["\155\x6f\x5f\163\x61\155\154\137\142\165\x74\164\x6f\x6e\137\143\157\x6c\157\x72"]) ? $sT[$LQ]["\155\x6f\x5f\x73\141\155\x6c\x5f\x62\165\x74\x74\157\156\x5f\143\157\x6c\157\162"] : "\60\60\70\x35\x62\141";
        $oy = isset($sT[$LQ]["\155\157\137\163\x61\155\x6c\137\142\x75\164\x74\157\156\137\x74\x68\x65\x6d\x65"]) ? $sT[$LQ]["\x6d\x6f\x5f\163\x61\x6d\154\137\x62\165\x74\164\157\x6e\x5f\x74\x68\x65\155\145"] : "\154\157\x6e\147\142\165\164\164\x6f\156";
        $rh = isset($sT[$LQ]["\x6d\157\137\x73\x61\155\x6c\137\x62\x75\164\164\157\x6e\x5f\164\x65\x78\164"]) ? $sT[$LQ]["\x6d\x6f\x5f\163\x61\155\154\x5f\142\165\x74\164\157\156\137\164\x65\170\x74"] : (get_site_option("\x73\141\155\x6c\x5f\151\x64\145\x6e\x74\x69\164\171\137\156\x61\x6d\x65") ? get_site_option("\x73\x61\x6d\x6c\x5f\x69\144\145\156\x74\151\164\171\137\x6e\x61\155\x65") : "\114\x6f\x67\151\x6e");
        $V1 = isset($sT[$LQ]["\x6d\x6f\137\163\x61\155\x6c\137\x66\x6f\x6e\164\137\143\157\154\157\162"]) ? $sT[$LQ]["\155\157\x5f\x73\141\155\x6c\137\x66\157\156\x74\x5f\x63\157\x6c\x6f\x72"] : "\x66\146\x66\146\x66\146";
        $xb = isset($sT[$LQ]["\x6d\157\137\x73\141\x6d\154\x5f\x66\157\x6e\164\x5f\x73\x69\x7a\x65"]) ? $sT[$LQ]["\x6d\157\137\163\x61\155\154\137\146\x6f\156\164\137\163\x69\172\145"] : "\62\x30";
        $f2 = isset($sT[$LQ]["\x73\x73\x6f\x5f\x62\x75\164\x74\x6f\x6e\x5f\154\157\147\151\x6e\x5f\146\157\x72\155\137\x70\x6f\x73\x69\x74\x69\x6f\x6e"]) ? $sT[$LQ]["\x73\163\157\x5f\x62\165\164\164\157\156\x5f\x6c\x6f\147\x69\156\x5f\x66\157\x72\155\x5f\160\x6f\x73\x69\x74\151\x6f\x6e"] : "\141\142\157\x76\145";
        $Ux = "\74\x69\x6e\x70\165\164\40\164\171\160\145\x3d\x22\x62\165\164\164\157\156\x22\x20\156\141\155\x65\x3d\x22\155\157\x5f\163\141\155\154\x5f\x77\x70\137\x73\163\157\x5f\142\165\164\x74\157\x6e\42\x20\x76\141\x6c\x75\145\x3d\x22" . $rh . "\x22\40\163\x74\x79\154\x65\x3d\42";
        $V7 = '';
        if ($oy == "\154\157\156\x67\142\x75\x74\164\x6f\x6e") {
            goto Z0;
        }
        if ($oy == "\143\151\162\143\154\x65") {
            goto OP;
        }
        if ($oy == "\x6f\x76\x61\x6c") {
            goto Xa;
        }
        if ($oy == "\163\161\x75\x61\162\x65") {
            goto MU;
        }
        goto ts;
        OP:
        $V7 = $V7 . "\167\151\x64\x74\x68\72" . $YW . "\160\x78\73";
        $V7 = $V7 . "\x68\145\x69\147\x68\x74\x3a" . $YW . "\160\170\73";
        $V7 = $V7 . "\x62\157\x72\x64\145\162\55\x72\141\144\151\165\163\72\x39\71\x39\160\x78\x3b";
        goto ts;
        Xa:
        $V7 = $V7 . "\167\151\144\164\x68\x3a" . $YW . "\x70\170\73";
        $V7 = $V7 . "\150\x65\x69\147\x68\x74\72" . $YW . "\160\170\x3b";
        $V7 = $V7 . "\142\x6f\162\x64\x65\162\x2d\162\141\x64\x69\x75\163\72\65\160\170\x3b";
        goto ts;
        MU:
        $V7 = $V7 . "\167\x69\x64\164\x68\72" . $YW . "\x70\170\x3b";
        $V7 = $V7 . "\150\x65\151\x67\x68\x74\x3a" . $YW . "\160\170\x3b";
        $V7 = $V7 . "\142\157\162\144\x65\x72\x2d\162\141\x64\x69\165\x73\x3a\60\x70\x78\73";
        $V7 = $V7 . "\160\141\x64\144\x69\156\x67\x3a\x30\x70\170\x3b";
        ts:
        goto D5;
        Z0:
        $V7 = $V7 . "\167\151\x64\x74\x68\72" . $dC . "\160\170\73";
        $V7 = $V7 . "\150\145\151\147\x68\164\x3a" . $M2 . "\160\x78\73";
        $V7 = $V7 . "\142\x6f\x72\x64\145\162\x2d\x72\141\144\151\x75\x73\x3a" . $gZ . "\160\x78\x3b";
        D5:
        $V7 = $V7 . "\x62\x61\143\x6b\x67\x72\x6f\165\156\144\55\x63\157\x6c\157\162\72\x23" . $op . "\73";
        $V7 = $V7 . "\x62\157\162\x64\145\162\x2d\x63\x6f\154\157\x72\x3a\164\162\141\x6e\x73\160\x61\162\x65\156\x74\73";
        $V7 = $V7 . "\x63\x6f\154\x6f\x72\x3a\43" . $V1 . "\x3b";
        $V7 = $V7 . "\146\157\156\x74\55\163\x69\x7a\145\x3a" . $xb . "\160\170\73";
        $Ux = $Ux . $V7 . "\42\x2f\76";
        $dh = urlencode(saml_get_current_page_url());
        if (!isset($_GET["\162\x65\x64\151\x72\x65\x63\164\x5f\x74\x6f"])) {
            goto XW;
        }
        $dh = urlencode($_GET["\x72\145\144\x69\162\x65\143\164\x5f\164\x6f"]);
        XW:
        $DV = "\74\x61\40\x68\x72\x65\146\x3d\x22" . $ia . "\x2f\x3f\157\160\x74\151\157\x6e\75\x73\x61\155\x6c\x5f\165\163\x65\x72\137\154\x6f\x67\151\x6e\46\162\145\144\x69\x72\x65\x63\x74\x5f\x74\x6f\x3d" . $dh . "\x22\x20\x73\164\171\154\145\x3d\42\164\x65\x78\164\55\144\145\143\157\x72\x61\x74\151\x6f\156\72\156\x6f\156\x65\42\x3e" . $Ux . "\x3c\57\x61\x3e";
        $DV = "\x3c\144\151\166\40\x73\164\171\x6c\x65\x3d\x22\x70\141\144\x64\151\156\147\x3a\x31\x30\x70\x78\x3b\x22\x3e" . $DV . "\74\x2f\x64\151\x76\76";
        if ($f2 == "\141\x62\x6f\166\145") {
            goto cf;
        }
        $DV = "\x3c\144\151\x76\40\x69\144\x3d\x22\163\163\x6f\137\142\x75\164\164\x6f\x6e\42\40\163\164\171\x6c\145\x3d\x22\164\x65\x78\x74\55\141\x6c\x69\147\156\72\x63\145\156\164\145\162\42\x3e\74\144\x69\x76\x20\163\x74\x79\154\x65\x3d\x22\160\x61\144\144\151\x6e\147\x3a\65\x70\170\x3b\x66\157\x6e\x74\x2d\x73\x69\x7a\145\x3a\61\x34\160\x78\73\42\x3e\74\142\x3e\117\122\x3c\x2f\142\76\x3c\x2f\x64\151\x76\x3e" . $DV . "\74\x2f\x64\151\166\76\x3c\x62\162\x2f\x3e";
        goto OZ;
        cf:
        $DV = "\74\144\x69\x76\40\x69\x64\x3d\42\x73\163\157\137\x62\165\164\x74\x6f\x6e\42\40\163\164\x79\x6c\x65\x3d\x22\164\x65\x78\164\55\141\x6c\151\x67\156\x3a\x63\x65\x6e\x74\x65\162\x22\76" . $DV . "\x3c\x64\151\166\40\163\x74\171\x6c\145\75\x22\x70\x61\144\x64\151\x6e\147\x3a\x35\x70\170\73\146\157\156\164\x2d\163\x69\172\x65\x3a\61\x34\x70\170\73\x22\76\x3c\x62\76\x4f\x52\x3c\x2f\142\x3e\74\57\x64\151\166\x3e\x3c\x2f\144\151\x76\76\74\142\162\57\x3e";
        $DV = $DV . "\x3c\x73\143\x72\151\160\x74\x3e\xd\12\x9\11\x9\11\166\x61\x72\40\x24\x65\154\x65\155\145\156\164\40\75\40\x6a\121\x75\x65\x72\171\50\x22\x23\x75\x73\x65\162\137\154\157\x67\x69\x6e\42\x29\x3b\xd\12\11\x9\11\11\152\x51\x75\145\162\171\50\x22\x23\x73\x73\x6f\x5f\x62\165\164\164\157\x6e\x22\x29\56\151\156\163\145\162\x74\102\x65\x66\157\162\x65\50\x6a\x51\x75\145\162\x79\x28\x22\154\x61\x62\x65\154\x5b\x66\x6f\162\x3d\x27\42\53\x24\145\x6c\x65\x6d\x65\156\164\x2e\x61\x74\164\x72\x28\x27\x69\x64\x27\51\53\42\47\x5d\x22\51\51\x3b\xd\xa\x9\x9\11\11\x3c\57\163\143\162\x69\160\164\x3e";
        OZ:
        echo $DV;
        Va:
    }
    function mo_get_saml_shortcode()
    {
        $sT = maybe_unserialize(get_site_option("\163\x61\x6d\154\x5f\163\x73\157\x5f\163\x65\164\164\151\x6e\147\x73"));
        $LQ = get_current_blog_id();
        $bO = Utilities::get_active_sites();
        if (in_array($LQ, $bO)) {
            goto pQ;
        }
        return;
        pQ:
        if (!(empty($sT[$LQ]) && !empty($sT["\104\x45\x46\x41\125\114\124"]))) {
            goto x3;
        }
        $sT[$LQ] = $sT["\104\105\106\101\x55\x4c\x54"];
        x3:
        if (!is_user_logged_in()) {
            goto Um;
        }
        $current_user = wp_get_current_user();
        $Lb = "\x48\145\x6c\154\x6f\x2c";
        if (empty($sT[$LQ]["\x6d\157\137\163\x61\x6d\x6c\x5f\x63\165\x73\x74\x6f\155\x5f\x67\x72\x65\x65\164\151\156\x67\x5f\164\145\x78\x74"])) {
            goto xJ;
        }
        $Lb = $sT[$LQ]["\x6d\x6f\x5f\163\x61\x6d\154\137\x63\165\163\x74\x6f\155\x5f\x67\162\x65\x65\x74\151\x6e\x67\137\164\x65\x78\164"];
        xJ:
        $we = '';
        if (empty($sT[$LQ]["\155\x6f\x5f\163\141\x6d\x6c\137\147\x72\x65\145\164\x69\156\147\x5f\x6e\141\x6d\145"])) {
            goto r7;
        }
        switch ($sT[$LQ]["\155\157\137\x73\141\155\x6c\x5f\x67\x72\x65\x65\x74\151\x6e\147\x5f\156\141\x6d\x65"]) {
            case "\125\x53\x45\x52\116\x41\x4d\105":
                $we = $current_user->user_login;
                goto Fy;
            case "\105\115\x41\x49\114":
                $we = $current_user->user_email;
                goto Fy;
            case "\106\x4e\x41\x4d\x45":
                $we = $current_user->user_firstname;
                goto Fy;
            case "\x4c\116\x41\115\105":
                $we = $current_user->user_lastname;
                goto Fy;
            case "\x46\116\x41\x4d\105\x5f\114\x4e\x41\x4d\x45":
                $we = $current_user->user_firstname . "\40" . $current_user->user_lastname;
                goto Fy;
            case "\x4c\x4e\101\115\105\137\x46\116\x41\x4d\x45":
                $we = $current_user->user_lastname . "\40" . $current_user->user_firstname;
                goto Fy;
            default:
                $we = $current_user->user_login;
        }
        lt:
        Fy:
        r7:
        if (!empty(trim($we))) {
            goto xz;
        }
        $we = $current_user->user_login;
        xz:
        $Ks = $Lb . "\x20" . $we;
        $vg = "\x4c\x6f\147\157\x75\x74";
        if (empty($sT[$LQ]["\x6d\157\137\x73\x61\155\x6c\137\x63\165\163\x74\x6f\x6d\x5f\x6c\157\147\x6f\165\164\137\x74\x65\170\164"])) {
            goto Wa;
        }
        $vg = $sT[$LQ]["\155\157\137\x73\141\x6d\x6c\137\x63\x75\x73\164\157\x6d\x5f\154\x6f\x67\x6f\165\x74\137\x74\x65\170\x74"];
        Wa:
        $DV = $Ks . "\x20\174\x20\74\x61\x20\150\162\x65\x66\x3d\42" . wp_logout_url(home_url()) . "\x22\40\164\151\x74\x6c\145\75\42\154\x6f\147\157\x75\164\x22\x20\x3e" . $vg . "\74\x2f\x61\x3e\74\x2f\154\151\76";
        goto Yd;
        Um:
        $ia = get_site_option("\x6d\x6f\137\163\x61\155\154\137\163\x70\x5f\142\141\163\x65\x5f\165\162\x6c");
        if (!empty($ia)) {
            goto kA;
        }
        $ia = home_url();
        kA:
        if (mo_saml_is_sp_configured() && mo_saml_is_customer_license_key_verified()) {
            goto cl;
        }
        $DV = "\123\120\40\x69\163\x20\x6e\157\164\x20\x63\x6f\156\146\151\x67\x75\x72\x65\144\x2e";
        goto V_;
        cl:
        $b6 = "\x4c\x6f\x67\x69\156\40\x77\x69\x74\150\x20" . get_site_option("\x73\141\155\x6c\x5f\151\144\x65\x6e\164\151\x74\171\137\156\x61\155\145");
        if (empty($sT[$LQ]["\x6d\157\x5f\x73\141\x6d\x6c\x5f\x63\165\x73\x74\157\x6d\x5f\x6c\x6f\147\151\x6e\x5f\x74\x65\x78\x74"])) {
            goto d3;
        }
        $b6 = $sT[$LQ]["\155\x6f\x5f\163\141\x6d\x6c\x5f\143\165\x73\164\x6f\155\137\x6c\x6f\x67\x69\x6e\137\x74\x65\x78\x74"];
        d3:
        $Xs = get_site_option("\163\141\155\x6c\137\x69\x64\145\156\x74\151\164\171\x5f\x6e\141\155\145");
        $b6 = str_replace("\x23\43\111\x44\120\43\x23", $Xs, $b6);
        $Jr = false;
        if (!(isset($sT[$LQ]["\x6d\x6f\137\x73\x61\155\x6c\137\165\x73\x65\x5f\142\165\164\164\157\x6e\137\141\x73\x5f\x73\150\157\162\164\143\157\x64\145"]) and $sT[$LQ]["\155\x6f\137\163\141\155\154\137\165\163\x65\x5f\x62\165\x74\164\x6f\x6e\x5f\x61\163\x5f\163\150\x6f\162\164\x63\157\144\145"] == "\x74\x72\165\x65")) {
            goto JZ;
        }
        $Jr = true;
        JZ:
        if (!$Jr) {
            goto Up;
        }
        $dC = isset($sT[$LQ]["\155\157\x5f\x73\141\x6d\154\x5f\x62\165\x74\x74\x6f\156\137\x77\x69\144\164\x68"]) ? $sT[$LQ]["\x6d\157\137\x73\x61\155\154\137\x62\165\164\x74\157\x6e\137\167\x69\x64\164\x68"] : "\61\60\x30";
        $M2 = isset($sT[$LQ]["\155\157\x5f\163\x61\x6d\154\137\142\x75\164\164\157\156\137\150\145\151\x67\150\x74"]) ? $sT[$LQ]["\155\x6f\x5f\163\141\155\x6c\x5f\x62\x75\x74\x74\x6f\x6e\x5f\150\x65\151\x67\150\164"] : "\65\60";
        $YW = isset($sT[$LQ]["\x6d\x6f\137\163\x61\155\x6c\x5f\x62\x75\x74\164\x6f\x6e\137\163\x69\172\145"]) ? $sT[$LQ]["\x6d\x6f\x5f\163\141\155\x6c\x5f\x62\x75\x74\x74\157\156\137\x73\x69\x7a\145"] : "\x35\60";
        $gZ = isset($sT[$LQ]["\155\157\x5f\163\x61\155\x6c\137\142\165\164\x74\x6f\156\x5f\x63\165\162\x76\x65"]) ? $sT[$LQ]["\x6d\x6f\137\x73\141\x6d\x6c\x5f\x62\x75\x74\x74\157\156\x5f\x63\165\x72\166\145"] : "\65";
        $op = isset($sT[$LQ]["\x6d\x6f\x5f\163\x61\155\154\137\x62\165\x74\x74\x6f\x6e\137\143\x6f\154\x6f\x72"]) ? $sT[$LQ]["\x6d\157\137\x73\141\155\154\x5f\142\x75\164\x74\x6f\156\x5f\143\x6f\154\x6f\x72"] : "\x30\60\70\65\x62\x61";
        $oy = isset($sT[$LQ]["\x6d\157\137\x73\141\x6d\154\x5f\142\165\164\164\157\x6e\x5f\164\x68\145\x6d\x65"]) ? $sT[$LQ]["\x6d\157\137\x73\x61\x6d\154\x5f\142\165\x74\x74\157\156\x5f\x74\150\x65\155\x65"] : "\154\x6f\156\x67\142\165\164\x74\157\x6e";
        $rh = isset($sT[$LQ]["\x6d\157\137\163\141\155\x6c\137\142\x75\x74\164\x6f\x6e\x5f\x74\145\x78\164"]) ? $sT[$LQ]["\155\157\137\x73\141\x6d\x6c\137\142\165\164\164\157\x6e\137\x74\x65\170\x74"] : (get_site_option("\163\141\x6d\154\137\x69\x64\x65\156\164\x69\164\x79\x5f\x6e\141\x6d\145") ? get_site_option("\x73\x61\155\154\x5f\151\144\x65\x6e\164\x69\164\x79\x5f\156\x61\x6d\x65") : "\114\x6f\147\151\x6e");
        $V1 = isset($sT[$LQ]["\155\157\137\163\141\155\x6c\137\146\157\x6e\164\137\x63\157\x6c\157\162"]) ? $sT[$LQ]["\155\157\x5f\x73\141\x6d\154\x5f\x66\157\156\x74\x5f\x63\157\x6c\157\x72"] : "\146\146\146\x66\146\146";
        $En = isset($sT[$LQ]["\155\x6f\x5f\x73\x61\x6d\154\137\146\x6f\x6e\x74\137\163\x69\172\x65"]) ? $sT[$LQ]["\155\x6f\x5f\x73\141\155\x6c\x5f\146\157\156\x74\x5f\163\x69\172\145"] : "\62\60";
        $b6 = "\74\151\156\x70\165\164\x20\164\x79\x70\x65\x3d\42\142\165\164\x74\x6f\156\42\x20\156\141\155\x65\75\42\x6d\x6f\x5f\x73\x61\x6d\154\137\x77\160\x5f\x73\x73\x6f\137\x62\165\164\x74\157\156\42\x20\x76\x61\154\x75\x65\x3d\42" . $rh . "\x22\40\163\x74\171\x6c\x65\75\42";
        $V7 = '';
        if ($oy == "\154\x6f\x6e\147\x62\165\164\164\157\x6e") {
            goto e1;
        }
        if ($oy == "\143\x69\x72\x63\x6c\x65") {
            goto OT;
        }
        if ($oy == "\x6f\x76\141\154") {
            goto D9;
        }
        if ($oy == "\163\x71\x75\x61\162\x65") {
            goto hw;
        }
        goto bw;
        OT:
        $V7 = $V7 . "\167\x69\144\164\150\x3a" . $YW . "\x70\x78\73";
        $V7 = $V7 . "\x68\x65\x69\147\150\164\x3a" . $YW . "\x70\170\x3b";
        $V7 = $V7 . "\x62\157\x72\x64\145\162\55\x72\141\144\151\x75\163\x3a\x39\71\71\x70\170\73";
        goto bw;
        D9:
        $V7 = $V7 . "\167\151\x64\164\x68\72" . $YW . "\x70\170\73";
        $V7 = $V7 . "\150\x65\x69\147\150\x74\72" . $YW . "\x70\x78\73";
        $V7 = $V7 . "\142\x6f\x72\144\145\162\x2d\x72\141\x64\x69\165\163\72\65\160\x78\73";
        goto bw;
        hw:
        $V7 = $V7 . "\167\x69\x64\x74\150\72" . $YW . "\160\170\x3b";
        $V7 = $V7 . "\x68\x65\151\x67\x68\x74\x3a" . $YW . "\160\170\73";
        $V7 = $V7 . "\142\x6f\x72\x64\x65\162\55\162\x61\x64\x69\165\163\72\60\x70\x78\x3b";
        bw:
        goto gj;
        e1:
        $V7 = $V7 . "\x77\151\144\164\x68\x3a" . $dC . "\160\x78\73";
        $V7 = $V7 . "\x68\x65\151\x67\x68\x74\x3a" . $M2 . "\160\170\x3b";
        $V7 = $V7 . "\142\x6f\162\x64\x65\x72\55\x72\141\144\x69\x75\x73\x3a" . $gZ . "\x70\x78\73";
        gj:
        $V7 = $V7 . "\x62\141\x63\153\x67\162\x6f\x75\x6e\144\x2d\143\157\154\157\162\x3a\43" . $op . "\x3b";
        $V7 = $V7 . "\x62\157\x72\x64\x65\162\x2d\x63\x6f\x6c\157\x72\72\164\162\141\156\163\x70\141\x72\x65\156\164\x3b";
        $V7 = $V7 . "\143\x6f\x6c\x6f\x72\x3a\43" . $V1 . "\73";
        $V7 = $V7 . "\x66\x6f\x6e\164\x2d\x73\x69\x7a\x65\72" . $En . "\160\170\x3b";
        $V7 = $V7 . "\x70\x61\x64\144\x69\x6e\x67\x3a\60\160\170\73";
        $b6 = $b6 . $V7 . "\x22\57\76";
        Up:
        $dh = urlencode(saml_get_current_page_url());
        $DV = "\74\x61\x20\150\162\145\146\75\42" . $ia . "\x2f\77\157\160\x74\151\157\156\75\163\x61\x6d\x6c\137\165\x73\145\x72\x5f\154\x6f\147\151\x6e\x26\x72\145\x64\x69\x72\145\x63\x74\x5f\164\157\75" . $dh . "\x22";
        if (!$Jr) {
            goto E0;
        }
        $DV = $DV . "\163\164\171\x6c\145\x3d\x22\x74\x65\x78\x74\55\x64\x65\143\x6f\x72\x61\x74\151\x6f\156\x3a\x6e\x6f\x6e\145\x3b\x22";
        E0:
        $DV = $DV . "\76" . $b6 . "\74\x2f\141\x3e";
        V_:
        Yd:
        return $DV;
    }
    function upload_metadata()
    {
        if (!(isset($_FILES["\155\145\x74\141\144\141\164\141\137\x66\151\x6c\x65"]) || isset($_POST["\155\x65\164\x61\x64\141\164\x61\x5f\165\x72\x6c"]))) {
            goto vl;
        }
        if (!empty($_FILES["\x6d\145\x74\x61\144\141\164\x61\x5f\x66\x69\x6c\145"]["\x74\x6d\160\x5f\x6e\141\155\x65"])) {
            goto SA;
        }
        if (mo_saml_is_extension_installed("\x63\x75\162\154")) {
            goto rA;
        }
        update_option("\155\157\137\x73\x61\155\154\x5f\x6d\145\163\x73\141\147\145", "\x50\x48\x50\40\x63\x55\122\x4c\40\x65\x78\x74\145\156\163\x69\157\x6e\40\x69\163\x20\156\157\x74\x20\x69\156\x73\x74\141\154\x6c\145\144\x20\157\x72\x20\x64\151\x73\141\142\154\x65\x64\x2e\x20\x43\x61\156\x6e\x6f\x74\40\x66\145\x74\143\x68\40\155\x65\164\141\x64\x61\x74\141\x20\146\x72\157\155\40\x55\122\x4c\56");
        $this->mo_saml_show_error_message();
        return;
        rA:
        $Tz = filter_var(htmlspecialchars($_POST["\155\145\x74\141\144\141\x74\x61\x5f\165\162\154"]), FILTER_SANITIZE_URL);
        $hC = Utilities::mo_saml_wp_remote_call($Tz, $this, array("\163\x73\x6c\166\145\162\x69\x66\x79" => false), true);
        if ($hC) {
            goto X1;
        }
        update_site_option("\x6d\157\x5f\x73\x61\155\154\137\x6d\145\163\x73\x61\x67\x65", "\120\x6c\x65\x61\163\x65\40\160\x72\157\166\151\x64\145\40\x61\40\166\141\x6c\151\x64\x20\155\145\x74\x61\144\x61\164\141\x20\125\122\114\56");
        return;
        X1:
        if (!is_null($hC)) {
            goto R3;
        }
        $H_ = null;
        goto Jc;
        R3:
        $H_ = $hC;
        Jc:
        if (isset($_POST["\x73\x79\156\143\137\x6d\145\x74\141\144\x61\164\141"])) {
            goto Ng;
        }
        delete_site_option("\x73\x61\155\x6c\x5f\x6d\x65\164\141\144\141\164\x61\137\x75\x72\154\x5f\146\157\162\x5f\163\171\156\x63");
        delete_site_option("\x73\141\x6d\154\x5f\x6d\145\x74\141\144\x61\x74\x61\x5f\x73\171\x6e\143\137\151\156\x74\145\x72\166\141\x6c");
        wp_unschedule_event(wp_next_scheduled("\x6d\145\x74\141\144\141\x74\141\137\163\171\156\143\137\x63\x72\157\156\137\141\143\164\x69\x6f\156"), "\155\x65\x74\141\x64\141\164\x61\137\163\171\156\143\137\x63\x72\x6f\x6e\137\141\143\x74\x69\x6f\156");
        goto jz;
        Ng:
        update_site_option("\163\x61\155\x6c\137\155\x65\164\x61\x64\141\x74\x61\137\165\x72\x6c\x5f\146\x6f\x72\x5f\163\x79\156\143", htmlspecialchars($_POST["\x6d\145\x74\x61\144\x61\x74\x61\x5f\165\x72\x6c"]));
        update_site_option("\x73\x61\x6d\154\x5f\x6d\145\164\141\144\141\x74\x61\x5f\163\171\156\143\x5f\x69\x6e\164\145\162\x76\x61\154", htmlspecialchars($_POST["\x73\x79\156\x63\x5f\x69\156\164\x65\162\166\x61\x6c"]));
        if (wp_next_scheduled("\x6d\145\164\141\x64\x61\x74\x61\137\x73\171\156\143\137\143\162\157\x6e\137\141\x63\x74\x69\157\x6e")) {
            goto h5;
        }
        wp_schedule_event(time(), htmlspecialchars($_POST["\x73\171\156\143\x5f\x69\156\x74\x65\x72\x76\x61\x6c"]), "\x6d\x65\164\141\x64\141\164\x61\x5f\163\x79\x6e\x63\x5f\143\162\x6f\x6e\137\141\x63\x74\151\157\156");
        h5:
        jz:
        goto fO;
        SA:
        $H_ = @file_get_contents($_FILES["\155\145\164\141\x64\x61\x74\x61\137\146\151\154\x65"]["\164\x6d\160\137\x6e\141\x6d\145"]);
        fO:
        $xY = set_error_handler(array($this, "\x68\141\x6e\144\x6c\x65\x58\x6d\x6c\105\162\162\157\162"));
        $Lx = new DOMDocument();
        $Lx->loadXML($H_);
        restore_error_handler();
        if (!empty($Lx->firstChild)) {
            goto fj;
        }
        if (isset($_POST["\165\160\154\x6f\141\144\137\x6d\145\164\x61\x64\141\164\x61"])) {
            goto A4;
        }
        update_site_option("\155\x6f\137\x73\141\155\154\137\x6d\145\x73\x73\141\x67\145", "\x50\154\x65\141\x73\145\40\x70\x72\x6f\x76\151\144\145\x20\x61\x20\166\141\154\151\x64\40\155\145\x74\x61\x64\x61\164\x61\40\125\122\114\56");
        goto be;
        A4:
        update_site_option("\x6d\157\137\163\141\x6d\154\x5f\x6d\x65\163\x73\x61\x67\145", "\x50\154\145\x61\163\x65\x20\x70\162\157\166\151\144\145\x20\x61\40\166\x61\x6c\151\x64\x20\x6d\x65\164\141\144\x61\x74\x61\40\x66\151\x6c\145\x2e");
        be:
        $this->mo_saml_show_error_message();
        goto wK;
        fj:
        $Cl = new MetadataReader($Lx);
        foreach ($Cl->getIdentityProviders() as $XC => $rw) {
            $Og = $_POST["\x73\141\x6d\154\137\x69\x64\145\156\x74\x69\164\171\x5f\160\x72\157\166\151\144\145\162\137\x6e\x61\155\145"];
            $d1 = "\110\164\x74\x70\122\145\144\x69\x72\145\x63\164";
            $XR = '';
            if (array_key_exists("\x48\124\x54\x50\x2d\122\x65\x64\x69\x72\x65\x63\x74", $rw->getLoginDetails())) {
                goto EG;
            }
            if (!array_key_exists("\x48\x54\x54\120\55\x50\x4f\x53\x54", $rw->getLoginDetails())) {
                goto ah;
            }
            $d1 = "\110\x74\164\x70\120\157\163\164";
            $XR = $rw->getLoginURL("\x48\x54\x54\120\x2d\x50\117\123\124");
            ah:
            goto y1;
            EG:
            $XR = $rw->getLoginURL("\x48\x54\124\x50\55\122\145\x64\151\162\145\143\x74");
            y1:
            $hj = "\110\164\164\x70\122\x65\x64\151\162\145\x63\x74";
            $l3 = '';
            if (array_key_exists("\x48\124\124\120\x2d\122\145\x64\151\x72\145\x63\x74", $rw->getLogoutDetails())) {
                goto Jj;
            }
            if (!array_key_exists("\x48\124\x54\x50\x2d\x50\117\x53\x54", $rw->getLogoutDetails())) {
                goto BK;
            }
            $hj = "\x48\x74\164\160\x50\157\163\x74";
            $l3 = $rw->getLogoutURL("\x48\x54\x54\120\x2d\120\x4f\123\124");
            BK:
            goto lu;
            Jj:
            $l3 = $rw->getLogoutURL("\x48\124\x54\x50\55\x52\145\x64\x69\x72\145\143\x74");
            lu:
            $ne = $rw->getEntityID();
            $D8 = $rw->getSigningCertificate();
            update_site_option("\x73\141\155\x6c\137\x69\144\145\x6e\164\x69\164\171\x5f\156\x61\x6d\145", $Og);
            update_site_option("\163\141\x6d\154\137\154\x6f\147\x69\x6e\137\142\151\x6e\144\x69\156\147\x5f\164\x79\160\145", $d1);
            update_site_option("\163\x61\x6d\154\x5f\x6c\x6f\147\x69\x6e\137\165\162\x6c", $XR);
            update_site_option("\163\141\x6d\154\137\154\157\147\x6f\x75\164\137\x62\151\x6e\144\151\x6e\147\137\x74\x79\x70\145", $hj);
            update_site_option("\163\141\155\x6c\x5f\x6c\157\x67\x6f\165\164\x5f\x75\162\x6c", $l3);
            update_site_option("\163\x61\x6d\154\x5f\151\163\x73\x75\145\x72", $ne);
            update_site_option("\163\x61\155\x6c\x5f\156\x61\155\x65\151\144\137\146\x6f\x72\x6d\141\164", "\61\x2e\x31\x3a\156\x61\155\x65\151\x64\x2d\146\157\162\x6d\141\164\x3a\165\156\163\160\x65\143\x69\146\x69\145\x64");
            $D8 = is_array($D8) ? $D8 : array(0 => $D8);
            $D8;
            foreach ($D8 as $XC => $wE) {
                $D8[$XC] = Utilities::sanitize_certificate($wE);
                cc:
            }
            El:
            update_site_option("\x73\x61\x6d\x6c\x5f\x78\65\x30\71\x5f\143\145\162\164\x69\x66\x69\x63\141\164\145", $D8);
            goto Sd;
            P_:
        }
        Sd:
        update_site_option("\155\157\x5f\x73\x61\x6d\154\137\155\x65\163\x73\141\x67\x65", "\x49\x64\x65\156\x74\151\164\171\x20\120\162\157\x76\x69\x64\x65\162\40\x64\145\x74\x61\151\154\x73\x20\163\141\166\145\x64\x20\163\165\x63\x63\145\x73\x73\146\x75\x6c\154\171\x2e");
        $this->mo_saml_show_success_message();
        wK:
        vl:
    }
    function handleXmlError($hY, $Gy, $A9, $Yq)
    {
        if ($hY == E_WARNING && substr_count($Gy, "\x44\117\x4d\x44\157\x63\165\x6d\145\156\164\x3a\72\154\x6f\141\x64\x58\115\x4c\50\x29") > 0) {
            goto zO;
        }
        return false;
        goto qW;
        zO:
        return;
        qW:
    }
    function mo_saml_admin_page_access_denied()
    {
        $xF = get_blogs_of_user(get_current_user_id());
        if (!wp_list_filter($xF, array("\x75\x73\x65\x72\x62\154\x6f\147\x5f\x69\x64" => get_current_blog_id()))) {
            goto Ki;
        }
        return;
        Ki:
        $x2 = get_bloginfo("\156\141\x6d\x65");
        if (!empty($xF)) {
            goto o3;
        }
        $BK = "\131\157\165\x20\141\164\164\x65\155\x70\x74\x65\x64\40\164\157\40\141\x63\143\145\163\x73\x20\x74\150\145\40" . $x2 . "\x20\163\151\164\145\x2c\x20\142\x75\x74\40\x79\x6f\x75\40\x64\157\40\156\157\164\x20\143\165\162\162\x65\x6e\164\x6c\171\40\x68\141\166\x65\40\160\162\151\166\151\154\x65\x67\x65\163\x20\157\156\x20\x74\150\x69\163\x20\163\x69\x74\x65\x2e\40\111\x66\40\x79\x6f\165\40\x62\x65\x6c\x69\x65\x76\x65\40\x79\x6f\165\40\163\150\157\165\154\x64\40\x62\145\40\141\142\154\145\40\x74\x6f\40\141\143\143\145\x73\163\x20\x74\150\x65\40" . $x2 . "\x20\x73\151\164\145\x2c\40\160\154\145\x61\x73\145\x20\143\x6f\156\x74\141\x63\164\x20\171\x6f\165\x72\x20\x6e\x65\x74\167\x6f\x72\153\x20\141\144\x6d\151\156\x69\x73\164\162\141\x74\x6f\162\x2e";
        mo_saml_subsite_access_denied_page($BK);
        exit;
        o3:
        $BK = "\x3c\x70\x3e\x59\157\165\x20\141\x74\x74\x65\155\160\164\145\x64\40\164\157\x20\x61\143\x63\x65\163\x73\x20\164\150\145\40" . $x2 . "\x20\x73\x69\164\x65\x2c\40\x62\165\x74\40\171\x6f\165\40\x64\x6f\x20\x6e\157\164\40\143\x75\162\x72\x65\x6e\x74\154\x79\x20\x68\x61\x76\x65\x20\160\x72\x69\166\x69\154\145\147\x65\163\x20\157\156\x20\164\150\151\163\40\x73\151\x74\x65\x2e\40\111\146\x20\x79\x6f\x75\40\x62\145\154\151\145\x76\145\40\171\x6f\x75\40\x73\x68\x6f\165\154\144\x20\142\145\x20\x61\x62\x6c\x65\x20\x74\157\40\x61\143\143\145\163\163\40\164\150\145\40" . $x2 . "\x20\163\x69\x74\145\54\40\160\x6c\145\x61\x73\145\40\143\157\x6e\164\x61\x63\x74\40\171\157\165\x72\x20\x6e\x65\164\x77\157\162\x6b\x20\x61\x64\x6d\x69\156\151\x73\164\x72\141\164\157\x72\56\x3c\x2f\160\76";
        $BK .= "\x3c\160\x3e\x49\x66\x20\171\x6f\x75\x20\x72\145\x61\143\150\145\144\x20\164\x68\x69\163\40\x73\143\x72\x65\145\156\40\142\171\40\141\x63\x63\151\144\x65\x6e\x74\x20\141\x6e\x64\40\x6d\x65\x61\x6e\x74\x20\x74\x6f\x20\166\151\163\x69\x74\x20\x6f\x6e\x65\40\x6f\146\40\x79\157\165\162\x20\157\167\156\x20\x73\x69\164\x65\163\54\x20\x68\x65\x72\x65\x20\141\x72\x65\x20\x73\157\155\145\x20\163\150\x6f\x72\x74\143\x75\x74\x73\40\164\x6f\x20\150\x65\154\160\x20\x79\157\x75\x20\x66\151\156\144\x20\x79\157\x75\162\40\167\141\x79\x2e\74\57\160\x3e";
        $BK .= "\x3c\x68\63\76\131\x6f\x75\x72\x20\x53\151\x74\x65\x73\x3c\57\x68\x33\76";
        $BK .= "\74\164\141\x62\154\x65\x3e";
        foreach ($xF as $ke) {
            $BK .= "\74\x74\162\x3e";
            $BK .= "\x3c\x74\144\x3e" . $ke->blogname . "\x3c\57\x74\144\76";
            $BK .= "\74\164\144\x3e\74\141\40\150\162\x65\146\x3d\42" . esc_url(get_admin_url($ke->userblog_id)) . "\42\x3e\126\151\163\151\164\x20\x44\x61\x73\x68\142\x6f\141\x72\x64\74\57\x61\76\x20\x7c\x20\x3c\141\x20\x68\162\x65\x66\75\x22" . esc_url(get_home_url($ke->userblog_id)) . "\42\x3e\x56\151\145\x77\40\x53\151\x74\145\74\x2f\x61\76\x3c\57\x74\x64\x3e";
            $BK .= "\74\x2f\x74\x72\76";
            T3:
        }
        Tu:
        $BK .= "\74\57\164\x61\x62\154\145\x3e";
        mo_saml_subsite_access_denied_page($BK);
        exit;
    }
    function mo_saml_plugin_action_links($ky)
    {
        $ky = array_merge(array("\74\141\x20\150\162\x65\146\x3d\42" . esc_url(network_admin_url("\x61\144\155\151\156\56\160\150\160\x3f\160\141\147\145\75\x6d\157\x5f\x73\x61\155\x6c\137\x73\x65\164\164\151\x6e\x67\163")) . "\x22\76" . __("\x53\x65\164\164\x69\156\147\x73", "\x74\145\170\x74\144\x6f\x6d\141\151\156") . "\74\x2f\x61\x3e"), $ky);
        return $ky;
    }
    function mo_saml_parse_expiry_date($HQ)
    {
        $pR = new DateTime($HQ);
        $kh = $pR->getTimestamp();
        return date("\106\x20\152\x2c\40\x59", $kh);
    }
    function is_license_expired($fy)
    {
        $pR = new DateTime($fy);
        $ev = new DateTime();
        if ($ev > $pR) {
            goto KB;
        }
        return false;
        goto eH;
        KB:
        return true;
        eH:
    }
    function checkPasswordPattern($qP)
    {
        $aI = "\57\136\x5b\50\134\167\51\52\x28\134\x21\134\100\134\x23\134\44\x5c\x25\134\x5e\134\x26\x5c\52\x5c\x2e\134\x2d\x5c\137\51\52\x5d\53\44\57";
        return !preg_match($aI, $qP);
    }
}
new saml_mo_login();
