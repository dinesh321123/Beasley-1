/*! GreaterMedia Contest Restriction - v0.0.1
 * http://wordpress.org/plugins
 * Copyright (c) 2014; * Licensed GPLv2+ */
(function(e){"use strict";var t=jQuery;t(function(){function s(e){r.prop("disabled",!0),a.prepend('<div class="error">'+e+"</div>")}var i=restrict_data.min_age,n=!1,a=t(".contest_entry_form"),r=t(".contest_entry_form input"),o=Cookies.get("contest_res");if(o)return s("You have already entered this contest!"),!1;if(a.hasClass("member_only")&&("undefined"!=typeof is_gigya_user_logged_in&&t.isFunction(is_gigya_user_logged_in)?is_gigya_user_logged_in()||s('You must be logged in to enter the contest!<a href="'+restrict_data.login_url+'">Sign in here</a>'):s("You must be logged in to enter the contest!")),a.hasClass("restrict_age")&&!a.hasClass("member_only"))if("undefined"!=typeof is_gigya_user_logged_in&&t.isFunction(is_gigya_user_logged_in))if(is_gigya_user_logged_in()){var _=get_gigya_user_field("age");i>_&&s("You must be at least "+i+" to enter the contest")}else n=e.confirm("Please confirm that you are at least "+i),n||s("");else n=e.confirm("Please confirm that you are at least "+i),n||s("");a.hasClass("max_entries")&&s("This contest has reached maximum number of entries!"),a.hasClass("single_entry")&&is_gigya_user_logged_in()&&has_user_entered_contest(restrict_data.post_id).then(function(e){e.success&&e.data&&s("You have already entered this contest!")}),t(".single_entry").submit(function(e){if(is_gigya_user_logged_in())Cookies.set("contest_res",1);else{e.preventDefault();var i=t(this).find("input[type=email]").val();has_email_entered_contest(i).then(function(e){return e.success&&e.data?(s("You have already entered this contest!"),Cookies.set("contest_res","Fuck"),!1):(Cookies.set("contest_res",1),!0)})}})})})(this);