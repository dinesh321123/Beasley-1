/*! GreaterMedia Contest Restriction - v0.0.1
 * http://wordpress.org/plugins
 * Copyright (c) 2014; * Licensed GPLv2+ */
(function(e){"use strict";var t=jQuery;t(function(){function s(e){a.prop("disabled",!0),r.prepend('<div class="error">'+e+"</div>")}var n=restrict_data.min_age,i=!1,r=t(".contest_entry_form"),a=t(".contest_entry_form input"),o=Cookies.get("contest_res");if(r.hasClass("early"))return s("Sorry this contest hasn't stated yet!"),!1;if(r.hasClass("late"))return s("Sorry this contest has already ended!"),!1;if(o)return s("You have already entered this contest!"),!1;if(r.hasClass("max_entries"))return s("This contest has reached maximum number of entries!"),!1;if(r.hasClass("single_entry")&&is_gigya_user_logged_in()&&has_user_entered_contest(restrict_data.post_id).then(function(e){return e.success&&e.data?(s("You have already entered this contest!"),!1):undefined}),r.hasClass("member_only")){if("undefined"==typeof is_gigya_user_logged_in||!t.isFunction(is_gigya_user_logged_in))return s("You must be logged in to enter the contest!"),!1;if(!is_gigya_user_logged_in())return s('You must be logged in to enter the contest!<a href="'+restrict_data.login_url+'">Sign in here</a>'),!1}if(r.hasClass("restrict_age")&&!r.hasClass("member_only"))if("undefined"!=typeof is_gigya_user_logged_in&&t.isFunction(is_gigya_user_logged_in))if(is_gigya_user_logged_in()){var _=get_gigya_user_field("age");n>_&&s("You must be at least "+n+" to enter the contest")}else i=e.confirm("Please confirm that you are at least "+n),i||s("");else i=e.confirm("Please confirm that you are at least "+n),i||s("");t(".single_entry").submit(function(e){if(is_gigya_user_logged_in())Cookies.set("contest_res",1);else{e.preventDefault();var n=t(this).find("input[type=email]").val();has_email_entered_contest(n).then(function(e){return e.success&&e.data?(s("You have already entered this contest!"),Cookies.set("contest_res","Fuck"),!1):(Cookies.set("contest_res",1),!0)})}})})})(this);