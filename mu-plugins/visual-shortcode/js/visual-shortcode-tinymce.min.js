!function(){function a(a,b){return!0}if(VisualShortcode&&VisualShortcode.registry)for(var b in VisualShortcode.registry)if(VisualShortcode.registry.hasOwnProperty(b)){if(!a(b,VisualShortcode.registry[b].js_module))return;!function(a){var b=this;tinymce.PluginManager.add(VisualShortcode.registry[a].plugin_name,function(c,d){function e(d){var e=tinymce.activeEditor.selection.getContent(),f=VisualShortcode.strings.Create,g=tinymce.activeEditor.selection.getContent(),h=wp.shortcode.next(a,g)?wp.shortcode.next(a,g).shortcode:void 0,i=[];if(window[VisualShortcode.registry[a].js_module].toolbar_button_action){var j=window[VisualShortcode.registry[a].js_module].toolbar_button_action.call(this,d);c.insertContent(new wp.shortcode({tag:a,attrs:j,content:tinymce.activeEditor.selection.getContent()}).string())}else{window[VisualShortcode.registry[a].js_module].create_popup_title&&(f=window[VisualShortcode.registry[a].js_module].create_popup_title),window[VisualShortcode.registry[a].js_module].view_edit_popup_body_fields&&(i=window[VisualShortcode.registry[a].js_module].view_edit_popup_body_fields.call(this,h).concat(i));var k={title:f,body:i,onsubmit:function(b){var d=window[VisualShortcode.registry[a].js_module].view_edit_popup_onsubmit.call(this,b),f=tinymce.activeEditor.selection.getContent();f||(f=e),c.insertContent(new wp.shortcode({tag:a,attrs:d,content:e}).string())},width:600,height:130};b.editor.windowManager.open(k),window[VisualShortcode.registry[a].js_module].view_edit_popup_visible&&window[VisualShortcode.registry[a].js_module].view_edit_popup_visible.call(this)}}b.editor=c,b.editor.addButton(VisualShortcode.registry[a].button,{icon:VisualShortcode.registry[a].icon_class,onclick:e,title:VisualShortcode.registry[a].button_title})});var c=_.extend(wp.mce.View.prototype,{postID:jQuery("#post_ID").val(),initialize:function(a){this.shortcode=a.shortcode},toView:function(a){var b=wp.shortcode.next(this.type,a);if(b)return{index:b.index,content:b.content,options:{shortcode:b.shortcode}}}});wp.mce.views.register(a,{View:_.extend({},c,{template:_.template(window[VisualShortcode.registry[a].js_module].template),getHtml:window[VisualShortcode.registry[a].js_module].view_gethtml}),edit:function(c){var d=wp.shortcode.next(a,decodeURIComponent(c.dataset.wpviewText)).shortcode,e=[{type:"textbox",multiline:!0,minHeight:200,name:"content",label:VisualShortcode.strings.Content,value:c.querySelector(".content").innerHTML}],f=VisualShortcode.strings.Edit;window[VisualShortcode.registry[a].js_module].edit_popup_title&&(f=window[VisualShortcode.registry[a].js_module].edit_popup_title),window[VisualShortcode.registry[a].js_module].view_edit_popup_body_fields&&(e=window[VisualShortcode.registry[a].js_module].view_edit_popup_body_fields.call(this,d).concat(e));var g={title:f,body:e,buttons:[{text:VisualShortcode.strings.Ok,onclick:"submit"},{text:VisualShortcode.strings.Cancel,onclick:"close"}],onsubmit:function(c){var d=window[VisualShortcode.registry[a].js_module].view_edit_popup_onsubmit.call(this,c);b.editor.insertContent(new wp.shortcode({tag:a,attrs:d,content:c.data.content}).string()),tinymce.activeEditor.windowManager.close()},width:600,height:340};tinymce.activeEditor.windowManager.open(g),window[VisualShortcode.registry[a].js_module].view_edit_popup_visible&&window[VisualShortcode.registry[a].js_module].view_edit_popup_visible.call(this)}})}(b)}}();