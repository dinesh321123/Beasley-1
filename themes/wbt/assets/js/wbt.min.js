var GMCLT=GMCLT||{};GMCLT.Traffic=function(){var a=function(){google.maps.event.addDomListener(window,"load",b)},b=function(){var a=new google.maps.LatLng(35.2269,-80.8433),b={zoom:11,scrollwheel:!1,center:a};trafficmap=new google.maps.Map(document.getElementById("traffic-map-canvas"),b);var d=new google.maps.TrafficLayer;d.setMap(trafficmap),c(),e()},c=function(){trafficObject=new Object,infowindow=new google.maps.InfoWindow({content:"Test content"}),jQuery.getJSON("http://site.gmclt.com/api/Traffic.cfc?method=getActiveIncidents&callback=?",function(a){for(var b=0;b<a.length;b++){var c=a[b].incidentId,e=new google.maps.LatLng(a[b].lat,a[b].lng),f=a[b].marker,g=a[b].headline,h=a[b].zindex;window["marker"+c]=new google.maps.Marker({position:e,map:trafficmap,icon:f,title:g,zIndex:h}),google.maps.event.addListener(window["marker"+c],"click",d(a[b]))}})},d=function(a){return function(){var b=a.incidentId,c=a.body,d=a.headline,e=a.marker,f=a.startdate,g=a.starttime,h=a.enddate,i=a.endtime;if(f==h)var j=f+" at "+g+" - "+i;else var j=f+" at "+g+" - "+h+" at "+i;infowindow.setContent("<h3><img src='"+e+"' align='left' style='padding: 10px;' vspace='2' hspace='2'>"+d+"</h3><p class='attribution'>"+j+"</p><p>"+c+"</p>"),infowindow.open(trafficmap,window["marker"+b])}},e=function(){cameraObject=new Object,infowindow=new google.maps.InfoWindow({content:"Test content"}),jQuery.getJSON("http://site.gmclt.com/api/Traffic.cfc?method=getActiveCameras&callback=?",function(a){for(var b=0;b<a.length;b++){var c=a[b].webId,d=new google.maps.LatLng(a[b].latitude,a[b].longitude),e=a[b].name;window["camera"+c]=new google.maps.Marker({position:d,map:trafficmap,icon:"http://content.gmclt.com/traffic/trafficCamera.png",title:e,zIndex:1}),google.maps.event.addListener(window["camera"+c],"click",f(a[b]))}})},f=function(a){return function(){var b=a.webId,c=a.orientation,d=a.name,e=(a.refreshRate,a.provider),f=a.fullImage;infowindow.setContent("<img src='"+f+"' style='padding: 10px;' vspace='2' hspace='2'><h2>"+d+"</h2><p class='attribution'>"+c+"</p><p>"+e+"</p>"),infowindow.open(trafficmap,window["camera"+b])}},g={init:a};return g}(),GMCLT.Weather=function(){var a=function(){b("USNC0121"),jQuery("#gmcltWX_search").keydown(function(a){13==a.keyCode&&c()}),jQuery("#gmcltWX_searchsubmit").click(function(){c()})},b=function(a){var b=jQuery("#currentConditions-template").html(),c=Handlebars.compile(b),d=jQuery("#forecastFull-template").html(),e=Handlebars.compile(d),f=jQuery("#forecast-template").html(),g=Handlebars.compile(f);jQuery.getJSON("http://api.gmclt.com/weather/weather.cfc?method=getWeatherData&locationId="+a+"&callback=?",function(a){jQuery("#gmcltWX_currentContent").html(c(a)),jQuery("#gmcltWX_forecastFullContent").html(e(a)),jQuery("#gmcltWX_forecastContent").html(g(a)),jQuery(".gmcltWX_search").show(),jQuery(".gmcltWX_loading").hide()})},c=function(){var a=jQuery.trim(jQuery("#gmcltWX_search").val()),c=jQuery("#searchResults-template").html(),d=Handlebars.compile(c);a.length&&(jQuery(".gmcltWX_loading").show(),jQuery("#gmcltWX_currentContent").html(""),jQuery("#gmcltWX_forecastFullContent").html(""),jQuery("#gmcltWX_forecastContent").html(""),jQuery.getJSON("http://api.gmclt.com/weather/weather.cfc?method=searchLocations&queryString="+a+"&callback=?",function(a){a.match?(b(a.results[0].locationId),jQuery("#gmcltWX_search").val("")):(jQuery("#gmcltWX_currentContent").html(d(a)),jQuery(".gmcltWX_loading").hide(),jQuery("#gmcltWX_search").val(""))}))},d={init:a,populateWeatherData:b};return d}();