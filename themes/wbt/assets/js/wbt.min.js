var GMCLT=GMCLT||{},apiUrl="http://api2.wbt.com",gmcltStationName="WBT",gmcltStationID=2;!function(a,b){"use strict";Livefyre.require(["streamhub-wall#3","streamhub-sdk#2"],function(b,c){a.wall=new b({el:document.getElementById("wbt-social-column"),initial:4,collection:new c.Collection({network:"gmcharlotte-int-0.fyre.co",siteId:"305174",articleId:"201509161917:designer-app-1442429572714"})})}),jQuery(".live-links--more__btn").attr("href","/social/")}(this),"undefined"!=typeof Handlebars,GMCLT.AdIndex=function(){var a=jQuery(document.getElementById("gmclt_advertiserSearch")),b=jQuery(document.getElementById("gmclt_wideColumnContent")),c="",d=jQuery(document.getElementById("gmclt_categoryDropdown")),e=function(){Handlebars.registerHelper("inc",function(a,b){return parseInt(a)+1}),Handlebars.registerHelper("analytics",function(a){return ga("send",{hitType:"event",eventCategory:"Advertising",eventAction:"Impression",eventLabel:a}),""}),a.keydown(function(a){13==a.keyCode&&f(0,"search")}),jQuery("#gmclt_searchSubmit").click(function(){f(0,"search")}),g();var b,c=[],d=document.URL.split("?")[1];if(void 0!=d){d=d.split("&");for(var e=0;e<d.length;e++)b=d[e].split("="),c.push(b[1]),c[b[0]]=b[1]}c.advertiserId&&f(c.advertiserId,"direct")},f=function(e,f){var g=jQuery.trim(a.val()),i=jQuery("#searchResults-template").html(),j=Handlebars.compile(i),k=!1,l="";switch(f){case"search":l=apiUrl+"/adIndex/adIndex.cfc?method=searchIndex&query="+g+"&mode="+f+"&station="+gmcltStationName+"&callback=?",g.length&&(k=!0);break;case"category":l=apiUrl+"/adIndex/adIndex.cfc?method=searchIndex&categoryId="+e+"&mode="+f+"&station="+gmcltStationName+"&callback=?",k=!0;break;case"direct":l=apiUrl+"/adIndex/adIndex.cfc?method=searchIndex&advertiserId="+e+"&mode="+f+"&station="+gmcltStationName+"&callback=?",d.hide(),jQuery(".gmclt_searchBar").hide(),k=!0}k&&(jQuery(".gmclt_searching").show(),b.html(""),jQuery.getJSON(l,function(d){b.html(j(d)),jQuery(".gmclt_searching").hide(),a.val(""),"category"!=f&&c.val("0")}).fail(function(){h()}))},g=function(){var a=jQuery("#category-template").html(),b=Handlebars.compile(a);jQuery.getJSON(apiUrl+"/adIndex/adIndex.cfc?method=getCategories&stationId="+gmcltStationID+"&callback=?",function(a){d.html(b(a)),c=jQuery(document.getElementById("gmclt_categorySelect")),c.change(function(){f($(this).attr("value"),"category")})}).fail(function(){})},h=function(){var a=jQuery("#error-template").html(),c=Handlebars.compile(a);b.html(c()),jQuery(".gmclt_searching").hide(),jQuery(".gmclt_searchBar").hide()},i={init:e};return i}(),jQuery(document).ready(function(){GMCLT.Stocks.stockQuoteSubnav()}),GMCLT.Stocks=function(){var a,b=0,c=jQuery("div.secondary-link:contains('Stocks')").parents().eq(1).attr("id"),d=function(){},e=function(){c&&jQuery.getJSON(apiUrl+"/stocks/stocks.cfc?method=getStocksMini&callback=?",function(b){a=b,window.setInterval("GMCLT.Stocks.populateStockQuote()",4e3)}).fail(function(){})},f=function(){var d='<a href="/category/business-news/"><div class="secondary-link"><img class="gmclt_headerStocksIcon" src="/wp-content/themes/wbt/images/stocks/'+a[b].arrow+'.png"> '+a[b].shortName+": "+a[b].change+"</div></a>";jQuery("#"+c).html(d),a.length==b+1?b=0:b+=1},g={init:d,stockQuoteSubnav:e,populateStockQuote:f};return g}();var trafficmap,infowindow;GMCLT.Traffic=function(){var a=function(){google.maps.event.addDomListener(window,"load",b)},b=function(){var a=new google.maps.LatLng(35.2269,-80.8433),b={zoom:11,scrollwheel:!1,center:a};trafficmap=new google.maps.Map(document.getElementById("trafficMap-canvas"),b);var d=new google.maps.TrafficLayer;d.setMap(trafficmap),c(),e()},c=function(){var a=jQuery("#list-template").html(),b=Handlebars.compile(a);new google.maps.InfoWindow({content:"Test content"});jQuery.getJSON(apiUrl+"/traffic/traffic.cfc?method=getActiveIncidents&callback=?",function(a){for(var c=0;c<a.length;c++){var e=a[c].incidentId,f=new google.maps.LatLng(a[c].lat,a[c].lng),g=a[c].marker,h=a[c].headline,i=a[c].zindex;window["marker"+e]=new google.maps.Marker({position:f,map:trafficmap,icon:iconPath+g,title:h,zIndex:i}),google.maps.event.addListener(window["marker"+e],"click",d(a[c])),jQuery("#gmcltTraffic_list").html(b(a)),jQuery("#gmcltTraffic_listLoading").hide()}jQuery("#gmcltTraffic_mapLoading").hide()}).fail(function(){g("map")})},d=function(a){return function(){var b=a.incidentId,c=a.body,d=a.headline,e=a.marker,f=a.dateString;infowindow.setContent("<h3><img src='"+iconPath+e+"' align='left' style='padding: 10px;' vspace='2' hspace='2'>"+d+"</h3><p class='attribution'>"+f+"</p><p>"+c+"</p>"),infowindow.open(trafficmap,window["marker"+b])}},e=function(){infowindow=new google.maps.InfoWindow({content:"blank"}),jQuery.getJSON(apiUrl+"/traffic/traffic.cfc?method=getActiveCameras&callback=?",function(a){for(var b=0;b<a.length;b++){var c=a[b].webId,d=new google.maps.LatLng(a[b].latitude,a[b].longitude),e=a[b].name;window["camera"+c]=new google.maps.Marker({position:d,map:trafficmap,icon:iconPath+"trafficCamera.png",title:e,zIndex:1}),google.maps.event.addListener(window["camera"+c],"click",f(a[b]))}}).fail(function(){})},f=function(a){return function(){var b=a.webId,c=a.orientation,d=a.name,e=a.provider,f=a.fullImage;infowindow.setContent("<img src='"+f+"' style='padding: 10px;' vspace='2' hspace='2'><h2>"+d+"</h2><p class='attribution'>"+c+"</p><p>"+e+"</p>"),infowindow.open(trafficmap,window["camera"+b])}},g=function(a){var b=jQuery("#error-template").html(),c=Handlebars.compile(b);jQuery("#traffic-map-canvas").html(c()),jQuery("#gmcltTraffic_"+a+"Loading").hide()},h={init:a};return h}(),jQuery(document).ready(function(){GMCLT.Weather.currentConditionsSubnav()}),GMCLT.Weather=function(){function a(a){geocoder=new google.maps.Geocoder,geocoder.geocode({address:a},function(a,b){if(b==google.maps.GeocoderStatus.OK){var c={zoom:8,scrollwheel:!1,center:a[0].geometry.location,mapTypeId:google.maps.MapTypeId.ROADMAP},d=new google.maps.Map(document.getElementById("radarMap-canvas"),c),e=new google.maps.ImageMapType({getTileUrl:function(a,b){return"http://mesonet.agron.iastate.edu/cache/tile.py/1.0.0/nexrad-n0q-900913/"+b+"/"+a.x+"/"+a.y+".png?"+(new Date).getTime()},tileSize:new google.maps.Size(256,256),opacity:.6,name:"NEXRAD",isPng:!0});d.overlayMapTypes.push(null),d.overlayMapTypes.setAt("1",e)}})}function b(){geocoder=new google.maps.Geocoder,geocoder.geocode({address:k},function(a,b){if(b==google.maps.GeocoderStatus.OK){var d={zoom:7,scrollwheel:!1,center:a[0].geometry.location,mapTypeId:google.maps.MapTypeId.ROADMAP};e=new google.maps.Map(document.getElementById("stormwatchMap-canvas"),d);var f=new google.maps.ImageMapType({getTileUrl:function(a,b){return"http://mesonet.agron.iastate.edu/cache/tile.py/1.0.0/nexrad-n0q-900913/"+b+"/"+a.x+"/"+a.y+".png?"+(new Date).getTime()},tileSize:new google.maps.Size(256,256),opacity:.6,name:"NEXRAD",isPng:!0});c(k),e.overlayMapTypes.push(null),e.overlayMapTypes.setAt("1",f);for(var g="NC,SC,VA,WV,TN,GA,AL,AK,AZ,AR,CA,CO,CT,DE,DC,FL,HI,ID,IL,IN,IA,KS,KY,LA,ME,MD,MA,MI,MN,MS,MO,MT,NE,NV,NH,NJ,NM,NY,ND,OH,OK,OR,PA,RI,SD,TX,UT,VT,WA,WI,WY",h=g.split(","),i=0;i<h.length;i++)h[i]!=k&&c(h[i])}else m()})}function c(a){jQuery.getJSON(apiUrl+"/weather/weather.cfc?method=getWeatherAlerts&filter=byState&location="+a+"&callback=?",function(a){for(var b=0;b<a.length;b++){for(var c=a[b].countyId,f=[],g=0;g<a[b].countyPolygon.length;g++)f.push(new google.maps.LatLng(a[b].countyPolygon[g].lat,a[b].countyPolygon[g].lng));window["alertZone"+c]=new google.maps.Polygon({paths:f,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:1,fillColor:"#FF0000",fillOpacity:.35}),window["alertZone"+c].setMap(e),google.maps.event.addListener(window["alertZone"+c],"click",d(c))}jQuery(".gmcltWX_mapLoading").hide()}).fail(function(){m()})}function d(a){return function(){var b=jQuery("#alert-template").html(),c=Handlebars.compile(b);jQuery.getJSON(apiUrl+"/weather/weather.cfc?method=getWeatherAlerts&filter=byCounty&location="+a+"&callback=?",function(a){jQuery("#gmclt_narrowColumnContent").html(c(a))}).fail(function(){m()})}}var e,f=function(){i("USNC0121"),jQuery("#gmcltWX_search").keydown(function(a){13==a.keyCode&&j()}),jQuery("#gmcltWX_searchsubmit").click(function(){j()})},g=function(){var a=jQuery("div.secondary-link:contains('Weather')").parents().eq(1).attr("id");if(a){var b=Cookies.get("gmcltWx");if(b){var c=b.split(",");h(c[0],c[1],a)}else jQuery.getJSON(apiUrl+"/weather/weather.cfc?method=getCurrentMini&callback=?",function(b){h(b.temperature,b.graphicCode,a),Cookies.set("gmcltWx",b.temperature+","+b.graphicCode,{expires:900})}).fail(function(){})}},h=function(a,b,c){var d='<a href="/weather"><div class="secondary-link"><img class="gmclt_headerWxIcon" src="/wp-content/themes/wbt/images/wx/'+b+'.png"> '+a+"&deg;</div></a>";jQuery("#"+c).html(d)},i=function(b){var c=jQuery("#currentConditions-template").html(),d=Handlebars.compile(c),e=jQuery("#forecastFull-template").html(),f=Handlebars.compile(e),g=jQuery("#forecast-template").html(),h=Handlebars.compile(g);jQuery.getJSON(apiUrl+"/weather/weather.cfc?method=getWeatherData&locationId="+b+"&callback=?",function(b){jQuery("#gmclt_narrowColumnContent").html(d(b)),jQuery("#gmcltWX_forecastFullContent").html(f(b)),jQuery("#gmcltWX_forecastContent").html(h(b)),jQuery(".gmcltWX_search").show(),jQuery(".gmcltWX_loading").hide(),jQuery("#radarMap-canvas").show(),a(b.location+", "+b.state)}).fail(function(){m()})},j=function(){var a=jQuery.trim(jQuery("#gmcltWX_search").val()),b=jQuery("#searchResults-template").html(),c=Handlebars.compile(b);a.length&&(jQuery(".gmcltWX_loading").show(),jQuery("#gmclt_narrowColumnContent").html(""),jQuery("#gmcltWX_forecastFullContent").html(""),jQuery("#gmcltWX_forecastContent").html(""),jQuery("#radarMap-canvas").hide(),jQuery.getJSON(apiUrl+"/weather/weather.cfc?method=searchLocations&queryString="+a+"&callback=?",function(a){a.match?(i(a.results[0].locationId),jQuery("#gmcltWX_search").val("")):(jQuery("#gmclt_narrowColumnContent").html(c(a)),jQuery(".gmcltWX_loading").hide(),jQuery("#gmcltWX_search").val(""))}).fail(function(){m()}))},k="NC",l=function(){google.maps.event.addDomListener(window,"load",b),google.maps.visualRefresh=!0,jQuery("#GMCLTstateSelect").change(function(){jQuery("#GMCLTstateSelect option:selected").each(function(){k=jQuery(this).val(),b()})}).change()},m=function(){var a=jQuery("#error-template").html(),b=Handlebars.compile(a);jQuery("#gmclt_narrowColumnContent").html(b()),jQuery(".gmcltWX_loading").hide(),jQuery(".gmcltWX_search").hide()},n={init:f,stormwatchInit:l,populateWeatherData:i,currentConditionsSubnav:g};return n}();